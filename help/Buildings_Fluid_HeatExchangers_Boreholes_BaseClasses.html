<HTML>
<HEAD>
<TITLE>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</TITLE>
<META name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META name="description" content="&quot;Base classes for Borehole&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- --- header ------ -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- --- end header -- -->
</P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes.html#Buildings.Fluid.HeatExchangers.Boreholes"
>Buildings.Fluid.HeatExchangers.Boreholes</A>.BaseClasses</H2>
<B>Base classes for Borehole</B>
<P></P>
<P></P><H3>Information</H3>

<p>
This package contains base classes that are used to construct the models in
<A HREF="Buildings_Fluid_HeatExchangers_Boreholes.html#Buildings.Fluid.HeatExchangers.Boreholes"
>Buildings.Fluid.HeatExchangers.Boreholes</a>.
</p>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</A> (Icon for packages containing base classes).
<P></P><H3>Package Content</H3>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha1feb32104c7120c0gmentS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment"
>BoreholeSegment</A>
</TD><TD>Vertical segment of a borehole</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExchabc95f273374cc0cbementS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement"
>HexInternalElement</A>
</TD><TD>Internal part of a borehole</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance"
>BoreholeResistance</A>
</TD><TD>Thermal resistance of the borehole</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance"
>InterferenceResistance</A>
</TD><TD>Total interference resistance between the two pipes of a borehole</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance"
>PartialBoreholeResistance</A>
</TD><TD>Partial model for thermal resistance of the borehole</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha08bcfd6b3be32707itionS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition"
>SingleUTubeBoundaryCondition</A>
</TD><TD>Prescribed temperature at the outer boundary of a single U tube borehole</TD></TR>
<TR><TD><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A>
</TD><TD>class used to create the external object: ExtendableArray</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha5269dc75c926e83dtanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeInternalResistance" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeInternalResistance"
>boreholeInternalResistance</A>
</TD><TD>Calculate the internal resistance of the borehole</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha5269dc75c926e83dtanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance"
>boreholeThermalResistance</A>
</TD><TD>Calculate the total thermal resistance of the borehole from the fluid to the soil</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha5269dc75c926e83dtanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues"
>exchangeValues</A>
</TD><TD>Store the value u at the element n in the external object, and return the value of the element i</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha5269dc75c926e83dtanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.factorial" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.factorial"
>factorial</A>
</TD><TD>Calculates the factorial value of the input</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha5269dc75c926e83dtanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.powerSeries" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.powerSeries"
>powerSeries</A>
</TD><TD>Power series used to compute far-field temperature</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha5269dc75c926e83dtanceS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.temperatureDrop" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.temperatureDrop"
>temperatureDrop</A>
</TD><TD>Calculate the temperature drop of the soil at the external boundary of the cylinder</TD></TR>
<TR><TD><IMG SRC="Buildings.Fluid.HeatExcha200ebb5cee78ca27mplesS.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.Examples" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses_Examples.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.Examples"
>Examples</A>
</TD><TD>Example models to test base classes</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BoreholeSegment<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Fluid.HeatExcha1feb32104c7120c0gmentI.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.BoreholeSegment</H2>
<B>Vertical segment of a borehole</B><p></P>
<IMG SRC="Buildings.Fluid.HeatExcha1feb32104c7120c0gmentD.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment">
<P></P><H3>Information</H3>

<p>
Horizontal layer that is used to model a U-tube borehole heat exchanger. 
This model combines three models, each simulating a different aspect 
of a borehole heat exchanger. 
</p>
<p>
The instance <code>pipFil</code> computes the heat transfer in the pipes and the filling material. 
This computation is done using the model
<a href="modelica://Buildings.Fluid.Boreholes.BaseClasses.HexInternalElement">
Buildings.Fluid.Boreholes.BaseClasses.HexInternalElement</a>.
</p>
<p>
The instance <code>soi</code> computes transient and steady state heat transfer in the soil using a vertical cylinder.
The computation is done using the model <A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayerCylinder"
>
Buildings.HeatTransfer.Conduction.SingleLayerCylinder</a>.
</p>
<p>
The model <code>TBouCon</code> computes the far-field temperature boundary condition, i.e., the temperature at the outer
surface of the above cylindrical heat transfer computation.
The computation is done using the model
<a href="modelica://Buildings.Fluid.Boreholes.BaseClasses.TemperatureBoundaryCondition">
Buildings.Fluid.Boreholes.BaseClasses.TemperatureBoundaryCondition</a>.
</p>
<P></P>
Extends from <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</A> (Partial model transporting fluid between two ports without storing mass or energy), <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</A> (Parameters for flow resistance for models with two ports), <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</A> (Declarations for lumped volumes).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 2 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>0.1</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the element [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xC</TD><TD>0.05</TD><TD>Shank spacing, defined as the distance between the center of a pipe and the center of the borehole [m]</TD></TR>
<TR><TD>Real</TD><TD>B0</TD><TD>17.44</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD>Real</TD><TD>B1</TD><TD>-0.6052</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_nominal</TD><TD>m_flow_nominal</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_nominal</TD><TD>m_flow_nominal</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_nominal</TD><TD>&nbsp;</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1.start</TD><TD>0</TD><TD>Pressure difference between port_a1 and port_b1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2.start</TD><TD>0</TD><TD>Pressure difference between port_a2 and port_b2 [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Soil</TD></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Generic</A></TD><TD>matSoi</TD><TD>redeclare parameter Building...</TD><TD>Thermal properties of soil</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rExt</TD><TD>3</TD><TD>Radius of the soil used for the external boundary condition [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>TExt_start</TD><TD>283.15</TD><TD>Initial far field temperature [K]</TD></TR>
<TR><TD>Integer</TD><TD>nSta</TD><TD>10</TD><TD>Number of state variables in the soil</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>samplePeriod</TD><TD>604800</TD><TD>Sample period for the external boundary condition [s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Filling material</TD></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_BoreholeFillings.html#Buildings.HeatTransfer.Data.BoreholeFillings.Generic"
>Generic</A></TD><TD>matFil</TD><TD>redeclare parameter Building...</TD><TD>Thermal properties of the filling material</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>TFil_start</TD><TD>283.15</TD><TD>Initial temperature of the filling material [K]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Tubes</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>0.02</TD><TD>Radius of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kTub</TD><TD>0.5</TD><TD>Thermal conductivity of the tubes [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>0.002</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal1</TD><TD>allowFlowReversal</TD><TD>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal2</TD><TD>allowFlowReversal</TD><TD>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>true</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port a1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port b1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port a2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port b2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_small</TD><TD>m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_small</TD><TD>m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>1E-4*abs(m_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Flow resistance</B></TD></TR>
<TR><TD>Boolean</TD><TD>computeFlowResistance</TD><TD>true</TD><TD>=true, compute flow resistance. Set to false to assume no friction</TD></TR>
<TR><TD>Boolean</TD><TD>from_dp</TD><TD>false</TD><TD>= true, use m_flow = f(dp) else dp = f(m_flow)</TD></TR>
<TR><TD>Boolean</TD><TD>linearizeFlowResistance</TD><TD>false</TD><TD>= true, use linear relation between m_flow and dp for any flow rate</TD></TR>
<TR><TD>Real</TD><TD>deltaM</TD><TD>0.1</TD><TD>Fraction of nominal flow rate where flow transitions to laminar</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Dynamics</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Equations</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</A></TD><TD>energyDynamics</TD><TD>Modelica.Fluid.Types.Dynamic...</TD><TD>Formulation of energy balance</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</A></TD><TD>massDynamics</TD><TD>energyDynamics</TD><TD>Formulation of mass balance</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialization</B></TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p_start</TD><TD>Medium.p_default</TD><TD>Start value of pressure [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Temperature</A></TD><TD>T_start</TD><TD>TFil_start</TD><TD>Start value of temperature [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>X_start[Medium.nX]</TD><TD>Medium.X_default</TD><TD>Start value of mass fractions m_i/m [kg/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ExtraProperty"
>ExtraProperty</A></TD><TD>C_start[Medium.nC]</TD><TD>fill(0, Medium.nC)</TD><TD>Start value of trace substances</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ExtraProperty"
>ExtraProperty</A></TD><TD>C_nominal[Medium.nC]</TD><TD>fill(1E-2, Medium.nC)</TD><TD>Nominal value of trace substances. (Set to typical order of magnitude.)</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD>Medium 2 in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a1</TD><TD>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b1</TD><TD>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a2</TD><TD>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b2</TD><TD>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Medium in the component</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> BoreholeSegment <font color="darkgreen">&quot;Vertical segment of a borehole&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</A>(
     <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium1 = <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses_Medium.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment.Medium"
>Medium</A>,
     <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium2 = <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses_Medium.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeSegment.Medium"
>Medium</A>,
     <font color="blue">final </font>m1_flow_nominal = m_flow_nominal,
     <font color="blue">final </font>m2_flow_nominal = m_flow_nominal,
     <font color="blue">final </font>m1_flow_small =   m_flow_small,
     <font color="blue">final </font>m2_flow_small =   m_flow_small,
     <font color="blue">final </font>allowFlowReversal1=allowFlowReversal,
     <font color="blue">final </font>allowFlowReversal2=allowFlowReversal);
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</A>;
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</A>(T_start=TFil_start);
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A> <font color="darkgreen">
    &quot;Medium in the component&quot;</font>;
<textblock type="annotcomp" expanded="false">  <font color="blue">replaceable </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Buildings.HeatTransfer.Data.Soil.Generic</A> matSoi <font color="darkgreen">
    &quot;Thermal properties of soil&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_BoreholeFillings.html#Buildings.HeatTransfer.Data.BoreholeFillings.Generic"
>Buildings.HeatTransfer.Data.BoreholeFillings.Generic</A> matFil <font color="darkgreen">
    &quot;Thermal properties of the filling material&quot;</font>;</textblock>

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> m_flow_nominal <font color="darkgreen">
    &quot;Nominal mass flow rate&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> m_flow_small(min=0) = 1E-4*<font color="red">abs</font>(m_flow_nominal) <font color="darkgreen">
    &quot;Small mass flow rate for regularization of zero flow&quot;</font>;
  <font color="blue">parameter </font>Boolean homotopyInitialization = true <font color="darkgreen">&quot;= true, use homotopy method&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rTub=0.02 <font color="darkgreen">&quot;Radius of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kTub=0.5 <font color="darkgreen">
    &quot;Thermal conductivity of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> eTub=0.002 <font color="darkgreen">&quot;Thickness of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> TFil_start=283.15 <font color="darkgreen">
    &quot;Initial temperature of the filling material&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rExt=3 <font color="darkgreen">
    &quot;Radius of the soil used for the external boundary condition&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> TExt_start=283.15 <font color="darkgreen">
    &quot;Initial far field temperature&quot;</font>;
  <font color="blue">parameter </font>Integer nSta(min=1) = 10 <font color="darkgreen">&quot;Number of state variables in the soil&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</A> samplePeriod=604800 <font color="darkgreen">
    &quot;Sample period for the external boundary condition&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rBor=0.1 <font color="darkgreen">&quot;Radius of the borehole&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg <font color="darkgreen">&quot;Height of the element&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> xC=0.05 <font color="darkgreen">
    &quot;Shank spacing, defined as the distance between the center of a pipe and the center of the borehole&quot;</font>;
  <font color="blue">parameter </font>Real B0=17.44 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;
  <font color="blue">parameter </font>Real B1=-0.6052 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;

 <font color="blue">parameter </font>Boolean allowFlowReversal = true <font color="darkgreen">
    &quot;= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)&quot;</font>;

<textblock type="annotcomp" expanded="false"> <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement</A> pipFil(
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium = Medium,
    <font color="blue">final </font>matFil=matFil,
    <font color="blue">final </font>hSeg=hSeg,
    <font color="blue">final </font>rTub=rTub,
    <font color="blue">final </font>eTub=eTub,
    <font color="blue">final </font>kTub=kTub,
    <font color="blue">final </font>kSoi=matSoi.k,
    <font color="blue">final </font>xC=xC,
    <font color="blue">final </font>rBor=rBor,
    <font color="blue">final </font>TFil_start=TFil_start,
    <font color="blue">final </font>B0=B0,
    <font color="blue">final </font>B1=B1,
    <font color="blue">final </font>m1_flow_nominal=m_flow_nominal,
    <font color="blue">final </font>m2_flow_nominal=m_flow_nominal,
    <font color="blue">final </font>dp1_nominal=dp_nominal,
    <font color="blue">final </font>dp2_nominal=0,
    <font color="blue">final </font>from_dp1=from_dp,
    <font color="blue">final </font>from_dp2=from_dp,
    <font color="blue">final </font>linearizeFlowResistance1=linearizeFlowResistance,
    <font color="blue">final </font>linearizeFlowResistance2=linearizeFlowResistance,
    <font color="blue">final </font>deltaM1=deltaM,
    <font color="blue">final </font>deltaM2=deltaM,
    <font color="blue">final </font>m1_flow_small=m_flow_small,
    <font color="blue">final </font>m2_flow_small=m_flow_small,
    <font color="blue">final </font>allowFlowReversal1=allowFlowReversal,
    <font color="blue">final </font>allowFlowReversal2=allowFlowReversal,
    <font color="blue">final </font>homotopyInitialization=homotopyInitialization,
    <font color="blue">final </font>energyDynamics=energyDynamics,
    <font color="blue">final </font>massDynamics=massDynamics,
    <font color="blue">final </font>p1_start=p_start,
    T1_start=T_start,
    X1_start=X_start,
    C1_start=C_start,
    C1_nominal=C_nominal,
    <font color="blue">final </font>p2_start=p_start,
    T2_start=T_start,
    X2_start=X_start,
    C2_start=C_start,
    C2_nominal=C_nominal) <font color="darkgreen">
    &quot;Internal part of the borehole including the pipes and the filling material&quot;</font>;
  <A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayerCylinder"
>Buildings.HeatTransfer.Conduction.SingleLayerCylinder</A> soi(
    <font color="blue">final </font>material=matSoi,
    <font color="blue">final </font>h=hSeg,
    <font color="blue">final </font>nSta=nSta,
    <font color="blue">final </font>r_a=rBor,
    <font color="blue">final </font>r_b=rExt,
    <font color="blue">final </font>steadyStateInitial=false,
    <font color="blue">final </font>TInt_start=TFil_start,
    <font color="blue">final </font>TExt_start=TExt_start) <font color="darkgreen">&quot;Heat conduction in the soil&quot;</font>;
  <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition</A>
    TBouCon(
    <font color="blue">final </font>matSoi=matSoi,
    <font color="blue">final </font>rExt=rExt,
    <font color="blue">final </font>hSeg=hSeg,
    <font color="blue">final </font>TExt_start=TExt_start,
    <font color="blue">final </font>samplePeriod=samplePeriod) <font color="darkgreen">
    &quot;Thermal boundary condition for the far-field&quot;</font>;
<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Sensors.html#Modelica.Thermal.HeatTransfer.Sensors.HeatFlowSensor"
>Modelica.Thermal.HeatTransfer.Sensors.HeatFlowSensor</A> heaFlo;</textblock>
<font color="blue">equation </font>
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(pipFil.port_b1, port_b1);
  <font color="red">connect</font>(pipFil.port_a2, port_a2);
  <font color="red">connect</font>(pipFil.port_b2, port_b2);
  <font color="red">connect</font>(pipFil.port, heaFlo.port_a);
  <font color="red">connect</font>(heaFlo.port_b, soi.port_a);
  <font color="red">connect</font>(soi.port_b, TBouCon.port);
  <font color="red">connect</font>(port_a1, pipFil.port_a1);
  <font color="red">connect</font>(heaFlo.Q_flow, TBouCon.Q_flow);</textblock>
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>BoreholeSegment;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE HexInternalElement<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Fluid.HeatExchabc95f273374cc0cbementI.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.HexInternalElement</H2>
<B>Internal part of a borehole</B><p></P>
<IMG SRC="Buildings.Fluid.HeatExchabc95f273374cc0cbementD.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement">
<P></P><H3>Information</H3>

<p>
Model for the heat transfer between the fluid and within the borehole filling.
This model computes the dynamic response of the fluid in the tubes, and the heat transfer between the
fluid and the borehole filling, and the heat storage within the fluid and the borehole filling.
</p>
<p>
The heat conduction in the filling material is modeled using three three resistances model that are
arranged in a triangular configuration. 
Two of these resistances represent the heat conduction from the fluids to the external radius of
the borehole, and the other resistance represents the thermal interference between the two pipes.
</p>
<p>
The resistance between the fluid and the borehole wall are the sum of the 
convective resistance inside the tubes, the conductive resistance
of the tube wall and the conductive resistance of the filling material. 
They are obtained using
</p>
 <p align="center" style="font-style:italic;">
 G<sub>Con</sub> = 2 &pi; h<sub>seg</sub> r<sub>tub</sub> h<sub>in</sub> , 
 </p>
<p align="center" style="font-style:italic;">
G<sub>tub</sub> = 4 &pi; k<sub>tub</sub> h<sub>seg</sub> &frasl; ln( ( r<sub>tub</sub>+e<sub>tub</sub> ) &frasl; r<sub>tub</sub> ),
</p>
<p align="center" style="font-style:italic;">
G<sub>fil</sub>= k<sub>fil</sub> h<sub>seg</sub> &beta;<sub>0</sub> ( r<sub>Bor</sub> &frasl; r<sub>tub</sub> ) <sup>&beta;<sub>1</sub></sup> ,
</p>
<p> 
where <i>h<sub>seg</sub></i> is the height of the tube, 
<i>h<sub>in</sub></i> is the convection coefficient,
<i>k<sub>tub</sub></i> is the thermal conductivity of the tube, 
<i>e<sub>tub</sub></i> is the thickness of the tube,
and <i>&beta;<sub>0</sub>, &beta;<sub>1</sub></i> are the resistance shape factor coefficients
(Paul, 1996).
Paul's shape factors are based on experimental and finite element analysis of typical borehole.
The default values used for these coefficients are &beta;<sub>0</sub>= 20.100 and &beta;<sub>1</sub>=-0.94467.
Values listed by Paul are given in the table below.
</p>
  <table summary="summary">
  <tr><th>pipe spacing</th><th><i>&beta;<sub>0</sub></i></th><th><i>&beta;<sub>1</sub></i></th></tr>
  <tr><td> close  </td><td> 20.100377 </td><td> -0.94467 </td></tr>
  <tr><td> middle  </td><td> 17.44 </td><td> -0.6052  </td></tr>
  <tr><td> spaced </td><td> 21.91 </td><td> -0.3796 </td></tr>
  </table>
<h4>Implementation</h4>
<p>
The resistances between the fluid and the borehole wall are computed in
 <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance"
>
Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance</a>.
The resistance for the interference of the pipes is computed in
<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance"
>
Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance</a>. 
</p>
<P></P>
Extends from <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortHeatMassExchanger"
>Buildings.Fluid.Interfaces.FourPortHeatMassExchanger</A> (Model transporting two fluid streams between four ports with storing mass or energy).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 2 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Modelica.Media.Interfaces.Pa...</TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kSoi</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the soil used for the calculation of the internal interference resistance [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>&nbsp;</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the element [m]</TD></TR>
<TR><TD>Real</TD><TD>B0</TD><TD>17.44268</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD>Real</TD><TD>B1</TD><TD>-0.60515</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xC</TD><TD>0.05</TD><TD>Shank spacing definied as half the center-to-center distance between the two pipes [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1_nominal</TD><TD>&nbsp;</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2_nominal</TD><TD>&nbsp;</TD><TD>Pressure [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1.start</TD><TD>0</TD><TD>Pressure difference between port_a1 and port_b1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2.start</TD><TD>0</TD><TD>Pressure difference between port_a2 and port_b2 [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Filling material</TD></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_BoreholeFillings.html#Buildings.HeatTransfer.Data.BoreholeFillings.Generic"
>Generic</A></TD><TD>matFil</TD><TD>redeclare parameter Building...</TD><TD>Thermal properties of the filling material</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>TFil_start</TD><TD>283.15</TD><TD>Initial temperature of the filling material [K]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Pipes</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>0.02</TD><TD>Radius of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kTub</TD><TD>0.5</TD><TD>Thermal conductivity of the tubes [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>0.002</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal1</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal2</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_small</TD><TD>1E-4*abs(m1_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_small</TD><TD>1E-4*abs(m2_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Flow resistance</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Medium 1</TD></TR>
<TR><TD>Boolean</TD><TD>from_dp1</TD><TD>false</TD><TD>= true, use m_flow = f(dp) else dp = f(m_flow)</TD></TR>
<TR><TD>Boolean</TD><TD>linearizeFlowResistance1</TD><TD>false</TD><TD>= true, use linear relation between m_flow and dp for any flow rate</TD></TR>
<TR><TD>Real</TD><TD>deltaM1</TD><TD>0.1</TD><TD>Fraction of nominal flow rate where flow transitions to laminar</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Medium 2</TD></TR>
<TR><TD>Boolean</TD><TD>from_dp2</TD><TD>false</TD><TD>= true, use m_flow = f(dp) else dp = f(m_flow)</TD></TR>
<TR><TD>Boolean</TD><TD>linearizeFlowResistance2</TD><TD>false</TD><TD>= true, use linear relation between m_flow and dp for any flow rate</TD></TR>
<TR><TD>Real</TD><TD>deltaM2</TD><TD>0.1</TD><TD>Fraction of nominal flow rate where flow transitions to laminar</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Dynamics</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>tau1</TD><TD>Modelica.Constants.pi*rTub^2...</TD><TD>Time constant at nominal flow [s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>tau2</TD><TD>Modelica.Constants.pi*rTub^2...</TD><TD>Time constant at nominal flow [s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Equations</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</A></TD><TD>energyDynamics</TD><TD>Modelica.Fluid.Types.Dynamic...</TD><TD>Formulation of energy balance</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</A></TD><TD>massDynamics</TD><TD>energyDynamics</TD><TD>Formulation of mass balance</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialization</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Medium 1</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p1_start</TD><TD>Medium1.p_default</TD><TD>Start value of pressure [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Temperature</A></TD><TD>T1_start</TD><TD>TFil_start</TD><TD>Start value of temperature [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>X1_start[Medium1.nX]</TD><TD>Medium1.X_default</TD><TD>Start value of mass fractions m_i/m [kg/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ExtraProperty"
>ExtraProperty</A></TD><TD>C1_start[Medium1.nC]</TD><TD>fill(0, Medium1.nC)</TD><TD>Start value of trace substances</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ExtraProperty"
>ExtraProperty</A></TD><TD>C1_nominal[Medium1.nC]</TD><TD>fill(1E-2, Medium1.nC)</TD><TD>Nominal value of trace substances. (Set to typical order of magnitude.)</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Medium 2</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p2_start</TD><TD>Medium2.p_default</TD><TD>Start value of pressure [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Temperature</A></TD><TD>T2_start</TD><TD>TFil_start</TD><TD>Start value of temperature [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>X2_start[Medium2.nX]</TD><TD>Medium2.X_default</TD><TD>Start value of mass fractions m_i/m [kg/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ExtraProperty"
>ExtraProperty</A></TD><TD>C2_start[Medium2.nC]</TD><TD>fill(0, Medium2.nC)</TD><TD>Start value of trace substances</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ExtraProperty"
>ExtraProperty</A></TD><TD>C2_nominal[Medium2.nC]</TD><TD>fill(1E-2, Medium2.nC)</TD><TD>Nominal value of trace substances. (Set to typical order of magnitude.)</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD>Medium 2 in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a1</TD><TD>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b1</TD><TD>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a2</TD><TD>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b2</TD><TD>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port</TD><TD>Heat port that connects to filling material</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> HexInternalElement <font color="darkgreen">&quot;Internal part of a borehole&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortHeatMassExchanger"
>Buildings.Fluid.Interfaces.FourPortHeatMassExchanger</A>(
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium1 = <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses_Medium.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement.Medium"
>Medium</A>,
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium2 = <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses_Medium.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.HexInternalElement.Medium"
>Medium</A>,
    T1_start=TFil_start,
    T2_start=TFil_start,
    <font color="blue">final </font>tau1=Modelica.Constants.pi*rTub^2*hSeg*rho1_nominal/m1_flow_nominal,
    <font color="blue">final </font>tau2=Modelica.Constants.pi*rTub^2*hSeg*rho2_nominal/m2_flow_nominal,
    <font color="blue">final </font>show_T=false,
    vol1(<font color="blue">final </font>energyDynamics=energyDynamics,
         <font color="blue">final </font>massDynamics=massDynamics,
         <font color="blue">final </font>prescribedHeatFlowRate=false,
         <font color="blue">final </font>homotopyInitialization=homotopyInitialization,
         <font color="blue">final </font>allowFlowReversal=allowFlowReversal1,
         <font color="blue">final </font>V=m2_flow_nominal*tau2/rho2_nominal,
         <font color="blue">final </font>m_flow_small=m1_flow_small),
    <font color="blue">final </font>vol2(<font color="blue">final </font>energyDynamics=energyDynamics,
         <font color="blue">final </font>massDynamics=massDynamics,
         <font color="blue">final </font>prescribedHeatFlowRate=false,
         <font color="blue">final </font>homotopyInitialization=homotopyInitialization,
         <font color="blue">final </font>V=m1_flow_nominal*tau1/rho1_nominal,
         <font color="blue">final </font>m_flow_small=m2_flow_small));

  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A> <font color="darkgreen">
    &quot;Medium in the component&quot;</font>;

<textblock type="annotcomp" expanded="false">  <font color="blue">replaceable </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_BoreholeFillings.html#Buildings.HeatTransfer.Data.BoreholeFillings.Generic"
>Buildings.HeatTransfer.Data.BoreholeFillings.Generic</A> matFil <font color="darkgreen">
    &quot;Thermal properties of the filling material&quot;</font>;</textblock>

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rTub=0.02 <font color="darkgreen">&quot;Radius of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kTub=0.5 <font color="darkgreen">
    &quot;Thermal conductivity of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> eTub=0.002 <font color="darkgreen">&quot;Thickness of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kSoi <font color="darkgreen">
    &quot;Thermal conductivity of the soil used for the calculation of the internal interference resistance&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> TFil_start=283.15 <font color="darkgreen">
    &quot;Initial temperature of the filling material&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rBor <font color="darkgreen">&quot;Radius of the borehole&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg <font color="darkgreen">&quot;Height of the element&quot;</font>;

  <font color="blue">parameter </font>Real B0=17.44268 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;
  <font color="blue">parameter </font>Real B1=-0.60515 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> xC=0.05 <font color="darkgreen">
    &quot;Shank spacing definied as half the center-to-center distance between the two pipes&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> port <font color="darkgreen">
    &quot;Heat port that connects to filling material&quot;</font>;</textblock>
<font color="blue">protected </font>
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</A> cpFil=matFil.c <font color="darkgreen">
    &quot;Specific heat capacity of the filling material&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kFil=matFil.k <font color="darkgreen">
    &quot;Thermal conductivity of the filling material&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> dFil=matFil.d <font color="darkgreen">
    &quot;Density of the filling material&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>Modelica.SIunits.HeatCapacity</A> Co_fil=0.5*dFil*cpFil*hSeg*Modelica.Constants.pi
      *(rBor^2 - 2*(rTub + eTub)^2) <font color="darkgreen">&quot;Heat capacity of the filling material&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.HeatCapacitor"
>Modelica.Thermal.HeatTransfer.Components.HeatCapacitor</A> cap2(C=Co_fil, T(start=
         TFil_start)) <font color="darkgreen">&quot;Heat capacity of the filling material&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.HeatCapacitor"
>Modelica.Thermal.HeatTransfer.Components.HeatCapacitor</A> cap1(C=Co_fil,T(start=
          TFil_start)) <font color="darkgreen">&quot;Heat capacity of the filling material&quot;</font>;
  <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance"
>BoreholeResistance</A> con1(
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium = Medium,
    <font color="blue">final </font>rBor=rBor,
    <font color="blue">final </font>rTub=rTub,
    <font color="blue">final </font>eTub=eTub,
    <font color="blue">final </font>kTub=kTub,
    <font color="blue">final </font>kFil=kFil,
    <font color="blue">final </font>hSeg=hSeg,
    <font color="blue">final </font>B0=B0,
    <font color="blue">final </font>B1=B1,
    <font color="blue">final </font>m_flow_nominal=m1_flow_nominal,
    homotopyInitialization=homotopyInitialization) <font color="darkgreen">
    &quot;Thermal resistance from the fluid to the wall of the borehole&quot;</font>;
  <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance"
>BoreholeResistance</A> con2(
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium = Medium,
    <font color="blue">final </font>rBor=rBor,
    <font color="blue">final </font>rTub=rTub,
    <font color="blue">final </font>eTub=eTub,
    <font color="blue">final </font>kTub=kTub,
    <font color="blue">final </font>kFil=kFil,
    <font color="blue">final </font>hSeg=hSeg,
    <font color="blue">final </font>B0=B0,
    <font color="blue">final </font>B1=B1,
    <font color="blue">final </font>m_flow_nominal=m1_flow_nominal,
    homotopyInitialization=homotopyInitialization) <font color="darkgreen">
    &quot;Thermal resistance from the fluid to the wall of the borehole&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance"
>InterferenceResistance</A> con12(
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium = Medium,
    <font color="blue">final </font>rBor=rBor,
    <font color="blue">final </font>rTub=rTub,
    <font color="blue">final </font>eTub=eTub,
    <font color="blue">final </font>kTub=kTub,
    <font color="blue">final </font>kFil=kFil,
    <font color="blue">final </font>kSoi=kSoi,
    <font color="blue">final </font>hSeg=hSeg,
    <font color="blue">final </font>xC=xC,
    <font color="blue">final </font>B0=B0,
    <font color="blue">final </font>B1=B1,
    <font color="blue">final </font>m_flow_nominal=m1_flow_nominal,
    homotopyInitialization=homotopyInitialization) <font color="darkgreen">
    &quot;Interference resistance between the two pipes&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</A> m_flow(y=port_a1.m_flow) <font color="darkgreen">
    &quot;Mass flow rate&quot;</font>;</textblock>
<font color="blue">equation </font>
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(vol1.heatPort, cap1.port);
  <font color="red">connect</font>(vol2.heatPort, cap2.port);
  <font color="red">connect</font>(cap1.port, con12.port_a);
  <font color="red">connect</font>(cap1.port, con1.port_a);
  <font color="red">connect</font>(con12.port_b, cap2.port);
  <font color="red">connect</font>(con2.port_a, cap2.port);
  <font color="red">connect</font>(con1.port_b, port);
  <font color="red">connect</font>(con2.port_b, port);
  <font color="red">connect</font>(m_flow.y, con1.m_flow);
  <font color="red">connect</font>(m_flow.y, con2.m_flow);
  <font color="red">connect</font>(m_flow.y, con12.m_flow);</textblock>
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>HexInternalElement;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BoreholeResistance<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceI.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.BoreholeResistance</H2>
<B>Thermal resistance of the borehole</B><p></P>
<IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceD.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.BoreholeResistance">
<P></P><H3>Information</H3>

<p>
This model computes the total thermal resistance from the fluid to the borehole wall. 
This thermal resistance is then used for a three-resistance model.
It assumes that the pipe configuration is symmetric. 
The resistance is obtain using
</p>
<p align="center" style="font-style:italic;">
 R = 2 R<sub>b</sub>,
</p>
<p>
where <i>R<sub>b</sub></i> is the total borehole resistance as defined by Hellstrom (1991). 
</p>
<p>
The resistance <i>R<sub>b</sub></i> includes three different thermal resistances:
</p>
<ol>
<li>
a convective resistance from the brine to the pipe wall,
</li>
<li>
a thermal resistance of the pipe wall, and
</li>
<li>
the thermal resistance of the filling material.
</li>
</ol>
<h4>Implementation</h4>
<p>
The calculation of <i>R<sub>b</sub></i> is done using the function
<a href="modelica://Buildings.Fluid.Boreholes.BaseClasses.boreholeThermalResistance">
Buildings.Fluid.Boreholes.BaseClasses.boreholeThermalResistance</a>.
</p>
<h4>References</h4>
<p>
Hellstrom, G (1991). <br/>
 <a href="http://intraweb.stockton.edu/eyos/energy_studies/content/docs/proceedings/HELLS.PDF">
 Thermal Performance of Borehole Heat Exchangers</a>.<br/> 
Department of Mathematical Physics, Lund Institute of Technology.
</p>
<P></P>
Extends from <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance</A> (Partial model for thermal resistance of the borehole).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>&nbsp;</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kFil</TD><TD>&nbsp;</TD><TD>[W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the segment [m]</TD></TR>
<TR><TD>Real</TD><TD>B0</TD><TD>17.44268</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD>Real</TD><TD>B1</TD><TD>-0.60515</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Pipes</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>&nbsp;</TD><TD>Radius of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kTub</TD><TD>4</TD><TD>Thermal conductivity of the tubes [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>0.002</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>m_flow</TD><TD>Mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> BoreholeResistance <font color="darkgreen">&quot;Thermal resistance of the borehole&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance</A>;

<font color="blue">equation </font>
  <font color="blue">if </font>homotopyInitialization<font color="blue"> then</font>
    Rb =<font color="red"> homotopy</font>(actual=<font color="red">Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance</font>(
          hSeg=hSeg, rBor=rBor, rTub=rTub, eTub=eTub, kTub=kTub, kFil=kFil,
          kMed=kMed, mueMed=mueMed, cpFluid=cpFluid, m_flow=m_flow, m_flow_nominal=m_flow_nominal,
          B0=B0, B1=B1),
                  simplified=<font color="red">  Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance</font>(
          hSeg=hSeg, rBor=rBor, rTub=rTub, eTub=eTub, kTub=kTub, kFil=kFil,
          kMed=kMed, mueMed=mueMed, cpFluid=cpFluid, m_flow=m_flow_nominal, m_flow_nominal=m_flow_nominal,
          B0=B0, B1=B1));
  <font color="blue">else</font>
    Rb =<font color="red"> Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance</font>(
          hSeg=hSeg, rBor=rBor, rTub=rTub, eTub=eTub, kTub=kTub, kFil=kFil,
          kMed=kMed, mueMed=mueMed, cpFluid=cpFluid, m_flow=m_flow, m_flow_nominal=m_flow_nominal,
          B0=B0, B1=B1);
  <font color="blue">end if</font>;
  G = 1/(2*Rb);
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>BoreholeResistance;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE InterferenceResistance<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceI.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.InterferenceResistance</H2>
<B>Total interference resistance between the two pipes of a borehole</B><p></P>
<IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceD.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.InterferenceResistance">
<P></P><H3>Information</H3>

<p>
This model computes the interference resistance between the two pipes of a U-tube borehole. 
It computes the resistance using the 
internal resistance <i>R<sub>a</sub></i> and
the borehole total resistance <i>R<sub>b</sub></i>.
</p>
<p>
The coupling resistance is obtained using
</p>
<p align="center" style="font-style:italic;">
  R<sub>i</sub> = 4 R<sub>b</sub> R<sub>a</sub> &frasl; (4 R<sub>b</sub>- R<sub>a</sub>).
</p>
<h4>Implementation</h4>
<p>
The two resistances are calculated by the functions 
<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance"
>
Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance</a> for <i>R<sub>b</sub></i> 
 and 
 <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeInternalResistance"
>
Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeInternalResistance</a> for <i>R<sub>a</sub></i>.
</p>
<P></P>
Extends from <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance</A> (Partial model for thermal resistance of the borehole).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>&nbsp;</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kFil</TD><TD>&nbsp;</TD><TD>[W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the segment [m]</TD></TR>
<TR><TD>Real</TD><TD>B0</TD><TD>17.44268</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD>Real</TD><TD>B1</TD><TD>-0.60515</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xC</TD><TD>&nbsp;</TD><TD>Shank spacing definied as half the center-to-center distance between the two pipes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kSoi</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the soil used for the calculation of the internal interference resistance [W/(m.K)]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Pipes</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>&nbsp;</TD><TD>Radius of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kTub</TD><TD>4</TD><TD>Thermal conductivity of the tubes [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>0.002</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>m_flow</TD><TD>Mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> InterferenceResistance <font color="darkgreen">
  &quot;Total interference resistance between the two pipes of a borehole&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance</A>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> xC <font color="darkgreen">
    &quot;Shank spacing definied as half the center-to-center distance between the two pipes&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kSoi <font color="darkgreen">
    &quot;Thermal conductivity of the soil used for the calculation of the internal interference resistance&quot;</font>;

<font color="blue">protected </font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> Ra=<font color="red">boreholeInternalResistance</font>(
      hSeg=hSeg,
      rBor=rBor,
      rTub=rTub,
      eTub=eTub,
      xC=xC,
      kFil=kFil,
      kSoi=kSoi) <font color="darkgreen">&quot;Borehole internal resistance&quot;</font>;

<font color="blue">equation </font>
  <font color="blue">if </font>homotopyInitialization<font color="blue"> then</font>
    Rb =<font color="red"> homotopy</font>(actual=<font color="red">boreholeThermalResistance</font>(
            hSeg=hSeg, rBor=rBor, rTub=rTub, eTub=eTub, kTub=kTub,
            kFil=kFil, kMed=kMed, mueMed=mueMed, cpFluid=cpFluid, m_flow=m_flow,
            m_flow_nominal=m_flow_nominal, B0=B0, B1=B1),
         simplified=<font color="red">boreholeThermalResistance</font>(
            hSeg=hSeg, rBor=rBor, rTub=rTub, eTub=eTub, kTub=kTub,
            kFil=kFil, kMed=kMed, mueMed=mueMed, cpFluid=cpFluid, m_flow=m_flow_nominal,
            m_flow_nominal=m_flow_nominal, B0=B0, B1=B1));
  <font color="blue">else</font>
   Rb =<font color="red"> boreholeThermalResistance</font>(
    hSeg=hSeg, rBor=rBor, rTub=rTub, eTub=eTub, kTub=kTub,
    kFil=kFil, kMed=kMed, mueMed=mueMed, cpFluid=cpFluid, m_flow=m_flow,
    m_flow_nominal=m_flow_nominal, B0=B0, B1=B1);
  <font color="blue">end if</font>;
  G = (4*Rb - Ra)/(4*Rb*Ra);
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>InterferenceResistance;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PartialBoreholeResistance<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Fluid.HeatExchad1d9b408bdcb3284tanceI.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.PartialBoreholeResistance</H2>
<B>Partial model for thermal resistance of the borehole</B><p></P>
<IMG SRC="Buildings.Fluid.HeatExchafa2039679592bb5etanceD.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.PartialBoreholeResistance">
<P></P><H3>Information</H3>

<p>
Partial model for the thermal resistance of the borehole.
</p>
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Modelica.Media.Interfaces.Pa...</TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>&nbsp;</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kFil</TD><TD>&nbsp;</TD><TD>[W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the segment [m]</TD></TR>
<TR><TD>Real</TD><TD>B0</TD><TD>17.44268</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD>Real</TD><TD>B1</TD><TD>-0.60515</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Pipes</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>&nbsp;</TD><TD>Radius of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kTub</TD><TD>4</TD><TD>Thermal conductivity of the tubes [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>0.002</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Medium in the component</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>m_flow</TD><TD>Mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> PartialBoreholeResistance <font color="darkgreen">
  &quot;Partial model for thermal resistance of the borehole&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A> <font color="darkgreen">
    &quot;Medium in the component&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rTub <font color="darkgreen">&quot;Radius of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kTub=4 <font color="darkgreen">
    &quot;Thermal conductivity of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> eTub=0.002 <font color="darkgreen">&quot;Thickness of the tubes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rBor <font color="darkgreen">&quot;Radius of the borehole&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kFil;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg <font color="darkgreen">&quot;Height of the segment&quot;</font>;
  <font color="blue">parameter </font>Real B0=17.44268 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;
  <font color="blue">parameter </font>Real B1=-0.60515 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> m_flow_nominal <font color="darkgreen">
    &quot;Nominal mass flow rate&quot;</font>;

  <font color="blue">parameter </font>Boolean homotopyInitialization = true <font color="darkgreen">&quot;= true, use homotopy method&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> m_flow(unit=&quot;kg/s&quot;) <font color="darkgreen">&quot;Mass flow rate&quot;</font>;</textblock>

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</A> G <font color="darkgreen">&quot;Thermal conductance&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> Q_flow <font color="darkgreen">&quot;Heat flow rate from port_a to port_b&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">&quot;= port_a.T - port_b.T&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> port_a;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> port_b;</textblock>

<font color="blue">protected </font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</A> cpFluid=
      <font color="red">Medium.specificHeatCapacityCp</font>(<font color="red">Medium.setState_pTX</font>(
      Medium.p_default,
      Medium.T_default,
      Medium.X_default)) <font color="darkgreen">&quot;Specific heat capacity of the fluid&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kMed=
      <font color="red">Medium.thermalConductivity</font>(<font color="red">Medium.setState_pTX</font>(
      Medium.p_default,
      Medium.T_default,
      Medium.X_default)) <font color="darkgreen">&quot;Thermal conductivity of the fluid&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>Modelica.SIunits.DynamicViscosity</A> mueMed=<font color="red">Medium.dynamicViscosity</font>(
      <font color="red">Medium.setState_pTX</font>(
      Medium.p_default,
      Medium.T_default,
      Medium.X_default)) <font color="darkgreen">&quot;Dynamic viscosity of the fluid&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> Rb <font color="darkgreen">&quot;Borehole thermal resistance&quot;</font>;
<font color="blue">equation </font>
  dT = port_a.T - port_b.T;
  port_a.Q_flow = Q_flow;
  port_b.Q_flow = -Q_flow;
  Q_flow = G*dT;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>PartialBoreholeResistance;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SingleUTubeBoundaryCondition<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Fluid.HeatExcha08bcfd6b3be32707itionI.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.SingleUTubeBoundaryCondition</H2>
<B>Prescribed temperature at the outer boundary of a single U tube borehole</B><p></P>
<IMG SRC="Buildings.Fluid.HeatExcha08bcfd6b3be32707itionD.png" ALT="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.SingleUTubeBoundaryCondition">
<P></P><H3>Information</H3>

<p>
This model computes the temperature boundary condition at the outer boundary of the borehole.
It takes as an input the heat flow rate at the center of the borehole.
This heat flow rate is averaged over the sample period.
At each sampling interval, typically every one week, a new temperature boundary conditions is computed using
the analytical solution to a line source heat transfer problem.
</p>
<h4>Implementation</h4>
<p>
The computation of the temperature change of the boundary is computed using the function
<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.temperatureDrop"
>
Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.temperatureDrop</a>.
</p>
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Generic</A></TD><TD>matSoi</TD><TD>redeclare parameter Building...</TD><TD>Thermal properties of the soil</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rExt</TD><TD>3</TD><TD>Distance from the brine where the calculation is performed [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>10</TD><TD>Height of the segment [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>TExt_start</TD><TD>283.15</TD><TD>Initial external temperature [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>samplePeriod</TD><TD>604800</TD><TD>Period between two samples [s]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>Q_flow</TD><TD>Heat flow rate at the center of the borehole, positive if heat is added to soil [W]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port</TD><TD>Heat port</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SingleUTubeBoundaryCondition <font color="darkgreen">
  &quot;Prescribed temperature at the outer boundary of a single U tube borehole&quot;</font>
  <font color="blue">replaceable </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Buildings.HeatTransfer.Data.Soil.Generic</A> matSoi <font color="darkgreen">
    &quot;Thermal properties of the soil&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rExt=3 <font color="darkgreen">
    &quot;Distance from the brine where the calculation is performed&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg=10 <font color="darkgreen">&quot;Height of the segment&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> TExt_start=283.15 <font color="darkgreen">
    &quot;Initial external temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</A> samplePeriod=604800 <font color="darkgreen">
    &quot;Period between two samples&quot;</font>;
  <A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A> table=<font color="red">ExtendableArray</font>() <font color="darkgreen">
    &quot;Extentable array, used to store history of rate of heat flows&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> QAve_flow <font color="darkgreen">
    &quot;Average heat flux over a time period&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> Q_flow(unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Heat flow rate at the center of the borehole, positive if heat is added to soil&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> port <font color="darkgreen">&quot;Heat port&quot;</font>;</textblock>
<font color="blue">protected </font>
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</A> c= matSoi.c <font color="darkgreen">
    &quot;Specific heat capacity of the soil&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> k= matSoi.k <font color="darkgreen">
    &quot;Thermal conductivity of the soil&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> d = matSoi.d <font color="darkgreen">&quot;Density of the soil&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Modelica.SIunits.Energy</A> UOld <font color="darkgreen">&quot;Internal energy at the previous period&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Modelica.SIunits.Energy</A> U <font color="darkgreen">
    &quot;Current internal energy, defined as U=0 for t=tStart&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</A> startTime(fixed=false) <font color="darkgreen">
    &quot;Start time of the simulation&quot;</font>;
  Integer iSam(min=1) <font color="darkgreen">
    &quot;Counter for how many time the model was sampled. Defined as iSam=1 when called at t=0&quot;</font>;
<font color="blue">initial </font><font color="blue">algorithm </font>
  U         := 0;
  UOld      := 0;
  startTime := time;
  iSam      := 1;
<font color="blue">equation </font>
  <font color="red">der</font>(U) = Q_flow;
<font color="blue">algorithm </font>
  <font color="blue">when </font><font color="red">initial</font>()<font color="blue"> or </font><font color="red">sample</font>(startTime,samplePeriod)<font color="blue"> then</font>
    QAve_flow := (U-UOld)/samplePeriod;
    UOld      := U;
    port.T    := TExt_start +<font color="red"> Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.temperatureDrop</font>(
                                 table=table, iSam=iSam,
                                 Q_flow=QAve_flow, samplePeriod=samplePeriod,
                                 rExt=rExt, hSeg=hSeg,
                                 k=k, d=d, c=c);
    iSam := iSam+1;
  <font color="blue">end when</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>SingleUTubeBoundaryCondition;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ExtendableArray<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.ExtendableArray</H2>
<B>class used to create the external object: ExtendableArray</B><p></P>
<P></P><H3>Information</H3>

<p>
Class derived from <code>ExternalObject</code> having two local external function definition, 
named <code>destructor</code> and <code>constructor</code> respectively.
<p>
These functions create and release an external object that allows the the storage 
of real parameters in an array of extendable dimension.

<P></P>
Extends from <code>ExternalObject</code>.
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">class</font> ExtendableArray <font color="darkgreen">
  &quot;class used to create the external object: ExtendableArray&quot;</font>
<font color="blue">extends </font>ExternalObject;
    <textblock type="model" expanded="false" path="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray.constructor"><font color="blue">function</font> constructor <font color="darkgreen">
    &quot;Construct an extendable array that can be used to store double values&quot;</font>
    <font color="blue">output </font><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A> table;
    <font color="blue">external</font> &quot;C&quot; table = <font color="red">initArray</font>();
<textblock type="annotcomp" expanded="false">    <font color="blue">end </font>constructor</textblock>;

  <textblock type="model" expanded="false" path="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray.destructor"><font color="blue">function</font> destructor <font color="darkgreen">
    &quot;Release storage of table and close the external object&quot;</font>
    <font color="blue">input </font><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A>  table;
    <font color="blue">external</font> &quot;C&quot; <font color="red">freeArray</font>(table);
<textblock type="annotcomp" expanded="false">  <font color="blue">end </font>destructor</textblock>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ExtendableArray;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE boreholeInternalResistance<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeInternalResistance"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.boreholeInternalResistance</H2>
<B>Calculate the internal resistance of the borehole</B><p></P>
<P></P><H3>Information</H3>

<p>
This model computes the internal resistance <i>R</i> of a single U-tube borehole, 
as defined by Hellstrom (1991), as 
</p>
<p align="center" style="font-style:italic;">
 k = ( 2 P<sub>1</sub> ( P<sub>2</sub><sup>2</sup> + 1 ) <sup>W</sup> ) / ( P<sub>2</sub> ( P<sub>2</sub><sup>2</sup> - 1 )<sup>W</sup> ),
</p>
<p align="center" style="font-style:italic;">
 R = ln(k) / (&pi; k<sub>fil</sub> h<sub>seg</sub>) ,
 </p>
where <i>P<sub>1</sub> </i> and <i>P<sub>2</sub></i> are two dimensionless geometrical factors and
<i>W</i> is a conductivity ratio.
The geometrical factors are defined as
<i>P<sub>1</sub> = r<sub>bor</sub>/(r<sub>tub</sub> + e<sub>tub</sub>)</i>, 
where <i>r<sub>bor</sub></i> is the borehole radius and  <i>r<sub>tub</sub> + e<sub>tub</sub> </i> is
the external radius of a pipe and
<i>P<sub>2</sub> = r<sub>bor</sub>/ x<sub>c</sub> </i>, where
<i>x<sub>c</sub></i> is the shank spacing defined as half the center-to-center distance 
between the two pipes, and
<i>W = k<sub>fil</sub> - k<sub>soi</sub>/ (k<sub>soi</sub> + k<sub>fil</sub>)</i>.
<br/>
<h4>References</h4>

Hellstrom, G (1991). <br/>
 <a href="http://intraweb.stockton.edu/eyos/energy_studies/content/docs/proceedings/HELLS.PDF">
 Thermal Performance of Borehole Heat Exchangers</a>.<br/> 
Department of Mathematical Physics, Lund Institute of Technology.

<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the element [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>&nbsp;</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>&nbsp;</TD><TD>Radius of the tube [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>&nbsp;</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xC</TD><TD>&nbsp;</TD><TD>Shank spacing, defined as half the center-to-center distance between the two pipes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kFil</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the filling material [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kSoi</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the soil [W/(m.K)]</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>ThermalResistance</A></TD><TD>R</TD><TD>Internal resistance of the borehole [K/W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> boreholeInternalResistance <font color="darkgreen">
  &quot;Calculate the internal resistance of the borehole&quot;</font>
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg <font color="darkgreen">&quot;Height of the element&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rBor <font color="darkgreen">&quot;Radius of the borehole&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rTub <font color="darkgreen">&quot;Radius of the tube&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> eTub <font color="darkgreen">&quot;Thickness of the tubes&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> xC <font color="darkgreen">
    &quot;Shank spacing, defined as half the center-to-center distance between the two pipes&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kFil <font color="darkgreen">
    &quot;Thermal conductivity of the filling material&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kSoi <font color="darkgreen">
    &quot;Thermal conductivity of the soil&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> R <font color="darkgreen">
    &quot;Internal resistance of the borehole&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">final </font><font color="blue">parameter </font>Real P1=rBor/(rTub + eTub) <font color="darkgreen">
    &quot;Non-dimensional geometrical parameter &quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real P2=rBor/xC <font color="darkgreen">&quot;Non-dimensional geometrical parameter &quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real P3=(kFil - kSoi)/(kFil + kSoi) <font color="darkgreen">
    &quot;Non-dimensional parameter for filling and soil conductivity&quot;</font>;
<font color="blue">algorithm </font>
  <font color="red">assert</font>(xC &gt; (rTub + eTub)<font color="blue"> and </font>xC &lt; rBor - (rTub + eTub),
  &quot;Parameters do not correspond to physically possible location of borehole tube.
    xC   = &quot; +<font color="red"> String</font>(xC) + &quot;
    rTub = &quot; +<font color="red"> String</font>(rTub) + &quot;
    eTub = &quot; +<font color="red"> String</font>(eTub) + &quot;.&quot;);
  R :=<font color="red"> Modelica.Math.log</font>((2*P1*(P2^2 + 1)^P3)/(P2*(P2^2 - 1)^P3))/
           (Modelica.Constants.pi*kFil*hSeg);
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>boreholeInternalResistance;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE boreholeThermalResistance<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.boreholeThermalResistance"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.boreholeThermalResistance</H2>
<B>Calculate the total thermal resistance of the borehole from the fluid to the soil</B><p></P>
<P></P><H3>Information</H3>

<p>
This model computes the borehole total thermal resistance for a single U-tube.
The computation is as defined in Hellstom (1991).
The total thermal resistance is the contribution of three different resistances as
</p>
<p align="center" style="font-style:italic;">
 R<sub>tot</sub>= R<sub>Con</sub> + R<sub>tub</sub> + R<sub>fil</sub>.
</p>
<p>
where 
<i>R<sub>Con</sub></i> is the convective resistance of the fluid, 
<i>R<sub>tub</sub></i> is the conductive resistance of the tube wall and 
<i>R<sub>fil</sub></i> is the resistance of the filling material.
</p>
<p>
The convective resistance is obtained as</p>
<p align="center" style="font-style:italic;">
 R<sub>Con</sub> = 1 &frasl; (4 &pi; h<sub>seg</sub> r<sub>tub</sub> h<sub>in</sub>),
</p>
<p>
where <i>h<sub>seg</sub></i> is the height of the segment and 
<i>h<sub>in</sub></i> is the convective heat transfer coefficient. 
The convective heat transfer coefficient is determined using the 
Dittus-Boelter correlation,
</p>
<p align="center" style="font-style:italic;">
 h<sub>in</sub>= 0.023 k<sub>med</sub> Pr<sup>0.35</sup> Re<sup>0.8</sup> &frasl; 2 r<sub>tub</sub>,
</p>
<p>
where <i>k<sub>med</sub></i> is the thermal conductivity of the fluid, 
<i>Pr</i> is the Prandtl number, 
<i>Re</i> is the Reynolds number and 
<i>r<sub>tub</sub></i> is the inside radius of the pipe.
</p>

<p>
The conductive resistance is determined using</p>
<p align="center" style="font-style:italic;">
R<sub>tub</sub>= ln[ ( r<sub>tub</sub>+e<sub>tub</sub> ) &frasl; r<sub>tub</sub> ] &frasl; 4 &pi; 
   k<sub>tub</sub> h<sub>seg</sub>,
</p>
<p>
where <i>k<sub>tub</sub></i> the heat conductivity of the pipe and 
<i>e<sub>tub</sub></i> is the thickness of the wall.
</p>

<p>
The resistance of the filling material is determined using the correlation from Paul (1996) :</p>
<p align="center" style="font-style:italic;">
R<sub>fil</sub> = k<sub>fil</sub> h<sub>seg</sub> &beta;<sub>0</sub> 
  (r<sub>Bor</sub> &frasl; (r<sub>tub</sub> + e<sub>tub</sub>)) <sup>&beta;<sub>1</sub></sup> ,
</p>
<p>
where <i>k<sub>fil</sub></i> is the thermal conductivity of the filling material and 
<i>&beta;<sub>0</sub>, &beta;<sub>1</sub></i> are the resistance shape factors
(Paul 1996) based on U-tube shank spacing.
Paul's shape factors are based on experimental and finite element analysis of typical borehole.
The default values used for these coefficients are &beta;<sub>0</sub>= 20.100 and &beta;<sub>1</sub>=-0.94467.
Values listed by Paul are given in the table below.</p>

  <table summary="summary" >
  <tr><th>pipe spacing</th><th><i>&beta;<sub>0</sub></i></th><th><i>&beta;<sub>1</sub></i></th></tr>
  <tr><td> close  </td><td> 20.100377 </td><td> -0.94467 </td></tr>
  <tr><td> middle  </td><td> 17.44 </td><td> -0.6052  </td></tr>
  <tr><td> spaced </td><td> 21.91 </td><td> -0.3796 </td></tr>
  </table>

<h4>References</h4>
<p>
Hellstrom, G (1991). <br/>
 <a href="http://intraweb.stockton.edu/eyos/energy_studies/content/docs/proceedings/HELLS.PDF">
 Thermal Performance of Borehole Heat Exchangers</a>.<br/> 
Department of Mathematical Physics, Lund Institute of Technology.
</p>
<p>
Paul, N.D (1996). <i>The effect of grout thermal conductivity on vertical geothermal heat exchanger design
and performance.</i> 
Master of Science Thesis, South Dakota State University.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the element [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rBor</TD><TD>&nbsp;</TD><TD>Radius of the borehole [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rTub</TD><TD>&nbsp;</TD><TD>Radius of the tube [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>eTub</TD><TD>&nbsp;</TD><TD>Thickness of the tubes [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kTub</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the tubes [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kFil</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the filling material [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kMed</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the fluid [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mueMed</TD><TD>&nbsp;</TD><TD>Dynamic viscosity of the fluid [Pa.s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A></TD><TD>cpFluid</TD><TD>&nbsp;</TD><TD>Specific heat capacity of the fluid [J/(kg.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow</TD><TD>&nbsp;</TD><TD>Mass flow rate of the fluid [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD>Real</TD><TD>B0</TD><TD>&nbsp;</TD><TD>Shape coefficient for grout resistance</TD></TR>
<TR><TD>Real</TD><TD>B1</TD><TD>&nbsp;</TD><TD>Shape coefficient for grout resistance</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>ThermalResistance</A></TD><TD>Rb</TD><TD>Borehole thermal resistance [K/W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> boreholeThermalResistance <font color="darkgreen">
  &quot;Calculate the total thermal resistance of the borehole from the fluid to the soil&quot;</font>
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg <font color="darkgreen">&quot;Height of the element&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rBor <font color="darkgreen">&quot;Radius of the borehole&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rTub <font color="darkgreen">&quot;Radius of the tube&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> eTub <font color="darkgreen">&quot;Thickness of the tubes&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kTub <font color="darkgreen">
    &quot;Thermal conductivity of the tubes&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kFil <font color="darkgreen">
    &quot;Thermal conductivity of the filling material&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> kMed <font color="darkgreen">
    &quot;Thermal conductivity of the fluid&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>Modelica.SIunits.DynamicViscosity</A> mueMed <font color="darkgreen">
    &quot;Dynamic viscosity of the fluid&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</A> cpFluid <font color="darkgreen">
    &quot;Specific heat capacity of the fluid&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> m_flow <font color="darkgreen">&quot;Mass flow rate of the fluid&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> m_flow_nominal <font color="darkgreen">&quot;Nominal mass flow rate&quot;</font>;
  <font color="blue">input </font>Real B0 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;
  <font color="blue">input </font>Real B1 <font color="darkgreen">&quot;Shape coefficient for grout resistance&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> Rb <font color="darkgreen">&quot;Borehole thermal resistance&quot;</font>;
<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</A> h <font color="darkgreen">
    &quot;Convective heat transfer coefficient of the fluid&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> RCon <font color="darkgreen">
    &quot;Convective thermal resistance of the fluid&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> RTub <font color="darkgreen">
    &quot;Thermal resistance of the pipe&#39;s wall&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> RFil <font color="darkgreen">
    &quot;Thermal resistance of the filling material&quot;</font>;
  Real k(unit=&quot;s/kg&quot;) <font color="darkgreen">
    &quot;Coefficient used in the computation of the convective heat transfer coefficient&quot;</font>;
<font color="blue">algorithm </font>
  k :=2/(mueMed*Modelica.Constants.pi*rTub);
  h := 0.023*kMed*(cpFluid*mueMed/kMed)^(0.35)/(2*rTub) *
    <font color="red">Buildings.Utilities.Math.Functions.regNonZeroPower</font>(
    x=m_flow*k, n=0.8,
    delta=0.01*m_flow_nominal*k);
  RCon := 1/(4*Modelica.Constants.pi*rTub*hSeg*h);
  RTub :=<font color="red"> Modelica.Math.log</font>((rTub + eTub)/rTub)/(4*Modelica.Constants.pi*hSeg*kTub);
  RFil := 1/(hSeg*kFil*B0*(rBor/(rTub + eTub))^B1);
  Rb := RCon + RTub + RFil;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>boreholeThermalResistance;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE exchangeValues<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.exchangeValues</H2>
<B>Store the value u at the element n in the external object, and return the value of the element i</B><p></P>
<P></P><H3>Information</H3>

<p>
External function that stores the input value <code>x</code> as the element
<code>a[iX]</code> in the array 
<code>a = [a[1], a[2], ...]</code>,
and that returns the element <code>a[iY]</code>.
The size of the array <code>a</code> is automatically enlarged as needed.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A></TD><TD>table</TD><TD>&nbsp;</TD><TD>External object</TD></TR>
<TR><TD>Integer</TD><TD>iX</TD><TD>&nbsp;</TD><TD>One-based index where u needs to be stored in the array of the external object</TD></TR>
<TR><TD>Real</TD><TD>x</TD><TD>&nbsp;</TD><TD>Value to store in the external object</TD></TR>
<TR><TD>Integer</TD><TD>iY</TD><TD>&nbsp;</TD><TD>One-based index of the element that needs to be returned from C to Modelica</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>y</TD><TD>Value of the i-th element</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> exchangeValues <font color="darkgreen">
  &quot;Store the value u at the element n in the external object, and return the value of the element i&quot;</font>
  <font color="blue">input </font><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A> table <font color="darkgreen">&quot;External object&quot;</font>;
  <font color="blue">input </font>Integer iX <font color="darkgreen">
    &quot;One-based index where u needs to be stored in the array of the external object&quot;</font>;
  <font color="blue">input </font>Real x <font color="darkgreen">&quot;Value to store in the external object&quot;</font>;
  <font color="blue">input </font>Integer iY <font color="darkgreen">
    &quot;One-based index of the element that needs to be returned from C to Modelica&quot;</font>;
  <font color="blue">output </font>Real y <font color="darkgreen">&quot;Value of the i-th element&quot;</font>;
<font color="blue">external</font>&quot;C&quot; y = <font color="red">exchangeValues</font>(table, iX, x, iY);
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>exchangeValues;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE factorial<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.factorial"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.factorial</H2>
<B>Calculates the factorial value of the input</B><p></P>
<P></P><H3>Information</H3>

<p>
This function computes <i>y = j!</i>.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>j</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>f</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> factorial <font color="darkgreen">&quot;Calculates the factorial value of the input&quot;</font>
  <font color="blue">input </font>Integer j;
  <font color="blue">output </font>Integer f;
<font color="blue">algorithm </font>
  f := 1;
  <font color="blue">for </font>i<font color="blue"> in </font>1:j<font color="blue"> loop</font>
    f := f*i;
  <font color="blue">end for</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>factorial;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE powerSeries<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.powerSeries"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.powerSeries</H2>
<B>Power series used to compute far-field temperature</B><p></P>
<P></P><H3>Information</H3>

          <p>
This function computes the power series that is used to compute the far-field 
temperature.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>u</TD><TD>&nbsp;</TD><TD>u</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of coefficients</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>W</TD><TD>Power series</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> powerSeries <font color="darkgreen">
  &quot;Power series used to compute far-field temperature&quot;</font>
  <font color="blue">input </font>Real u <font color="darkgreen">&quot;u&quot;</font>;
  <font color="blue">input </font>Integer N <font color="darkgreen">&quot;Number of coefficients&quot;</font>;
  <font color="blue">output </font>Real W <font color="darkgreen">&quot;Power series&quot;</font>;
<font color="blue">algorithm </font>
  W := -0.5772 -<font color="red"> Modelica.Math.log</font>(u) +<font color="red"> sum</font>((-1)^(j + 1)*u^j/(j*<font color="red">factorial</font>(j))
    <font color="blue">for </font>j<font color="blue"> in </font>1:N);
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>powerSeries;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE temperatureDrop<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.temperatureDrop"></A><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses"
>Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses</A>.temperatureDrop</H2>
<B>Calculate the temperature drop of the soil at the external boundary of the cylinder</B><p></P>
<P></P><H3>Information</H3>

<p>
This function calculates the temperature drop of the soil at the outer boundary of the cylinder.
The analytical formula of Hart and Couvillion (1986) for constant 
heat extraction is adapted to a non-constant heat flux. 
To adapt the formula for a variable rate of heat extraction,
different constant heat extraction rates, starting at different time instances, 
are super-imposed.
To obtain the temperature drop at the time <i>t=n*&Delta;t</i>, the effects of 
constant rate of heat extractions are super-imposed as
</p>
<p align="center" style="font-style:italic;">
&Delta;T ( r , t=n &Delta;t )= 1 &frasl; ( 4 &pi; k ) 
  &sum;  W(u(r, t= i &Delta;t)) (q<sub>n-i+1</sub>-q<sub>n-i</sub>),
</p>
<p>
where <i>r</i> is the radius for which the temperature is computed,
<i>k</i> is the thermal conductivity of the material,
<i>W</i> is a solution of the heat conduction in polar coordinates and
<i>q<sub>i</sub>=Q<sub>i</sub>/h</i> is
the specific rate of heat extraction per unit lenght at time 
<i>t=i &Delta;t</i>.
The value of 
<i>W</i> is obtained using
</p>
<p align="center" style="font-style:italic;">
W(u)=[-0.5772 - ln(u) + u - u<sup>2</sup>/(2 &nbsp; 2!) +u<sup>3</sup>/(3 &nbsp; 3!) - u<sup>4</sup>/(4 &nbsp; 4!) + ....].
</p>
<p>
where
<i>u(r,t)= c &rho; r<sup>2</sup> &frasl; (4 t k) </i>,
<i>&rho;</i> is the mass density and
<i>c</i> is the specific heat capacity per unit mass.
</p>
<h4>Implementation</h4>
<p>
The rate of heat flow <i>Q<sub>i</sub></i> is obtained from the function
<A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues"
>
Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues</a>.
</p>
<h4>References</h4>
<p>
Hart and Couvillion, (1986). <i>Earth Coupled Heat Transfer.</i>
Publication of the National Water Well Association. 
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A></TD><TD>table</TD><TD>&nbsp;</TD><TD>External object that contains the history terms of the heat flux</TD></TR>
<TR><TD>Integer</TD><TD>iSam</TD><TD>&nbsp;</TD><TD>Counter for how many time the model was sampled. Defined as iSam=1 when called at t=0</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</A></TD><TD>Q_flow</TD><TD>&nbsp;</TD><TD>Heat flow rate to be stored in the external object [W]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>samplePeriod</TD><TD>&nbsp;</TD><TD>Period between two samples [s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>rExt</TD><TD>&nbsp;</TD><TD>External radius of the cylinder [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>hSeg</TD><TD>&nbsp;</TD><TD>Height of the cylinder [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>k</TD><TD>&nbsp;</TD><TD>Thermal conductivity of the soil [W/(m.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>d</TD><TD>&nbsp;</TD><TD>Density of the soil [kg/m3]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A></TD><TD>c</TD><TD>&nbsp;</TD><TD>Specific heat capacity of the soil [J/(kg.K)]</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>TemperatureDifference</A></TD><TD>dT</TD><TD>Temperature drop of the soil [K]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> temperatureDrop <font color="darkgreen">
  &quot;Calculate the temperature drop of the soil at the external boundary of the cylinder&quot;</font>
<font color="blue">input </font><A HREF="Buildings_Fluid_HeatExchangers_Boreholes_BaseClasses.html#Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.ExtendableArray"
>ExtendableArray</A> table <font color="darkgreen">
    &quot;External object that contains the history terms of the heat flux&quot;</font>;
<font color="blue">input </font>Integer iSam(min=1) <font color="darkgreen">
    &quot;Counter for how many time the model was sampled. Defined as iSam=1 when called at t=0&quot;</font>;

<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> Q_flow <font color="darkgreen">
    &quot;Heat flow rate to be stored in the external object&quot;</font>;
<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</A> samplePeriod <font color="darkgreen">&quot;Period between two samples&quot;</font>;
<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rExt <font color="darkgreen">&quot;External radius of the cylinder&quot;</font>;
<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> hSeg <font color="darkgreen">&quot;Height of the cylinder&quot;</font>;
<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> k <font color="darkgreen">&quot;Thermal conductivity of the soil&quot;</font>;
<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> d <font color="darkgreen">&quot;Density of the soil&quot;</font>;
<font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</A> c <font color="darkgreen">
    &quot;Specific heat capacity of the soil&quot;</font>;
<font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">&quot;Temperature drop of the soil&quot;</font>;
<font color="blue">protected </font>
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</A> minSamplePeriod= rExt^2/(4*(k/c/d)*3.8) <font color="darkgreen">
    &quot;Minimal lenght of the sampling period&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> QL_flow <font color="darkgreen">
    &quot;Intermediate variable for heat flow rate at the lower bound of the time interval&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> QU_flow <font color="darkgreen">
    &quot;Intermediate variable for heat flow rate at the upper bound of the time interval&quot;</font>;

<font color="blue">algorithm </font>
  <font color="red">assert</font>(rExt*rExt/(4*(k/c/d)*samplePeriod)&lt;=3.8,
  &quot;The samplePeriod has to be bigger than &quot; +<font color="red"> String</font>(minSamplePeriod) + &quot; for convergence purpose.
  samplePeriod = &quot;+<font color="red"> String</font>(samplePeriod));
  <font color="blue">if </font>iSam == 1<font color="blue"> then</font>
    <font color="darkgreen">// First call, at t=0</font>
    dT := 0;
    QL_flow :=<font color="red"> Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues</font>(
                       table=table, iX=iSam, x=Q_flow, iY=iSam);
  <font color="blue">else</font>
    dT := 0;
    <font color="darkgreen">// The first evaluation is at iSam=2, in which case we have one term of the sum,</font>
    <font color="darkgreen">// and t=samplePeriod=(iSam-1)*samplePeriod</font>
   <font color="blue">for </font>i<font color="blue"> in </font>1:(iSam-1)<font color="blue"> loop</font>
      QL_flow :=<font color="red"> Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues</font>(
        table=table, iX=iSam, x=Q_flow, iY=iSam+1-i);
      QU_flow :=<font color="red"> Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.exchangeValues</font>(
        table=table, iX=iSam, x=Q_flow, iY=iSam-i);
      <font color="darkgreen">// The division by hSeg is because QU_flow and QL_flow are in [W], but the equation</font>
      <font color="darkgreen">// requires [W/m], i.e., heat flow rate per unit length of the line source.</font>
      dT := dT + 1/(4*Modelica.Constants.pi*k)*
        <font color="red">Buildings.Fluid.HeatExchangers.Boreholes.BaseClasses.powerSeries</font>(
           u=c*d/(4*k*i*samplePeriod)*rExt^2, N=10)*
        (QL_flow-QU_flow)/hSeg;
 <font color="blue">end for</font>;
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>temperatureDrop;
</PRE>
<HR>
<address><a href="http://www.3ds.com/">Automatically generated</a> Thu Oct 24 15:08:34 2013.
</address></BODY>
</HTML>
