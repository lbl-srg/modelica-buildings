<HTML>
<HEAD>
<TITLE>Buildings.Airflow.Multizone.BaseClasses</TITLE>
<META name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META name="description" content="&quot;Package with base classes for Buildings.Airflow.Multizone&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- --- header ------ -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- --- end header -- -->
</P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Airflow.Multizone.BaseClasses"></A><A HREF="Buildings_Airflow_Multizone.html#Buildings.Airflow.Multizone"
>Buildings.Airflow.Multizone</A>.BaseClasses</H2>
<B>Package with base classes for Buildings.Airflow.Multizone</B>
<P></P>
<P></P><H3>Information</H3>

<p>
This package contains base classes that are used to construct the models in
<A HREF="Buildings_Airflow_Multizone.html#Buildings.Airflow.Multizone"
>Buildings.Airflow.Multizone</a>.
</p>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</A> (Icon for packages containing base classes).
<P></P><H3>Package Content</H3>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizoda3011a77fd2d484tizedS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.DoorDiscretized" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.DoorDiscretized"
>DoorDiscretized</A>
</TD><TD>Door model using discretization along height coordinate</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo597abee92285ce4etanceS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.PowerLawResistance" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.PowerLawResistance"
>PowerLawResistance</A>
</TD><TD>Flow resistance that uses the power law</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement"
>TwoWayFlowElement</A>
</TD><TD>Flow resistance that uses the power law</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy"
>TwoWayFlowElementBuoyancy</A>
</TD><TD>Flow resistance that uses the power law</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo2c973effaec92287lFlowS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.ZonalFlow" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ZonalFlow"
>ZonalFlow</A>
</TD><TD>Flow across zonal boundaries of a room</TD></TR>
<TR><TD><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>ErrorControl</A>
</TD><TD>Interface that defines parameters for error control</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo52205058b73861fferLawS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.powerLaw" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.powerLaw"
>powerLaw</A>
</TD><TD>Power law used in orifice equations</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo52205058b73861fferLawS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.powerLawFixedM" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.powerLawFixedM"
>powerLawFixedM</A>
</TD><TD>Power law used in orifice equations when m is constant</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo52205058b73861fferLawS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.windPressureLowRise" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.windPressureLowRise"
>windPressureLowRise</A>
</TD><TD>Wind pressure coefficient for low-rise buildings</TD></TR>
<TR><TD><IMG SRC="Buildings.Airflow.Multizo8d2387b85bb9e0d6mplesS.png" ALT="Buildings.Airflow.Multizone.BaseClasses.Examples" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_Airflow_Multizone_BaseClasses_Examples.html#Buildings.Airflow.Multizone.BaseClasses.Examples"
>Examples</A>
</TD><TD>Collection of models that illustrate model use and test models</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE DoorDiscretized<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Airflow.Multizoda3011a77fd2d484tizedI.png" ALT="Buildings.Airflow.Multizone.BaseClasses.DoorDiscretized" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Airflow.Multizone.BaseClasses.DoorDiscretized"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.DoorDiscretized</H2>
<B>Door model using discretization along height coordinate</B><p></P>
<IMG SRC="Buildings.Airflow.Multizoda3011a77fd2d484tizedD.png" ALT="Buildings.Airflow.Multizone.BaseClasses.DoorDiscretized">
<P></P><H3>Information</H3>

<p>
This is a partial model for the bi-directional air flow through a door.
</p>
<p>
To compute the bi-directional flow, 
the door is discretize along the height coordinate, and uses
an orifice equation to compute the flow for each compartment.
</p>
<p>
The compartment area <code>dA</code> is a variable, which allows
using the model for a door that can be open or closed.
</p>
<P></P>
Extends from <A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy"
>Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy</A> (Flow resistance that uses the power law).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>forceErrorControlOnFlow</TD><TD>true</TD><TD>Flag to force error control on m_flow. Set to true if interested in flow rate</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A></TD><TD>vZer</TD><TD>0.001</TD><TD>Minimum velocity to prevent zero flow. Recommended: 0.001 [m/s]</TD></TR>
<TR><TD>Integer</TD><TD>nCom</TD><TD>10</TD><TD>Number of compartments for the discretization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_turbulent</TD><TD>0.01</TD><TD>Pressure difference where laminar and turbulent flow relation coincide. Recommended: 0.01 [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1.start</TD><TD>0</TD><TD>Pressure difference between port_a1 and port_b1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2.start</TD><TD>0</TD><TD>Pressure difference between port_a2 and port_b2 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a1_inflow.start</TD><TD>1.2</TD><TD>Density of air flowing in from port_a1 [kg/m3]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a2_inflow.start</TD><TD>1.2</TD><TD>Density of air flowing in from port_a2 [kg/m3]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wOpe</TD><TD>0.9</TD><TD>Width of opening [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hOpe</TD><TD>2.1</TD><TD>Height of opening [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hA</TD><TD>2.7/2</TD><TD>Height of reference pressure zone A [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hB</TD><TD>2.7/2</TD><TD>Height of reference pressure zone B [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Orifice characteristics</TD></TR>
<TR><TD>Real</TD><TD>CD</TD><TD>0.65</TD><TD>Discharge coefficient</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port a1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port b1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port a2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port b2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_small</TD><TD>1E-4*abs(m1_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_small</TD><TD>1E-4*abs(m2_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a1</TD><TD>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b1</TD><TD>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a2</TD><TD>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b2</TD><TD>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> DoorDiscretized <font color="darkgreen">
  &quot;Door model using discretization along height coordinate&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy"
>Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy</A>;

  <font color="blue">parameter </font>Integer nCom=10 <font color="darkgreen">&quot;Number of compartments for the discretization&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dp_turbulent(min=0) = 0.01 <font color="darkgreen">
    &quot;Pressure difference where laminar and turbulent flow relation coincide. Recommended: 0.01&quot;</font>;
  <font color="blue">parameter </font>Real CD=0.65 <font color="darkgreen">&quot;|Orifice characteristics|Discharge coefficient&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dpAB[nCom](<font color="blue">each </font>nominal=1) <font color="darkgreen">
    &quot;Pressure difference between compartments&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> v[nCom](<font color="blue">each </font>nominal=0.01) <font color="darkgreen">
    &quot;Velocity in compartment from A to B&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> vTop <font color="darkgreen">&quot;Velocity at top of opening from A to B&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> vBot <font color="darkgreen">&quot;Velocity at bottom of opening from A to B&quot;</font>;

<font color="blue">protected </font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> dh=hOpe/nCom <font color="darkgreen">&quot;Height of each compartment&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.AbsolutePressure"
>Modelica.SIunits.AbsolutePressure</A> pA[nCom](<font color="blue">each </font>nominal=101325) <font color="darkgreen">
    &quot;Pressure in compartments of room A&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.AbsolutePressure"
>Modelica.SIunits.AbsolutePressure</A> pB[nCom](<font color="blue">each </font>nominal=101325) <font color="darkgreen">
    &quot;Pressure in compartments of room B&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> dV_flow[nCom] <font color="darkgreen">
    &quot;Volume flow rate through compartment from A to B&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> dVAB_flow[nCom] <font color="darkgreen">
    &quot;Volume flow rate through compartment from A to B if positive&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> dVBA_flow[nCom] <font color="darkgreen">
    &quot;Volume flow rate through compartment from B to A if positive&quot;</font>;

  Real m(min=0.5, max=1) <font color="darkgreen">&quot;Flow exponent, m=0.5 for turbulent, m=1 for laminar&quot;</font>;
  Real kVal <font color="darkgreen">&quot;Flow coefficient for each compartment, k = V_flow/ dp^m&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> dA <font color="darkgreen">&quot;Compartment area&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</A> sta_default=<font color="red">Medium.setState_pTX</font>(
      T=Medium.T_default,
      p=Medium.p_default,
      X=Medium.X_default);
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> rho_default=<font color="red">Medium.density</font>(sta_default) <font color="darkgreen">
    &quot;Density, used to compute fluid volume&quot;</font>;

<font color="blue">equation </font>
  dA = A/nCom;

  <font color="blue">for </font>i<font color="blue"> in </font>1:nCom<font color="blue"> loop</font>
    <font color="darkgreen">// pressure drop in each compartment</font>
    pA[i] = port_a1.p + rho_a1_inflow*Modelica.Constants.g_n*(hA - (i - 0.5)*dh);
    pB[i] = port_a2.p + rho_a2_inflow*Modelica.Constants.g_n*(hB - (i - 0.5)*dh);
    dpAB[i] = pA[i] - pB[i];
    v[i] = dV_flow[i]/dA;
    <font color="darkgreen">// assignment of net volume flows</font>
    dVAB_flow[i] = dV_flow[i]*
      <font color="red">Buildings.Utilities.Math.Functions.smoothHeaviside</font>(x=dV_flow[i], delta=
      VZer_flow/nCom) + VZer_flow/nCom;
    dVBA_flow[i] = -dV_flow[i] + dVAB_flow[i] + 2*VZer_flow/nCom;
  <font color="blue">end for</font>;
  <font color="darkgreen">// add positive and negative flows</font>
  VAB_flow =<font color="red"> ones</font>(nCom)*dVAB_flow;
  VBA_flow =<font color="red"> ones</font>(nCom)*dVBA_flow;
  vTop = v[nCom];
  vBot = v[1];
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>DoorDiscretized;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PowerLawResistance<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Airflow.Multizo597abee92285ce4etanceI.png" ALT="Buildings.Airflow.Multizone.BaseClasses.PowerLawResistance" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Airflow.Multizone.BaseClasses.PowerLawResistance"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.PowerLawResistance</H2>
<B>Flow resistance that uses the power law</B><p></P>
<IMG SRC="Buildings.Airflow.Multizo597abee92285ce4etanceD.png" ALT="Buildings.Airflow.Multizone.BaseClasses.PowerLawResistance">
<P></P><H3>Information</H3>

<p>
This model describes the mass flow rate and pressure difference relation
of an orifice in the form
<PRE>
    V_flow = k * dp^m,
</PRE>
where <code>k</code> is a variable and
<code>m</code> a parameter.
For turbulent flow, set <code>m=1/2</code> and
for laminar flow, set <code>m=1</code>. 
<P>
The model is used as a base for the interzonal air flow models.
<P></P>
Extends from <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</A> (Partial model transporting fluid between two ports without storing mass or energy), <A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>Buildings.Airflow.Multizone.BaseClasses.ErrorControl</A> (Interface that defines parameters for error control).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD>Boolean</TD><TD>forceErrorControlOnFlow</TD><TD>true</TD><TD>Flag to force error control on m_flow. Set to true if interested in flow rate</TD></TR>
<TR><TD>Real</TD><TD>m</TD><TD>&nbsp;</TD><TD>Flow exponent, m=0.5 for turbulent, m=1 for laminar</TD></TR>
<TR><TD>Boolean</TD><TD>useDefaultProperties</TD><TD>true</TD><TD>Set to false to use density and viscosity based on actual medium state, rather than using default values</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_turbulent</TD><TD>0.1</TD><TD>Pressure difference where laminar and turbulent flow relation coincide. Recommended = 0.1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>lWet</TD><TD>sqrt(A)</TD><TD>Wetted perimeter used for Reynolds number calculation [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>rho_default*k*dp_turbulent</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp.start</TD><TD>0</TD><TD>Pressure difference between port_a and port_b [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Orifice characteristics</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Area of orifice [m2]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>1E-4*abs(m_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> PowerLawResistance <font color="darkgreen">
  &quot;Flow resistance that uses the power law&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</A>(
    <font color="blue">final </font>m_flow_nominal=rho_default*k*dp_turbulent,
    <font color="blue">final </font>showDesignFlowDirection=false);
  <font color="blue">extends </font><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>Buildings.Airflow.Multizone.BaseClasses.ErrorControl</A>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;|Orifice characteristics|Area of orifice&quot;</font>;

  <font color="blue">parameter </font>Real m(min=0.5, max=1) <font color="darkgreen">
    &quot;Flow exponent, m=0.5 for turbulent, m=1 for laminar&quot;</font>;
  <font color="blue">parameter </font>Boolean useDefaultProperties=true <font color="darkgreen">
    &quot;Set to false to use density and viscosity based on actual medium state, rather than using default values&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dp_turbulent(min=0, displayUnit=&quot;Pa&quot;) = 0.1 <font color="darkgreen">
    &quot;Pressure difference where laminar and turbulent flow relation coincide. Recommended = 0.1&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> lWet=<font color="red">sqrt</font>(A) <font color="darkgreen">
    &quot;Wetted perimeter used for Reynolds number calculation&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> V_flow <font color="darkgreen">
    &quot;Volume flow rate through the component&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> v(nominal=1) <font color="darkgreen">&quot;Average velocity&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> rho <font color="darkgreen">&quot;Fluid density at port_a&quot;</font>;
  Real Re <font color="darkgreen">&quot;Reynolds number&quot;</font>;

<font color="blue">protected </font>
  <font color="blue">constant </font>Real gamma(min=1) = 1.5 <font color="darkgreen">
    &quot;Normalized flow rate where dphi(0)/dpi intersects phi(1)&quot;</font>;

  <font color="blue">parameter </font>Real k <font color="darkgreen">&quot;Flow coefficient, k = V_flow/ dp^m&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</A> sta_default=<font color="red">Medium.setState_pTX</font>(
      T=Medium.T_default,
      p=Medium.p_default,
      X=Medium.X_default) <font color="darkgreen">
    &quot;State of the medium at the medium default properties&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> rho_default=<font color="red">Medium.density</font>(sta_default) <font color="darkgreen">
    &quot;Density at the medium default properties&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>Modelica.SIunits.DynamicViscosity</A> dynVis_default=
    <font color="red">Medium.dynamicViscosity</font>(sta_default) <font color="darkgreen">
    &quot;Dynamic viscosity at the medium default properties&quot;</font>;

  <font color="blue">parameter </font>Real a = gamma <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  <font color="blue">parameter </font>Real b = 1/8*m^2 - 3*gamma - 3/2*m + 35.0/8 <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  <font color="blue">parameter </font>Real c = -1/4*m^2 + 3*gamma + 5/2*m - 21.0/4 <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  <font color="blue">parameter </font>Real d = 1/8*m^2 - gamma - m + 15.0/8 <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</A> sta <font color="darkgreen">&quot;State of the medium in the component&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>Modelica.SIunits.DynamicViscosity</A> dynVis <font color="darkgreen">&quot;Dynamic viscosity&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</A> mExc <font color="darkgreen">
    &quot;Air mass exchanged (for purpose of error control only)&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  mExc=0;
<font color="blue">equation </font>
  <font color="blue">if </font>forceErrorControlOnFlow<font color="blue"> then</font>
    <font color="red">der</font>(mExc) = port_a.m_flow;
  <font color="blue">else</font>
    <font color="red">der</font>(mExc) = 0;
  <font color="blue">end if</font>;

  <font color="blue">if </font>useDefaultProperties<font color="blue"> then</font>
    sta    = sta_default;
    rho    = rho_default;
    dynVis = dynVis_default;
  <font color="blue">else</font>
    sta    = <font color="blue">if </font>homotopyInitialization<font color="blue"> then </font>
                <font color="red">Medium.setState_phX</font>(port_a.p,
                          <font color="red">homotopy</font>(actual=<font color="red">actualStream</font>(port_a.h_outflow),
                                   simplified=<font color="red">inStream</font>(port_a.h_outflow)),
                          <font color="red">homotopy</font>(actual=<font color="red">actualStream</font>(port_a.Xi_outflow),
                                   simplified=<font color="red">inStream</font>(port_a.Xi_outflow)))<font color="blue">
             else </font>
               <font color="red">Medium.setState_phX</font>(port_a.p,
                          <font color="red">actualStream</font>(port_a.h_outflow),
                          <font color="red">actualStream</font>(port_a.Xi_outflow));

    rho    =<font color="red"> Medium.density</font>(sta);
    dynVis =<font color="red"> Medium.dynamicViscosity</font>(sta);
  <font color="blue">end if</font>;

  V_flow =<font color="red"> Buildings.Airflow.Multizone.BaseClasses.powerLawFixedM</font>(
    k=k,
    dp=dp,
    m=m,
    a=a,
    b=b,
    c=c,
    d=d,
    dp_turbulent=dp_turbulent);

  port_a.m_flow = rho*V_flow;
  v = V_flow/A;
  Re = v*lWet*rho/dynVis;

  <font color="darkgreen">// Isenthalpic state transformation (no storage and no loss of energy)</font>
  port_a.h_outflow =<font color="red"> inStream</font>(port_b.h_outflow);
  port_b.h_outflow =<font color="red"> inStream</font>(port_a.h_outflow);

  <font color="darkgreen">// Mass balance (no storage)</font>
  port_a.m_flow + port_b.m_flow = 0;

  <font color="darkgreen">// Transport of substances</font>
  port_a.Xi_outflow =<font color="red"> inStream</font>(port_b.Xi_outflow);
  port_b.Xi_outflow =<font color="red"> inStream</font>(port_a.Xi_outflow);

  port_a.C_outflow =<font color="red"> inStream</font>(port_b.C_outflow);
  port_b.C_outflow =<font color="red"> inStream</font>(port_a.C_outflow);
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>PowerLawResistance;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TwoWayFlowElement<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementI.png" ALT="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.TwoWayFlowElement</H2>
<B>Flow resistance that uses the power law</B><p></P>
<IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementD.png" ALT="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement">
<P></P><H3>Information</H3>

<p>
This is a partial model for models that describe the bi-directional
air flow through large openings.
<P>
Models that extend this model need to compute 
<code>mAB_flow</code> and <code>mBA_flow</code>,
or alternatively <code>VAB_flow</code> and <code>VBA_flow</code>,
and the face area <code>area</code>.
The face area is a variable to allow this partial model to be used
for doors that can be open or closed as a function of an input signal.
<P></P>
Extends from <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</A> (Partial model transporting fluid between two ports without storing mass or energy), <A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>Buildings.Airflow.Multizone.BaseClasses.ErrorControl</A> (Interface that defines parameters for error control).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 2 in the component</TD></TR>
<TR><TD>Boolean</TD><TD>forceErrorControlOnFlow</TD><TD>true</TD><TD>Flag to force error control on m_flow. Set to true if interested in flow rate</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Modelica.Media.Interfaces.Pa...</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A></TD><TD>vZer</TD><TD>0.001</TD><TD>Minimum velocity to prevent zero flow. Recommended: 0.001 [m/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_nominal</TD><TD>10/3600*1.2</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_nominal</TD><TD>m1_flow_nominal</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1.start</TD><TD>0</TD><TD>Pressure difference between port_a1 and port_b1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2.start</TD><TD>0</TD><TD>Pressure difference between port_a2 and port_b2 [Pa]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal1</TD><TD>false</TD><TD>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal2</TD><TD>false</TD><TD>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port a1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port b1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port a2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port b2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_small</TD><TD>1E-4*abs(m1_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_small</TD><TD>1E-4*abs(m2_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD>Medium 2 in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a1</TD><TD>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b1</TD><TD>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a2</TD><TD>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b2</TD><TD>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> TwoWayFlowElement <font color="darkgreen">
  &quot;Flow resistance that uses the power law&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</A>(
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium1 = <A HREF="Buildings_Airflow_Multizone_BaseClasses_Medium.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement.Medium"
>Medium</A>,
    <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium2 = <A HREF="Buildings_Airflow_Multizone_BaseClasses_Medium.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement.Medium"
>Medium</A>,
    <font color="blue">final </font>allowFlowReversal1=false,
    <font color="blue">final </font>allowFlowReversal2=false,
    <font color="blue">final </font>m1_flow_nominal=10/3600*1.2,
    <font color="blue">final </font>m2_flow_nominal=m1_flow_nominal);
  <font color="blue">extends </font><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>Buildings.Airflow.Multizone.BaseClasses.ErrorControl</A>;

  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> VAB_flow(nominal=0.001) <font color="darkgreen">
    &quot;Volume flow rate from A to B if positive&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> VBA_flow(nominal=0.001) <font color="darkgreen">
    &quot;Volume flow rate from B to A if positive&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> mAB_flow(nominal=0.001) <font color="darkgreen">
    &quot;Mass flow rate from A to B if positive&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> mBA_flow(nominal=0.001) <font color="darkgreen">
    &quot;Mass flow rate from B to A if positive&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> vAB(nominal=0.01) <font color="darkgreen">&quot;Average velocity from A to B&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> vBA(nominal=0.01) <font color="darkgreen">&quot;Average velocity from B to A&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> rho_a1_inflow(start=1.2) <font color="darkgreen">
    &quot;Density of air flowing in from port_a1&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> rho_a2_inflow(start=1.2) <font color="darkgreen">
    &quot;Density of air flowing in from port_a2&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Face area&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</A> vZer=0.001 <font color="darkgreen">
    &quot;Minimum velocity to prevent zero flow. Recommended: 0.001&quot;</font>;
<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> VZer_flow(fixed=false) <font color="darkgreen">
    &quot;Minimum net volume flow rate to prevent zero flow&quot;</font>;
<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</A> mExcAB(start=0) <font color="darkgreen">
    &quot;Air mass exchanged (for purpose of error control only)&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</A> mExcBA(start=0) <font color="darkgreen">
    &quot;Air mass exchanged (for purpose of error control only)&quot;</font>;

<font color="blue">equation </font>
  <font color="darkgreen">// enforcing error control on both direction rather than on the sum only</font>
  <font color="darkgreen">// gives higher robustness. The reason may be that for bi-directional flow,</font>
  <font color="darkgreen">// (VAB_flow - VBA_flow) may be close to zero.</font>
  <font color="blue">if </font>forceErrorControlOnFlow<font color="blue"> then</font>
    <font color="red">der</font>(mExcAB) = mAB_flow;
    <font color="red">der</font>(mExcBA) = mBA_flow;
  <font color="blue">else</font>
    <font color="red">der</font>(mExcAB) = 0;
    <font color="red">der</font>(mExcBA) = 0;
  <font color="blue">end if</font>;
  rho_a1_inflow =<font color="red"> Medium.density</font>(state_a1_inflow);
  rho_a2_inflow =<font color="red"> Medium.density</font>(state_a2_inflow);
  VZer_flow = vZer*A;

  mAB_flow = rho_a1_inflow*VAB_flow;
  mBA_flow = rho_a2_inflow*VBA_flow;
  <font color="darkgreen">// Average velocity (using the whole orifice area)</font>
  vAB = VAB_flow/A;
  vBA = VBA_flow/A;

  port_a1.m_flow = mAB_flow;
  port_a2.m_flow = mBA_flow;

  <font color="darkgreen">// Energy balance (no storage, no heat loss/gain)</font>
  port_a1.h_outflow =<font color="red"> inStream</font>(port_b1.h_outflow);
  port_b1.h_outflow =<font color="red"> inStream</font>(port_a1.h_outflow);
  port_a2.h_outflow =<font color="red"> inStream</font>(port_b2.h_outflow);
  port_b2.h_outflow =<font color="red"> inStream</font>(port_a2.h_outflow);

  <font color="darkgreen">// Mass balance (no storage)</font>
  port_a1.m_flow = -port_b1.m_flow;
  port_a2.m_flow = -port_b2.m_flow;

  port_a1.Xi_outflow =<font color="red"> inStream</font>(port_b1.Xi_outflow);
  port_b1.Xi_outflow =<font color="red"> inStream</font>(port_a1.Xi_outflow);
  port_a2.Xi_outflow =<font color="red"> inStream</font>(port_b2.Xi_outflow);
  port_b2.Xi_outflow =<font color="red"> inStream</font>(port_a2.Xi_outflow);

  <font color="darkgreen">// Transport of trace substances</font>
  port_a1.C_outflow =<font color="red"> inStream</font>(port_b1.C_outflow);
  port_b1.C_outflow =<font color="red"> inStream</font>(port_a1.C_outflow);
  port_a2.C_outflow =<font color="red"> inStream</font>(port_b2.C_outflow);
  port_b2.C_outflow =<font color="red"> inStream</font>(port_a2.C_outflow);

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>TwoWayFlowElement;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TwoWayFlowElementBuoyancy<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementI.png" ALT="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.TwoWayFlowElementBuoyancy</H2>
<B>Flow resistance that uses the power law</B><p></P>
<IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementD.png" ALT="Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElementBuoyancy">
<P></P><H3>Information</H3>

<p>
This is a partial model for models that describe the bi-directional
air flow through large openings.
<P>
Models that extend this model need to compute 
<code>mAB_flow</code> and <code>mBA_flow</code>,
or alternatively <code>VAB_flow</code> and <code>VBA_flow</code>,
and the face area <code>area</code>.
The face area is a variable to allow this partial model to be used
for doors that can be open or closed as a function of an input signal.
<P></P>
Extends from <A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement"
>Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement</A> (Flow resistance that uses the power law).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>forceErrorControlOnFlow</TD><TD>true</TD><TD>Flag to force error control on m_flow. Set to true if interested in flow rate</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A></TD><TD>vZer</TD><TD>0.001</TD><TD>Minimum velocity to prevent zero flow. Recommended: 0.001 [m/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1.start</TD><TD>0</TD><TD>Pressure difference between port_a1 and port_b1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2.start</TD><TD>0</TD><TD>Pressure difference between port_a2 and port_b2 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a1_inflow.start</TD><TD>1.2</TD><TD>Density of air flowing in from port_a1 [kg/m3]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a2_inflow.start</TD><TD>1.2</TD><TD>Density of air flowing in from port_a2 [kg/m3]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wOpe</TD><TD>0.9</TD><TD>Width of opening [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hOpe</TD><TD>2.1</TD><TD>Height of opening [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hA</TD><TD>2.7/2</TD><TD>Height of reference pressure zone A [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hB</TD><TD>2.7/2</TD><TD>Height of reference pressure zone B [m]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port a1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port b1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port a2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port b2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_small</TD><TD>1E-4*abs(m1_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_small</TD><TD>1E-4*abs(m2_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a1</TD><TD>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b1</TD><TD>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a2</TD><TD>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b2</TD><TD>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> TwoWayFlowElementBuoyancy <font color="darkgreen">
  &quot;Flow resistance that uses the power law&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement"
>Buildings.Airflow.Multizone.BaseClasses.TwoWayFlowElement</A>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> wOpe=0.9 <font color="darkgreen">&quot;|Geometry|Width of opening&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> hOpe=2.1 <font color="darkgreen">&quot;|Geometry|Height of opening&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> hA=2.7/2 <font color="darkgreen">
    &quot;|Geometry|Height of reference pressure zone A&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> hB=2.7/2 <font color="darkgreen">
    &quot;|Geometry|Height of reference pressure zone B&quot;</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>TwoWayFlowElementBuoyancy;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ZonalFlow<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.Airflow.Multizo2c973effaec92287lFlowI.png" ALT="Buildings.Airflow.Multizone.BaseClasses.ZonalFlow" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.Airflow.Multizone.BaseClasses.ZonalFlow"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.ZonalFlow</H2>
<B>Flow across zonal boundaries of a room</B><p></P>
<IMG SRC="Buildings.Airflow.Multizo2f220ba89863259eementD.png" ALT="Buildings.Airflow.Multizone.BaseClasses.ZonalFlow">
<P></P><H3>Information</H3>

<p>
This is a partial model for computing the air exchange between volumes.
Models that extend this model need to provide an equation for
<code>port_a1.m_flow</code> and <code>port_a2.m_flow</code>.
</p>
<P></P>
Extends from <A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</A> (Partial model transporting fluid between two ports without storing mass or energy), <A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>Buildings.Airflow.Multizone.BaseClasses.ErrorControl</A> (Interface that defines parameters for error control).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium 2 in the component</TD></TR>
<TR><TD>Boolean</TD><TD>forceErrorControlOnFlow</TD><TD>true</TD><TD>Flag to force error control on m_flow. Set to true if interested in flow rate</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Modelica.Media.Interfaces.Pa...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal condition</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_nominal</TD><TD>10/3600*1.2</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_nominal</TD><TD>m1_flow_nominal</TD><TD>Nominal mass flow rate [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp1.start</TD><TD>0</TD><TD>Pressure difference between port_a1 and port_b1 [Pa]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow.start</TD><TD>0</TD><TD>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp2.start</TD><TD>0</TD><TD>Pressure difference between port_a2 and port_b2 [Pa]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal1</TD><TD>false</TD><TD>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal2</TD><TD>false</TD><TD>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port a1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b1_start</TD><TD>Medium1.h_default</TD><TD>Start value for enthalpy flowing out of port b1 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_a2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port a2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h_outflow_b2_start</TD><TD>Medium2.h_default</TD><TD>Start value for enthalpy flowing out of port b2 [J/kg]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m1_flow_small</TD><TD>1E-4*abs(m1_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m2_flow_small</TD><TD>1E-4*abs(m2_flow_nominal)</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>false</TD><TD>= true, if actual temperature at port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium1</TD><TD>Medium 1 in the component</TD></TR>
<TR><TD colspan="2">replaceable package Medium2</TD><TD>Medium 2 in the component</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a1</TD><TD>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b1</TD><TD>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a2</TD><TD>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b2</TD><TD>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</TD></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> ZonalFlow <font color="darkgreen">&quot;Flow across zonal boundaries of a room&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</A>(
     <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium1 = <A HREF="Buildings_Airflow_Multizone_BaseClasses_Medium.html#Buildings.Airflow.Multizone.BaseClasses.ZonalFlow.Medium"
>Medium</A>,
     <font color="blue">redeclare </font><font color="blue">final </font><font color="blue">package</font> Medium2 = <A HREF="Buildings_Airflow_Multizone_BaseClasses_Medium.html#Buildings.Airflow.Multizone.BaseClasses.ZonalFlow.Medium"
>Medium</A>,
     <font color="blue">final </font>allowFlowReversal1 = false,
     <font color="blue">final </font>allowFlowReversal2 = false,
     <font color="blue">final </font>m1_flow_nominal = 10/3600*1.2,
     <font color="blue">final </font>m2_flow_nominal = m1_flow_nominal);
  <font color="blue">extends </font><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.ErrorControl"
>Buildings.Airflow.Multizone.BaseClasses.ErrorControl</A>;

   <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="../../msl/3.2/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;

<font color="blue">equation </font>
  <font color="darkgreen">// Energy balance (no storage, no heat loss/gain)</font>
  port_a1.h_outflow =<font color="red"> inStream</font>(port_b1.h_outflow);
  port_b1.h_outflow =<font color="red"> inStream</font>(port_a1.h_outflow);
  port_a2.h_outflow =<font color="red"> inStream</font>(port_b2.h_outflow);
  port_b2.h_outflow =<font color="red"> inStream</font>(port_a2.h_outflow);

  <font color="darkgreen">// Mass balance (no storage)</font>
  port_a1.m_flow = -port_b1.m_flow;
  port_a2.m_flow = -port_b2.m_flow;

  port_a1.Xi_outflow =<font color="red"> inStream</font>(port_b1.Xi_outflow);
  port_b1.Xi_outflow =<font color="red"> inStream</font>(port_a1.Xi_outflow);
  port_a2.Xi_outflow =<font color="red"> inStream</font>(port_b2.Xi_outflow);
  port_b2.Xi_outflow =<font color="red"> inStream</font>(port_a2.Xi_outflow);

  <font color="darkgreen">// Transport of trace substances</font>
  port_a1.C_outflow =<font color="red"> inStream</font>(port_b1.C_outflow);
  port_b1.C_outflow =<font color="red"> inStream</font>(port_a1.C_outflow);
  port_a2.C_outflow =<font color="red"> inStream</font>(port_b2.C_outflow);
  port_b2.C_outflow =<font color="red"> inStream</font>(port_a2.C_outflow);

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ZonalFlow;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ErrorControl<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Airflow.Multizone.BaseClasses.ErrorControl"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.ErrorControl</H2>
<B>Interface that defines parameters for error control</B><p></P>
<P></P><H3>Information</H3>

<p>
This is an interface that defines parameters used for error control.
<p>
Dymola does error control on state variables, such as temperature, pressure and 
species concentration.
Flow variables such as <code>m_flow</code> are typically not checked during the error control. 
This can give large errors in flow variables, as long as the error on the volume's state variables
that are coupled to the flow variables is small. 
Obtaining accurate flow variables can be achieved by imposing an error control
on the exchanged mass, which can be defined as 
<pre>
  dm/dt = m_flow.
</pre>
By setting <code>enforceErrorControlOnFlow = true</code>, such an equation is imposed
by models that extend this class.
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>forceErrorControlOnFlow</TD><TD>true</TD><TD>Flag to force error control on m_flow. Set to true if interested in flow rate</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ErrorControl <font color="darkgreen">
  &quot;Interface that defines parameters for error control&quot;</font>
  <font color="blue">parameter </font>Boolean forceErrorControlOnFlow = true <font color="darkgreen">
    &quot;Flag to force error control on m_flow. Set to true if interested in flow rate&quot;</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ErrorControl;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE powerLaw<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Airflow.Multizone.BaseClasses.powerLaw"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.powerLaw</H2>
<B>Power law used in orifice equations</B><p></P>
<P></P><H3>Information</H3>

<p>
This model describes the mass flow rate and pressure difference relation
of an orifice in the form
</p>
<p align="center" style="font-style:italic;">
  V = k sign(&Delta;p) |&Delta;p|<sup>m</sup>
</p>
<p>
where 
<i>V</i> is the volume flow rate,
<i>k &gt; 0</i> is a flow coefficient
<i>&Delta; p</i> is the pressure drop and
<i>m &isin; [0.5, 1]</i> is a flow coefficient.
The equation is regularized for 
<i>|&Delta;p| &lt; &Delta;p<sub>t</sub></i>, where
<i>&Delta;p<sub>t</sub></i> is a parameter.
For turbulent flow, set <i>m=1 &frasl; 2</i> and
for laminar flow, set <i>m=1</i>. 
</p>
<p>
The model is used for the interzonal air flow models.
</p>
<h4>Implementation</h4>
<p>
For <i>|&Delta;p| &lt; &Delta;p<sub>t</sub></i>, the equation is regularized
so that it is twice continuously differentiable in <i>&Delta;p</i>, and that it
has an infinite number of continuous derivatives in <i>m</i> and in <i>k</i>.
</p>
<p>
If <i>m</i> is not a function of time, then 
<i>a</i>, <i>b</i>, <i>c</i> and <i>d</i> can be pre-computed.
In this situation, use
<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.powerLawFixedM"
>
Buildings.Airflow.Multizone.BaseClasses.powerLawFixedM</a>, which allows
to compute these values outside of this function, for example as parameters
of a model.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>k</TD><TD>&nbsp;</TD><TD>Flow coefficient, k = V_flow/ dp^m</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp</TD><TD>&nbsp;</TD><TD>Pressure difference [Pa]</TD></TR>
<TR><TD>Real</TD><TD>m</TD><TD>&nbsp;</TD><TD>Flow exponent, m=0.5 for turbulent, m=1 for laminar</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_turbulent</TD><TD>0.001</TD><TD>Pressure difference where regularization starts [Pa]</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A></TD><TD>V_flow</TD><TD>Volume flow rate [m3/s]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> powerLaw <font color="darkgreen">&quot;Power law used in orifice equations&quot;</font>
  <font color="blue">input </font>Real k <font color="darkgreen">&quot;Flow coefficient, k = V_flow/ dp^m&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dp <font color="darkgreen">&quot;Pressure difference&quot;</font>;
  <font color="blue">input </font>Real m(min=0.5, max=1) <font color="darkgreen">
    &quot;Flow exponent, m=0.5 for turbulent, m=1 for laminar&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dp_turbulent(min=0)=0.001 <font color="darkgreen">
    &quot;Pressure difference where regularization starts&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> V_flow <font color="darkgreen">&quot;Volume flow rate&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">constant </font>Real gamma(min=1) = 1.5 <font color="darkgreen">
    &quot;Normalized flow rate where dphi(0)/dpi intersects phi(1)&quot;</font>;
  Real a <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  Real b <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  Real c <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  Real d <font color="darkgreen">
    &quot;Polynomial coefficient for regularized implementation of flow resistance&quot;</font>;
  Real pi <font color="darkgreen">&quot;Normalized pressure&quot;</font>;
  Real pi2 <font color="darkgreen">&quot;Square of normalized pressure&quot;</font>;
<font color="blue">algorithm </font>
 <font color="blue">if </font>(dp &gt;= dp_turbulent)<font color="blue"> then</font>
   V_flow := k*dp^m;
 <font color="blue">elseif </font>(dp &lt;= -dp_turbulent)<font color="blue"> then</font>
   V_flow :=-k*(-dp)^m;
 <font color="blue">else</font>
   a := gamma;
   b := 1/8*m^2 - 3*gamma - 3/2*m + 35.0/8;
   c := -1/4*m^2 + 3*gamma + 5/2*m - 21.0/4;
   d := 1/8*m^2 - gamma - m + 15.0/8;
   pi  := dp/dp_turbulent;
   pi2 := pi*pi;
   V_flow := k*dp_turbulent^m * pi * ( a + pi2 * ( b + pi2 * ( c + pi2 * d)));
 <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>powerLaw;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE powerLawFixedM<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Airflow.Multizone.BaseClasses.powerLawFixedM"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.powerLawFixedM</H2>
<B>Power law used in orifice equations when m is constant</B><p></P>
<P></P><H3>Information</H3>

<p>
This model describes the mass flow rate and pressure difference relation
of an orifice in the form
</p>
<p align="center" style="font-style:italic;">
  V = k sign(&Delta;p) |&Delta;p|<sup>m</sup>
</p>
<p>
where 
<i>V</i> is the volume flow rate,
<i>k &gt; 0</i> is a flow coefficient
<i>&Delta; p</i> is the pressure drop and
<i>m &isin; [0.5, 1]</i> is a flow coefficient.
The equation is regularized for 
<i>|&Delta;p| &lt; &Delta;p<sub>t</sub></i>, where
<i>&Delta;p<sub>t</sub></i> is a parameter.
For turbulent flow, set <i>m=1 &frasl; 2</i> and
for laminar flow, set <i>m=1</i>. 
</p>
<p>
The model is used for the interzonal air flow models.
It is identical to
<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.powerLaw"
>
Buildings.Airflow.Multizone.BaseClasses.powerLaw</a> but it
requires the polynomial coefficients as an input.
This allows a more efficient simulation if <i>m</i> and therefore also
<i>a</i>, <i>b</i>, <i>c</i> and <i>d</i> are constant.
</p>
<h4>Implementation</h4>
<p>
For <i>|&Delta;p| &lt; &Delta;p<sub>t</sub></i>, the equation is regularized
so that it is twice continuously differentiable in <i>&Delta;p</i>, and that it
has an infinite number of continuous derivatives in <i>m</i> and in <i>k</i>.
</p>
<p>
If <i>m</i>, and therefore also
<i>a</i>, <i>b</i>, <i>c</i> and <i>d</i>, change with time, then
it is more convenient and efficient to use
<A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses.powerLaw"
>
Buildings.Airflow.Multizone.BaseClasses.powerLaw</a>.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>k</TD><TD>&nbsp;</TD><TD>Flow coefficient, k = V_flow/ dp^m</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp</TD><TD>&nbsp;</TD><TD>Pressure difference [Pa]</TD></TR>
<TR><TD>Real</TD><TD>m</TD><TD>&nbsp;</TD><TD>Flow exponent, m=0.5 for turbulent, m=1 for laminar</TD></TR>
<TR><TD>Real</TD><TD>a</TD><TD>&nbsp;</TD><TD>Polynomial coefficient</TD></TR>
<TR><TD>Real</TD><TD>b</TD><TD>&nbsp;</TD><TD>Polynomial coefficient</TD></TR>
<TR><TD>Real</TD><TD>c</TD><TD>&nbsp;</TD><TD>Polynomial coefficient</TD></TR>
<TR><TD>Real</TD><TD>d</TD><TD>&nbsp;</TD><TD>Polynomial coefficient</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_turbulent</TD><TD>0.001</TD><TD>Pressure difference where regularization starts [Pa]</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A></TD><TD>V_flow</TD><TD>Volume flow rate [m3/s]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> powerLawFixedM <font color="darkgreen">
  &quot;Power law used in orifice equations when m is constant&quot;</font>
  <font color="blue">input </font>Real k <font color="darkgreen">&quot;Flow coefficient, k = V_flow/ dp^m&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dp <font color="darkgreen">&quot;Pressure difference&quot;</font>;
  <font color="blue">input </font>Real m(min=0.5, max=1) <font color="darkgreen">
    &quot;Flow exponent, m=0.5 for turbulent, m=1 for laminar&quot;</font>;
  <font color="blue">input </font>Real a <font color="darkgreen">&quot;Polynomial coefficient&quot;</font>;
  <font color="blue">input </font>Real b <font color="darkgreen">&quot;Polynomial coefficient&quot;</font>;
  <font color="blue">input </font>Real c <font color="darkgreen">&quot;Polynomial coefficient&quot;</font>;
  <font color="blue">input </font>Real d <font color="darkgreen">&quot;Polynomial coefficient&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> dp_turbulent(min=0)=0.001 <font color="darkgreen">
    &quot;Pressure difference where regularization starts&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</A> V_flow <font color="darkgreen">&quot;Volume flow rate&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">constant </font>Real gamma(min=1) = 1.5 <font color="darkgreen">
    &quot;Normalized flow rate where dphi(0)/dpi intersects phi(1)&quot;</font>;
  Real pi <font color="darkgreen">&quot;Normalized pressure&quot;</font>;
  Real pi2 <font color="darkgreen">&quot;Square of normalized pressure&quot;</font>;
<font color="blue">algorithm </font>
 <font color="blue">if </font>(dp &gt;= dp_turbulent)<font color="blue"> then</font>
   V_flow := k*dp^m;
 <font color="blue">elseif </font>(dp &lt;= -dp_turbulent)<font color="blue"> then</font>
   V_flow :=-k*(-dp)^m;
 <font color="blue">else</font>
   pi  := dp/dp_turbulent;
   pi2 := pi*pi;
   V_flow := k*dp_turbulent^m * pi * ( a + pi2 * ( b + pi2 * ( c + pi2 * d)));
 <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>powerLawFixedM;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE windPressureLowRise<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.Airflow.Multizone.BaseClasses.windPressureLowRise"></A><A HREF="Buildings_Airflow_Multizone_BaseClasses.html#Buildings.Airflow.Multizone.BaseClasses"
>Buildings.Airflow.Multizone.BaseClasses</A>.windPressureLowRise</H2>
<B>Wind pressure coefficient for low-rise buildings</B><p></P>
<P></P><H3>Information</H3>

<p>
This function computes the wind pressure coefficient for
low-rise buildings with rectangular shape.
The correlation is the data fit from Swami and Chandra (1987),
who fitted a function to various wind pressure coefficients from the literature.
The same correlation is also implemented in CONTAM (Persily and Ivy, 2001).
</p>
<p>
The wind pressure coefficient is computed based on the 
natural logarithm of the side ratio of the walls, which is defined as
</p>
<p align="center" style="font-style:italic;">
G = ln(x &frasl; y)
</p>
<p>
where <i>x</i> is the length of the wall that will be connected to 
this model, and <i>y</i> is the length of the adjacent wall as shown
in the figure below.
</p>
<p align="center">
<img src="../Resources/Images/Airflow/Multizone/BaseClasses/windPressureLowRise.png" border="1" alt="Definition of the aspect ratio."/>
</p>
<p>
Based on the wind incidence angle <i>&alpha;</i> and the side ratio
of the walls, the model computes how much the wind pressure
is attenuated compared to the reference wind pressure <code>Cp0</code>.
The reference wind pressure <code>Cp0</code> is a user-defined parameter,
and must be equal to the wind pressure at zero wind incidence angle, i.e., 
<i>&alpha; = 0</i>.
Swami and Chandra (1987) recommend <i>C<sub>p0</sub> = 0.6</i> for
all low-rise buildings as this represents the average of 
various values reported in the literature.
The attenuation factor is
</p>
<p align="center" style="font-style:italic;">
C<sub>p</sub> &frasl; C<sub>p0</sub> = ln(1.248 - 0.703 sin(&alpha; &frasl; 2)
      - 1.175 sin<sup>2</sup>(&alpha;)
      - 0.131 sin<sup>3</sup>(2 &alpha; G)
      + 0.769 cos(&alpha; &frasl; 2)
       +0.071 G<sup>2</sup> * sin<sup>2</sup>(&alpha; &frasl; 2)
       + 0.717 cos<sup>2</sup>(&alpha; &frasl; 2)),
</p>
<p>
where 
<i>C<sub>p</sub></i> is the wind pressure coefficient for
the current angle of incidence.
</p>
<p>
This function is used in
<A HREF="Buildings_Fluid_Sources.html#Buildings.Fluid.Sources.Outside_CpLowRise"
>
Buildings.Fluid.Sources.Outside_CpLowRise</a>
which can be used directly with components of this package.
</p>
<h4>References</h4>
<ul>
<li>
Muthusamy V. Swami and
Subrato Chandra.
<i>
<a href="http://www.fsec.ucf.edu/en/publications/pdf/FSEC-CR-163-86.pdf">
Procedures for
Calculating Natural
Ventilation Airflow
Rates in Buildings.</a></i>
Florida Solar Energy Center, FSEC-CR-163-86. March, 1987.
Cape Canaveral, Florida.
</li>
<li>
Andrew K. Persily and Elizabeth M. Ivy.
<i>
<a href="www.bfrl.nist.gov/IAQanalysis/docs/NISTIR6585.pdf">
Input Data for Multizone Airflow and IAQ Analysis.</a></i>
NIST, NISTIR 6585.
January, 2001.
Gaithersburg, MD.
</li>
</ul>
<h4>Implementation</h4>
<p>
Symmetry requires that the first derivative of the wind pressure coefficient
with respect to the incidence angle is zero for incidence angles of zero and &pi;.
However, the correlation of Swami and Chandra has non-zero derivatives at these values.
In this implementation, the original function is therefore slightly modified for incidence angles
between 0 and 5 degree, and between 175 and 180 degree.
This leads to a model that is differentiable in the incidence angle,
which generally leads to better numeric performance.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Cp0</TD><TD>&nbsp;</TD><TD>Wind pressure coefficient for normal wind incidence angle</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>incAng</TD><TD>&nbsp;</TD><TD>Wind incidence angle (0: normal to wall) [rad]</TD></TR>
<TR><TD>Real</TD><TD>G</TD><TD>&nbsp;</TD><TD>Natural logarithm of side ratio</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Cp</TD><TD>Wind pressure coefficient</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> windPressureLowRise <font color="darkgreen">
  &quot;Wind pressure coefficient for low-rise buildings&quot;</font>
  <font color="blue">input </font>Real Cp0(min=0) <font color="darkgreen">
    &quot;Wind pressure coefficient for normal wind incidence angle&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> incAng <font color="darkgreen">
    &quot;Wind incidence angle (0: normal to wall)&quot;</font>;
  <font color="blue">input </font>Real G <font color="darkgreen">&quot;Natural logarithm of side ratio&quot;</font>;
  <font color="blue">output </font>Real Cp <font color="darkgreen">&quot;Wind pressure coefficient&quot;</font>;
<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> aR <font color="darkgreen">&quot;alpha, restricted to 0...pi&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> incAng2 <font color="darkgreen">&quot;0.5*wind incidence angle&quot;</font>;
  Real sinA2 <font color="darkgreen">&quot;=sin(alpha/2)&quot;</font>;
  Real cosA2 <font color="darkgreen">&quot;=cos(alpha/2)&quot;</font>;
  Real a <font color="darkgreen">&quot;Attenuation factor&quot;</font>;
  <font color="blue">constant </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> pi2 = 2*Modelica.Constants.pi;
  <font color="blue">constant </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> aRDel = 5*Modelica.Constants.pi/180 <font color="darkgreen">
    &quot;Lower bound where transition occurs&quot;</font>;
  <font color="blue">constant </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> aRDel2 = aRDel/2 <font color="darkgreen">
    &quot;Half-width of transition interval&quot;</font>;
  <font color="blue">constant </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> aRMax = 175*Modelica.Constants.pi/180 <font color="darkgreen">
    &quot;Upper bound where transition occurs&quot;</font>;
  <font color="blue">constant </font>Real a180 =<font color="red"> Modelica.Math.log</font>(1.248 - 0.703 +
      0.131*<font color="red">Modelica.Math.sin</font>(2*Modelica.Constants.pi*G)^3
      + 0.071*G^2) <font color="darkgreen">&quot;Attenuation factor at 180 degree incidence angle&quot;</font>;
<font color="blue">algorithm </font>
  <font color="darkgreen">// Restrict incAng to [0...pi]</font>

  <font color="darkgreen">// Change sign to positive</font>
  aR := <font color="blue">if </font>incAng &lt; 0<font color="blue"> then </font>-incAng<font color="blue"> else </font>incAng;
  <font color="darkgreen">// Constrain to [0...2*pi]</font>
  <font color="blue">if </font>aR &gt; pi2<font color="blue"> then</font>
    aR := aR -<font color="red"> integer</font>(aR/pi2)*pi2;
  <font color="blue">end if</font>;
  <font color="darkgreen">// Constrain to [0...pi]</font>
  <font color="blue">if </font>aR &gt; Modelica.Constants.pi<font color="blue"> then</font>
    aR := pi2-aR;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Evaluate eqn. 2-1 from FSEC-CR-163-86</font>
  incAng2 :=aR/2;
  sinA2 :=<font color="red">Modelica.Math.sin</font>(incAng2);
  cosA2 :=<font color="red">Modelica.Math.cos</font>(incAng2);
  <font color="darkgreen">// Implementation of the wind pressure coefficient that is once</font>
  <font color="darkgreen">// continuously differentiable for all incidence angles</font>
  <font color="blue">if </font>aR &lt; aRDel<font color="blue"> then</font>
    Cp :=Cp0*<font color="red">Buildings.Utilities.Math.Functions.spliceFunction</font>(
        pos=<font color="red">  Modelica.Math.log</font>(1.248 - 0.703*sinA2 - 1.175*<font color="red">Modelica.Math.sin</font>(aR)^2 +
        0.131*<font color="red">Modelica.Math.sin</font>(2*aR*G)^3 + 0.769*cosA2 + 0.071*G^2*sinA2^2 + 0.717*cosA2^2),
        neg=1,
        x=aR-aRDel2,
        deltax=aRDel2);
  <font color="blue">elseif </font>aR &gt; aRMax<font color="blue"> then</font>
    Cp := Cp0*<font color="red">Buildings.Utilities.Math.Functions.spliceFunction</font>(
        pos=  a180,
        neg=<font color="red">Modelica.Math.log</font>(1.248 - 0.703*sinA2 - 1.175*<font color="red">Modelica.Math.sin</font>(aR)^2 +
        0.131*<font color="red">Modelica.Math.sin</font>(2*aR*G)^3 + 0.769*cosA2 + 0.071*G^2*sinA2^2 + 0.717*cosA2^2),
        x=aR+aRDel2-Modelica.Constants.pi,
        deltax=aRDel2);
  <font color="blue">else</font>
    Cp :=Cp0*<font color="red">Modelica.Math.log</font>(1.248 - 0.703*sinA2 - 1.175*<font color="red">Modelica.Math.sin</font>(aR)^2 +
      0.131*<font color="red">Modelica.Math.sin</font>(2*aR*G)^3 + 0.769*cosA2 + 0.071*G^2*sinA2^2 + 0.717*cosA2^2);
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>windPressureLowRise;
</PRE>
<HR>
<address><a href="http://www.3ds.com/">Automatically generated</a> Thu Oct 24 15:07:47 2013.
</address></BODY>
</HTML>
