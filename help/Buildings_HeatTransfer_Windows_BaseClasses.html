<HTML>
<HEAD>
<TITLE>Buildings.HeatTransfer.Windows.BaseClasses</TITLE>
<META name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META name="description" content="&quot;Package with base classes for Buildings.HeatTransfer.Windows&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- --- header ------ -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- --- end header -- -->
</P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses"></A><A HREF="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows"
>Buildings.HeatTransfer.Windows</A>.BaseClasses</H2>
<B>Package with base classes for Buildings.HeatTransfer.Windows</B>
<P></P>
<P></P><H3>Information</H3>

<p>
This package contains base classes that are used to construct the models in
<A HREF="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows"
>Buildings.HeatTransfer.Windows</a>.
</p>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</A> (Icon for packages containing base classes).
<P></P><H3>Package Content</H3>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wib3529e957ffd9a22ationS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation"
>AbsorbedRadiation</A>
</TD><TD>Absorbed radiation by window</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wia2645b093e456d79cientS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ExteriorConvectionCoefficient" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ExteriorConvectionCoefficient"
>ExteriorConvectionCoefficient</A>
</TD><TD>Model for the heat transfer coefficient at the outside of the window</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi9101e37f3e45a679cientS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.InteriorConvectionCoefficient" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.InteriorConvectionCoefficient"
>InteriorConvectionCoefficient</A>
</TD><TD>Model for the heat transfer coefficient at the inside of the window</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wicc148e58c19b2724GlassS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.CenterOfGlass" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.CenterOfGlass"
>CenterOfGlass</A>
</TD><TD>Model for center of glass of a window construction</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi5ef1d72fc7a5ee57ctionS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.GasConvection" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.GasConvection"
>GasConvection</A>
</TD><TD>Model for heat convection through gas in a window assembly</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wia6657059b5986812LayerS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer"
>GlassLayer</A>
</TD><TD>Model for a glass layer of a window assembly</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi21b30f6eb83053a2rhangS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.Overhang" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.Overhang"
>Overhang</A>
</TD><TD>For a window with an overhang, outputs the fraction of the area that is sun exposed</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi10948b5c7db343c9uctorS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ThermalConductor" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ThermalConductor"
>ThermalConductor</A>
</TD><TD>Lumped thermal element with variable area, transporting heat without storing it</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi29da9fcfc6b972d6ctionS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeConvection" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadeConvection"
>ShadeConvection</A>
</TD><TD>Model for convective heat balance of a layer that may or may not have a shade</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi785e6b84187e2e26ationS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeRadiation" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadeRadiation"
>ShadeRadiation</A>
</TD><TD>Model for infrared radiative heat balance of a layer that may or may not have a shade</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi0027dbf7b84a234cerBusS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus"
>ShadeInterface_weatherBus</A>
</TD><TD>Base class for models of window shade and overhangs</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi5d45a82eafc09590ignalS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal"
>ShadingSignal</A>
</TD><TD>Converts the shading signal to be strictly bigger than 0 and smaller than 1</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wiedf561c37b577351eFinsS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.SideFins" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.SideFins"
>SideFins</A>
</TD><TD>For a window with side fins, outputs the fraction of the area that is sun exposed</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wifccc9208b989ed30itionS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialWindowBoundaryCondition" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialWindowBoundaryCondition"
>PartialWindowBoundaryCondition</A>
</TD><TD>Partial model for heat convection or radiation between a possibly shaded window that can be outside or inside the room</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wiea1882b884f884c9ationS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>PartialRadiation</A>
</TD><TD>Partial model for variables and data used in radiation calculation</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi482ac2bf230204b0erBusS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialShade_weatherBus" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialShade_weatherBus"
>PartialShade_weatherBus</A>
</TD><TD>Partial model to implement overhang and side fins with weather bus connector</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wid0ddea1e04aca6a7ationS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation"
>TransmittedRadiation</A>
</TD><TD>Transmitted radiation through window</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi0c894215aeb7cea8ationS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.WindowRadiation" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.WindowRadiation"
>WindowRadiation</A>
</TD><TD>Calculation radiation for window</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wie53bec243087f999eDataS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData"
>RadiationBaseData</A>
</TD><TD>Basic parameters for window radiation calculation</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi5f9a5ce7433483eenDataS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.RadiationData" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationData"
>RadiationData</A>
</TD><TD>Radiation data of a window</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi242e3b4a314667b6avityS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.convectionVerticalCavity" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.convectionVerticalCavity"
>convectionVerticalCavity</A>
</TD><TD>Free convection in vertical cavity</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi242e3b4a314667b6avityS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.convectionHorizontalCavity" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.convectionHorizontalCavity"
>convectionHorizontalCavity</A>
</TD><TD>Free convection in horizontal cavity</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi242e3b4a314667b6avityS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityEnhanced" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityEnhanced"
>nusseltHorizontalCavityEnhanced</A>
</TD><TD>Nusselt number for horizontal cavity, bottom surface warmer than top surface</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi242e3b4a314667b6avityS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityReduced" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityReduced"
>nusseltHorizontalCavityReduced</A>
</TD><TD>Nusselt number for horizontal cavity, bottom surface colder than top surface</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi242e3b4a314667b6avityS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation"
>smoothInterpolation</A>
</TD><TD>Get interpolated data without triggering events</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Wi9c5e52fd31cc6685mplesS.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.Examples" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Windows_BaseClasses_Examples.html#Buildings.HeatTransfer.Windows.BaseClasses.Examples"
>Examples</A>
</TD><TD>Collection of models that illustrate model use and test models</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE AbsorbedRadiation<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wib3529e957ffd9a22ationI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.AbsorbedRadiation</H2>
<B>Absorbed radiation by window</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wib3529e957ffd9a22ationD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation">
<P></P><H3>Information</H3>

<p>
The model calculates absorbed solar radiation on the window. 
The calculations follow the description in Wetter (2004), Appendix A.4.3.
</p>
<p>
The absorbed radiation by exterior shades includes:
</p>
<ol>
<li>
the directly absorbed exterior radiation: <code>AWin*uSha*(HDir+HDif)*(1-tau-rho)</code>
</li>
<li>
the indirectly absorbed exterior radiantion from reflection (angular part): <code>AWin*uSha*HDir*tau*rho(IncAng)*(1-tau-rho)</code>
</li>
<li>
the indirectly absorbed of exterior irradiantion from reflection (diffusive part): <code>AWin*uSha*HDif*tau*rho(HEM)*(1-tau-rho)</code>
</li>
<li>
the absorbed interior radiation is neglected.
</li>
</ol>
<p>
The output is <code>absRad[2, 1]</code>
</p>

<p>
The absorbed radiation by interior shades includes:
</p>
<ol>
<li>
the absorbed exterior radiation (angular part): <code>AWin*uSha*HDir*alpha(IncAng)</code>
</li>
<li>
the absorbed exterior radiation (diffusive part): <code>AWin*uSha*HDif*alpha(HEM)</code>
</li>
<li>
the absorbed interior radiation (diffusive part): <code>AWin*uSha*HRoo*(1-tau-rho)</code>
</li>
</ol>
<p>
The output is <code>absRad[2, N+2]</code>
</p>

<p>
The absorbed radiation by glass includes:
</p>
<ol>
<li>
the absorbed radiation by unshaded part (diffusive part): <code>AWin*(1-uSha)*(HDif*alphaEx(HEM)+HRoo*alphaIn(HEM))</code>
</li>
<li>
the absorbed radiation by unshaded part (angular part from exterior source): <code>AWin*(1-uSha)*HDir*alphaEx(IncAng)</code>
</li>
<li>
the absorbed radiaiton by shaded part (diffusive part): <code>AWin*uSha*(HDif*alphaExSha(HEM)+HRoo*alphaInSha(HEM))</code>
</li>
<li>
the absorbed radiation by shaded part (angular part from exterior source): <code>AWin*uSha*HDir*alphaExSha(IncAng)</code>
</li>
</ol>
<p>
The output is <code>absRad[1, 2:N+1] = Part1 + Part2; absRad[2, 2:N+1] = Part3 + Part4</code>
</p>

<h4>References</h4>
<ul>
<li>
Michael Wetter.<br/>
<a href="http://simulationresearch.lbl.gov/wetter/download/mwdiss.pdf">
Simulation-based Building Energy Optimization</a>.<br/>
Dissertation. University of California at Berkeley. 2004.
</li>
</ul>
<P></P>
Extends from <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation</A> (Partial model for variables and data used in radiation calculation).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>haveExteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an exterior shade</TD></TR>
<TR><TD>Boolean</TD><TD>haveInteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an interior shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>AWin</TD><TD>&nbsp;</TD><TD>Area of window [m2]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Glass</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of glass layers</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xGla[N]</TD><TD>&nbsp;</TD><TD>Thickness of glass [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauGlaSol[N]</TD><TD>&nbsp;</TD><TD>Solar transmissivity of glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_a[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface a (facing outside) [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_b[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface b (facing room-side) [1]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_a</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_b</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from glass-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_a</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_b</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from glass-side [1]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>uSha</TD><TD>Control signal for shading (0: unshaded; 1: fully shaded)</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDif</TD><TD>Diffussive solar radiation [W/m2]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>incAng</TD><TD>Incident angle [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDir</TD><TD>Direct solar radiation [W/m2]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HRoo</TD><TD>Diffussive radiation from room  [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsExtSha_flow</TD><TD>Absorbed interior and exterior radiation by exterior shading device [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsIntSha_flow</TD><TD>Absorbed interior and exterior radiation by interior shading device [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsGlaUns_flow[N]</TD><TD>Absorbed interior and exterior radiation by unshaded part of glass [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsGlaSha_flow[N]</TD><TD>Absorbed interior and exterior radiation by shaded part of glass [W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> AbsorbedRadiation <font color="darkgreen">&quot;Absorbed radiation by window&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation</A>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> HRoo(quantity=&quot;RadiantEnergyFluenceRate&quot;,
      unit=&quot;W/m2&quot;) <font color="darkgreen">&quot;Diffussive radiation from room &quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsExtSha_flow(<font color="blue">final </font>quantity=&quot;Power&quot;,
      <font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by exterior shading device&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsIntSha_flow(<font color="blue">final </font>quantity=&quot;Power&quot;,
      <font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by interior shading device&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsGlaUns_flow[N](<font color="blue">each </font>quantity=
        &quot;Power&quot;, <font color="blue">each </font><font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by unshaded part of glass&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsGlaSha_flow[N](<font color="blue">each </font>quantity=
        &quot;Power&quot;, <font color="blue">each </font><font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by shaded part of glass&quot;</font>;</textblock>

  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> absRad[2, N + 2] <font color="darkgreen">&quot;Absorbed interior and exterior radiation. 
      (absRad[2,1]: exterior shading device, 
      absRad[1,2 to N+1]: glass (unshaded part),
      absRad[2,2 to N+1]: glass (shaded part),   
      absRad[2,N+2]: interior shading device)&quot;</font>;

<font color="blue">protected </font>
  Integer k=1;
  Real x;
  <font color="blue">final </font><font color="blue">parameter </font>Integer NDIR=radDat.NDIR;
  <font color="blue">final </font><font color="blue">parameter </font>Integer HEM=radDat.HEM;
  <font color="blue">constant </font>Integer NoShade=1;
  <font color="blue">constant </font>Integer Shade=2;
  <font color="blue">constant </font>Integer Interior=1;
  <font color="blue">constant </font>Integer Exterior=2;
  <font color="blue">final </font><font color="blue">parameter </font>Real coeAbsEx[2, radDat.N, radDat.HEM + 2](fixed=false);
  <font color="blue">final </font><font color="blue">parameter </font>Real coeRefExtPan1[radDat.HEM + 2](fixed=false) <font color="darkgreen">
    &quot;Reflectivity of pane 1&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real coeAbsIn[2, radDat.N](fixed=false);
  <font color="blue">final </font><font color="blue">parameter </font>Real coeAbsDevExtIrrIntSha[radDat.HEM + 2](fixed=false) <font color="darkgreen">
    &quot;Absorptivity of interior shading device for exterior radiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real coeAbsDevExtIrrExtSha=1 - radDat.traRefShaDev[1, 1] -
      radDat.traRefShaDev[2, 1] <font color="darkgreen">
    &quot;Absorptivity of exterior shading device for exterior radiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real coeAbsDevIntIrrIntSha=radDat.devAbsIntIrrIntSha <font color="darkgreen">
    &quot;Absorptivity of interior shading device for interior radiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real coeAbsDevIntIrrExtSha=1 - radDat.winTraRefIntIrrExtSha[1]
       - radDat.winTraRefIntIrrExtSha[2] <font color="darkgreen">
    &quot;Absorptivity of exterior shading device for interior radiation&quot;</font>;
  Real tmpNoSha;
  Real tmpSha;
  Real incAng2;

<font color="blue">initial </font><font color="blue">algorithm </font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Assign coefficients.</font>
  <font color="darkgreen">// Data dimension changes from Orginal ([1 : HEM]) to New ([2 : HEM+1])</font>
  <font color="darkgreen">// with 2 dummy variable for interpolation.</font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Glass</font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="blue">for </font>j<font color="blue"> in </font>1:HEM<font color="blue"> loop</font>
      <font color="darkgreen">// Properties for glass without shading</font>
      coeAbsEx[NoShade, i, j + 1] := radDat.absExtIrrNoSha[i, j];
      coeAbsIn[NoShade, i] := radDat.absIntIrrNoSha[i];
      <font color="darkgreen">// Properties for glass with shading</font>
      <font color="blue">if </font>haveInteriorShade<font color="blue"> then</font>
        coeAbsEx[Shade, i, j + 1] := radDat.absExtIrrIntSha[i, j];
        coeAbsIn[Shade, i] := radDat.absIntIrrIntSha[i];
      <font color="blue">elseif </font>haveExteriorShade<font color="blue"> then</font>
        coeAbsEx[Shade, i, j + 1] := radDat.absExtIrrExtSha[i, j];
        coeAbsIn[Shade, i] := radDat.absIntIrrExtSha[i];
      <font color="blue">else</font>
        <font color="darkgreen">// No Shade</font>
        coeAbsEx[Shade, i, j + 1] := 0.0;
        coeAbsIn[Shade, i] := 0.0;
      <font color="blue">end if</font>;
    <font color="blue">end for</font>;
    <font color="darkgreen">// Dummy variables at 1 and HEM+2</font>
    <font color="blue">for </font>k<font color="blue"> in </font>NoShade:Shade<font color="blue"> loop</font>
      coeAbsEx[k, i, 1] := coeAbsEx[k, i, 2];
      coeAbsEx[k, i, HEM + 2] := coeAbsEx[k, i, HEM + 1];
    <font color="blue">end for</font>;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Glass Pane 1: Reflectivity</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:HEM<font color="blue"> loop</font>
    coeRefExtPan1[j + 1] := radDat.traRef[2, 1, N, j];
  <font color="blue">end for</font>;

  <font color="darkgreen">// Interior shades</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:HEM<font color="blue"> loop</font>
    coeAbsDevExtIrrIntSha[j + 1] := radDat.devAbsExtIrrIntShaDev[j];
  <font color="blue">end for</font>;

  <font color="darkgreen">// Dummy variables at 1 and HEM+2</font>
  coeRefExtPan1[1] := coeRefExtPan1[2];
  coeRefExtPan1[HEM + 2] := coeRefExtPan1[HEM + 1];
  coeAbsDevExtIrrIntSha[1] := coeAbsDevExtIrrIntSha[2];
  coeAbsDevExtIrrIntSha[HEM + 2] := coeAbsDevExtIrrIntSha[HEM + 1];

<font color="blue">algorithm </font>
  absRad[NoShade, 1] := 0.0;
  absRad[NoShade, N + 2] := 0.0;
  absRad[Shade, 1] := 0.0;
  absRad[Shade, N + 2] := 0.0;

  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Glass: absorbed diffusive radiation from exterior and interior sources</font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    absRad[NoShade, i + 1] := AWin*(1 - uSha_internal)*(HDif*coeAbsEx[NoShade,
      i, HEM + 1] + HRoo*coeAbsIn[NoShade, i]);
    absRad[Shade, i + 1] := AWin*uSha_internal*(HDif*coeAbsEx[Shade, i, HEM + 1]
       + HRoo*coeAbsIn[Shade, i]);
  <font color="blue">end for</font>;

  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Shading device: absorbed radiation from exterior source</font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Exterior Shading Device:</font>
  <font color="darkgreen">// direct radiation: 1. direct absorption;</font>
  <font color="darkgreen">// diffusive radiation: 1. direct absorption 2. absorption from back reflection</font>
  <font color="blue">if </font>haveExteriorShade<font color="blue"> then</font>
    absRad[Shade, 1] := AWin*uSha_internal*coeAbsDevExtIrrExtSha*(HDif + HDir
       + HDif*radDat.traRefShaDev[1, 1]*radDat.traRef[2, 1, N, HEM]);
    <font color="darkgreen">// Interior Shading Device: diffusive radiation from both interior and exterior</font>
  <font color="blue">elseif </font>haveInteriorShade<font color="blue"> then</font>
    absRad[Shade, N + 2] := AWin*uSha_internal*(HDif*radDat.devAbsExtIrrIntShaDev[
      HEM] + HRoo*coeAbsDevIntIrrIntSha);
  <font color="blue">end if</font>;

  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Glass, Device: add absorbed direct radiation from exterior sources</font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Use min() instead of if() to avoid event</font>
  incAng2 :=<font color="red"> min</font>(incAng, 0.5*Modelica.Constants.pi);

  x := 2*(NDIR - 1)*<font color="red">abs</font>(incAng2)/Modelica.Constants.pi <font color="darkgreen">
    &quot;x=(index-1)*incAng/(0.5pi), 0&lt;=x&lt;=NDIR&quot;</font>;
  x := x + 2;

  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="darkgreen">// Glass without shading: Add absorbed direct radiation</font>
    tmpNoSha :=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation</font>({
      coeAbsEx[NoShade, i, k] <font color="blue">for </font>k<font color="blue"> in </font>1:(HEM + 2)}, x);
    absRad[NoShade, i + 1] := absRad[NoShade, i + 1] + AWin*HDir*(1 -
      uSha_internal)*tmpNoSha;

    <font color="darkgreen">// Glass with shading: add absorbed direct radiation</font>
    tmpSha :=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation</font>({
      coeAbsEx[Shade, i, k] <font color="blue">for </font>k<font color="blue"> in </font>1:(HEM + 2)}, x);
    absRad[Shade, i + 1] := absRad[Shade, i + 1] + AWin*HDir*uSha_internal*
      tmpSha;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Interior shading device: add absorbed direct radiation</font>
  <font color="blue">if </font>haveInteriorShade<font color="blue"> then</font>
    tmpSha :=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation</font>({
      coeAbsDevExtIrrIntSha[k] <font color="blue">for </font>k<font color="blue"> in </font>1:(HEM + 2)}, x);
    absRad[Shade, N + 2] := absRad[Shade, N + 2] + AWin*HDir*uSha_internal*
      tmpSha;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Exterior shading device: add absorbed reflection of direct radiation from exterior source</font>
  <font color="blue">if </font>haveExteriorShade<font color="blue"> then</font>
    tmpNoSha :=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation</font>({
      coeRefExtPan1[k] <font color="blue">for </font>k<font color="blue"> in </font>1:(HEM + 2)}, x);
    absRad[Shade, 1] := absRad[Shade, 1] + AWin*HDir*uSha_internal*
      coeAbsDevExtIrrExtSha*tmpNoSha;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Assign quantities to output connectors</font>
  QAbsExtSha_flow := absRad[2, 1];
  QAbsIntSha_flow := absRad[2, N + 2];
  QAbsGlaUns_flow[:] := absRad[1, 2:N + 1];
  QAbsGlaSha_flow[:] := absRad[2, 2:N + 1];
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>AbsorbedRadiation;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ExteriorConvectionCoefficient<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wia2645b093e456d79cientI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ExteriorConvectionCoefficient" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.ExteriorConvectionCoefficient"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.ExteriorConvectionCoefficient</H2>
<B>Model for the heat transfer coefficient at the outside of the window</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wia2645b093e456d79cientD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ExteriorConvectionCoefficient">
<P></P><H3>Information</H3>

Model for the convective heat transfer coefficient at the outside of a window.
The computation is according to TARCOG 2006, which specifies the convection
coefficient as
<p align="center" style="font-style:italic;">
  h = 4+4 v
</p>
where <i>v</i> is the wind speed in <i>m/s</i> and
<i>h</i> is the convective heat transfer coefficient in <i>W/(m2*K)</i>.
<br/>
<h4>References</h4>

TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A> (Basic graphical layout of input/output block).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>GCon</TD><TD>Convective thermal conductance [W/K]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>v</TD><TD>Wind speed [m/s]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ExteriorConvectionCoefficient <font color="darkgreen">
  &quot;Model for the heat transfer coefficient at the outside of the window&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> GCon(unit=&quot;W/K&quot;) <font color="darkgreen">
    &quot;Convective thermal conductance&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> v(unit=&quot;m/s&quot;) <font color="darkgreen">&quot;Wind speed&quot;</font>;</textblock>

<font color="blue">equation </font>
  GCon = A*(4+4*<font color="red">Buildings.Utilities.Math.Functions.smoothMax</font>(v, -v, 0.1));
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ExteriorConvectionCoefficient;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE InteriorConvectionCoefficient<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi9101e37f3e45a679cientI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.InteriorConvectionCoefficient" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.InteriorConvectionCoefficient"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.InteriorConvectionCoefficient</H2>
<B>Model for the heat transfer coefficient at the inside of the window</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi9101e37f3e45a679cientD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.InteriorConvectionCoefficient">
<P></P><H3>Information</H3>

Model for the convective heat transfer coefficient at the room-facing surface of a window.
The computation is according to TARCOG 2006, which specifies the convection
coefficient as
<p align="center" style="font-style:italic;">
  h = 4 W &frasl; (m<sup>2</sup> K).
</p>
<h4>References</h4>
<p>
TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A> (Basic graphical layout of input/output block).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>GCon</TD><TD>Convective thermal conductance [W/K]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> InteriorConvectionCoefficient <font color="darkgreen">
  &quot;Model for the heat transfer coefficient at the inside of the window&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> GCon(unit=&quot;W/K&quot;) <font color="darkgreen">
    &quot;Convective thermal conductance&quot;</font>;</textblock>

<font color="blue">equation </font>
  GCon = 4*A;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>InteriorConvectionCoefficient;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE CenterOfGlass<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wicc148e58c19b2724GlassI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.CenterOfGlass" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.CenterOfGlass"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.CenterOfGlass</H2>
<B>Model for center of glass of a window construction</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wicc148e58c19b2724GlassD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.CenterOfGlass">
<P></P><H3>Information</H3>

This is a model for the heat transfer through the center of the glass.
The properties of the glazing system is defined by the parameter
<code>glaSys</code>. 
The model contains these main component models:
<ul>
<li>
the models <code>extSha</code> and <code>intSha</code>
for the heat balance of the shade, modeled using
<a href="modelica://Buildings.HeatTransfer.Windows.BaseClasses.Shade">
Buildings.HeatTransfer.Windows.BaseClasses.Shade</a>.
</li>
<li>
an array of models <code>glass</code> for the heat conduction and the 
infrared radiative heat balance of the glass layers.
There can be an arbitrary number of glass layers, which are all modeled using 
instances of
<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer"
>
Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer</a>.
</li>
<li>
an array of models <code>gas</code> for the gas layers. There is one model of a
gas layer between each window panes. The gas layers are modeled using instances of
<A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.GasConvection"
>
Buildings.HeatTransfer.Windows.BaseClasses.GasConvection</a>.
</li>
</ul>
Note that this model does <em>not</em> compute heat conduction through the frame and
it does <em>not</em> model the convective heat transfer at the exterior and interior
surface. These models are implemented in 
<A HREF="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.Window"
>
Buildings.HeatTransfer.Windows.Window</a>, 
<A HREF="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.ExteriorHeatTransfer"
>
Buildings.HeatTransfer.Windows.ExteriorHeatTransfer</a>, and
<a href="modelica://Buildings.HeatTransfer.Windows.InteriorHeatTransfer">
Buildings.HeatTransfer.Windows.InteriorHeatTransfer</a>
<P></P>
Extends from <A HREF="Buildings_HeatTransfer_Radiosity_BaseClasses.html#Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces"
>Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces</A> (Model for the radiosity balance of a device with two surfaces).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Surface area [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>til</TD><TD>&nbsp;</TD><TD>Surface tilt (only 90 degrees=vertical is implemented) [rad]</TD></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.Generic"
>Generic</A></TD><TD>glaSys</TD><TD>&nbsp;</TD><TD>Glazing system</TD></TR>
<TR><TD>Boolean</TD><TD>linearize</TD><TD>false</TD><TD>Set to true to linearize emissive power</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</A></TD><TD>JIn_a</TD><TD>Incoming radiosity at surface a [W]</TD></TR>
<TR><TD>input <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</A></TD><TD>JIn_b</TD><TD>Incoming radiosity at surface b [W]</TD></TR>
<TR><TD>output <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</A></TD><TD>JOut_a</TD><TD>Outgoing radiosity at surface a [W]</TD></TR>
<TR><TD>output <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</A></TD><TD>JOut_b</TD><TD>Outgoing radiosity at surface b [W]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>u</TD><TD>Input connector, used to scale the surface area to take into account an operable shading device</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>glass_a</TD><TD>Heat port connected to the outside facing surface of the glass</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>glass_b</TD><TD>Heat port connected to the room-facing surface of the glass</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>QAbs_flow[size(glass, 1)]</TD><TD>Solar radiation absorbed by glass [W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> CenterOfGlass <font color="darkgreen">
  &quot;Model for center of glass of a window construction&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Radiosity_BaseClasses.html#Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces"
>Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces</A>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> til(displayUnit=&quot;deg&quot;) <font color="darkgreen">
    &quot;Surface tilt (only 90 degrees=vertical is implemented)&quot;</font>;

<textblock type="annotcomp" expanded="false">  <font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.Generic"
>Buildings.HeatTransfer.Data.GlazingSystems.Generic</A> glaSys <font color="darkgreen">
    &quot;Glazing system&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u <font color="darkgreen">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device&quot;</font>;
    </textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer"
>Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer</A>[glaSys.nLay] glass(
    <font color="blue">each </font><font color="blue">final </font>A=A,
    <font color="blue">final </font>x=glaSys.glass.x,
    <font color="blue">final </font>k=glaSys.glass.k,
    <font color="blue">final </font>absIR_a=glaSys.glass.absIR_a,
    <font color="blue">final </font>absIR_b=glaSys.glass.absIR_b,
    <font color="blue">final </font>tauIR=glaSys.glass.tauIR,
    <font color="blue">each </font><font color="blue">final </font>linearize=linearize) <font color="darkgreen">&quot;Window glass layer&quot;</font>;
  <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.GasConvection"
>Buildings.HeatTransfer.Windows.BaseClasses.GasConvection</A> gas[glaSys.nLay-1](
    <font color="blue">each </font><font color="blue">final </font>A=A,
    <font color="blue">final </font>gas=glaSys.gas,
    <font color="blue">each </font><font color="blue">final </font>til=til,
    <font color="blue">each </font>linearize=linearize) <font color="darkgreen">&quot;Window gas layer&quot;</font>;</textblock>

  <font color="darkgreen">// Note that the interior shade is flipped horizontally. Hence, surfaces a and b are exchanged,</font>
  <font color="darkgreen">// i.e., surface a faces the room, while surface b faces the window</font>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> glass_a <font color="darkgreen">
    &quot;Heat port connected to the outside facing surface of the glass&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> glass_b <font color="darkgreen">
    &quot;Heat port connected to the room-facing surface of the glass&quot;</font>;</textblock>

  <font color="blue">parameter </font>Boolean linearize=false <font color="darkgreen">&quot;Set to true to linearize emissive power&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> QAbs_flow[<font color="red">size</font>(glass, 1)](<font color="blue">each </font>unit=&quot;W&quot;, <font color="blue">each </font>
      quantity =                                                                              &quot;Power&quot;) <font color="darkgreen">
    &quot;Solar radiation absorbed by glass&quot;</font>;</textblock>
<font color="blue">equation </font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:glaSys.nLay-1<font color="blue"> loop</font>
<textblock type="annotconnect" expanded="false">    <font color="red">connect</font>(glass[i].port_b, gas[i].port_a);
    <font color="red">connect</font>(gas[i].port_b, glass[i+1].port_a);</textblock>

<textblock type="annotconnect" expanded="false">    <font color="red">connect</font>(glass[i].JOut_b, glass[i+1].JIn_a);
    <font color="red">connect</font>(glass[i].JIn_b, glass[i+1].JOut_a);</textblock>

<textblock type="annotconnect" expanded="false">    <font color="red">connect</font>(u, gas[i].u);</textblock>

  <font color="blue">end for</font>;

  <font color="blue">for </font>i<font color="blue"> in </font>1:glaSys.nLay<font color="blue"> loop</font>
<textblock type="annotconnect" expanded="false">    <font color="red">connect</font>(u, glass[i].u);</textblock>
  <font color="blue">end for</font>;

<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(glass_b, glass[glaSys.nLay].port_b);</textblock>

<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(glass_a, glass[1].port_a);</textblock>

<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(JIn_a, glass[1].JIn_a);
  <font color="red">connect</font>(glass[1].JOut_a, JOut_a);
  <font color="red">connect</font>(glass[glaSys.nLay].JOut_b, JOut_b);
  <font color="red">connect</font>(JIn_b, glass[glaSys.nLay].JIn_b);
  <font color="red">connect</font>(glass.QAbs_flow, QAbs_flow);</textblock>
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>CenterOfGlass;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GasConvection<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi5ef1d72fc7a5ee57ctionI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.GasConvection" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.GasConvection"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.GasConvection</H2>
<B>Model for heat convection through gas in a window assembly</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi5ef1d72fc7a5ee57ctionD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.GasConvection">
<P></P><H3>Information</H3>

Model for convective heat tranfer in a single layer of window gas.
Currently, the model only implements equations for vertical windows
and for horizontal windows.
The computation is according to TARCOG 2006,
except that this implementation computes the convection coefficient
as a function that is differentiable in the temperatures.
<p>
To use this model, set the parameter <code>til</code>
to a value defined in 
<A HREF="Buildings_HeatTransfer_Types_Tilt.html#Buildings.HeatTransfer.Types.Tilt"
>
Buildings.HeatTransfer.Types.Tilt</a>.
</p>
<br/>

<p>
If the parameter <code>linearize</code> is set to <code>true</code>,
then all equations are linearized.
</p>
<h4>References</h4>

TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.Element1D"
>Modelica.Thermal.HeatTransfer.Interfaces.Element1D</A> (Partial heat transfer element with two HeatPort connectors that does not store energy), <A HREF="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</A> (Base icon).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Generic</A></TD><TD>gas</TD><TD>&nbsp;</TD><TD>Thermophysical properties of gas fill</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>h</TD><TD>sqrt(A)</TD><TD>Height of window [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>til</TD><TD>&nbsp;</TD><TD>Surface tilt (only 0, 90 and 180 degrees are implemented) [rad]</TD></TR>
<TR><TD>Boolean</TD><TD>linearize</TD><TD>false</TD><TD>Set to true to linearize emissive power</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T0</TD><TD>293.15</TD><TD>Temperature used to compute thermophysical properties [K]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>u</TD><TD>Input connector, used to scale the surface area to take into account an operable shading device</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> GasConvection <font color="darkgreen">
  &quot;Model for heat convection through gas in a window assembly&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.Element1D"
>Modelica.Thermal.HeatTransfer.Interfaces.Element1D</A>(
     port_a(T(start=293.15)),
     port_b(T(start=293.15)));
  <font color="blue">extends </font><A HREF="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</A>;
  <font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Buildings.HeatTransfer.Data.Gases.Generic</A> gas <font color="darkgreen">
    &quot;Thermophysical properties of gas fill&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> h(min=0) =<font color="red"> sqrt</font>(A) <font color="darkgreen">&quot;Height of window&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> til(displayUnit=&quot;deg&quot;) <font color="darkgreen">
    &quot;Surface tilt (only 0, 90 and 180 degrees are implemented)&quot;</font>;
  <font color="blue">parameter </font>Boolean linearize=false <font color="darkgreen">&quot;Set to true to linearize emissive power&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u <font color="darkgreen">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device&quot;</font>;
    </textblock>

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T0 = 293.15 <font color="darkgreen">
    &quot;Temperature used to compute thermophysical properties&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</A> hCon(min=0, start=3) <font color="darkgreen">
    &quot;Convective heat transfer coefficient&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>Modelica.SIunits.HeatFlux</A> q_flow <font color="darkgreen">&quot;Convective heat flux&quot;</font>;
  Real Nu(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  Real Ra(min=0) <font color="darkgreen">&quot;Rayleigh number&quot;</font>;
<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_a <font color="darkgreen">
    &quot;Temperature used for thermophysical properties at port_a&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_b <font color="darkgreen">
    &quot;Temperature used for thermophysical properties at port_b&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_m <font color="darkgreen">
    &quot;Temperature used for thermophysical properties&quot;</font>;

  Real deltaNu(min=0.01) = 0.1 <font color="darkgreen">
    &quot;Small value for Nusselt number, used for smoothing&quot;</font>;
  Real deltaRa(min=0.01) = 100 <font color="darkgreen">
    &quot;Small value for Rayleigh number, used for smoothing&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real cosTil=<font color="red">Modelica.Math.cos</font>(til) <font color="darkgreen">&quot;Cosine of window tilt&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real sinTil=<font color="red">Modelica.Math.sin</font>(til) <font color="darkgreen">&quot;Sine of window tilt&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Boolean isVertical =<font color="red"> abs</font>(cosTil) &lt; 10E-10 <font color="darkgreen">
    &quot;Flag, true if the window is in a wall&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Boolean isHorizontal =<font color="red"> abs</font>(sinTil) &lt; 10E-10 <font color="darkgreen">
    &quot;Flag, true if the window is horizontal&quot;</font>;
  <font color="darkgreen">// Quantities that are only used in linearized model</font>

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</A> hCon0(fixed=false) <font color="darkgreen">
    &quot;Convective heat transfer coefficient&quot;</font>;
  <font color="blue">parameter </font>Real Nu0(fixed=false, min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  <font color="blue">parameter </font>Real Ra0(fixed=false, min=0) <font color="darkgreen">&quot;Rayleigh number&quot;</font>;
  <font color="blue">parameter </font>Boolean homotopyInitialization = true <font color="darkgreen">&quot;= true, use homotopy method&quot;</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="red">assert</font>(isVertical<font color="blue"> or </font>isHorizontal, &quot;Only vertical and horizontal windows are implemented.&quot;);
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Computations that are used in the linearized model only</font>
  Ra0 =<font color="red"> Buildings.HeatTransfer.Convection.Functions.HeatFlux.rayleigh</font>(
    x=gas.x,
    rho=<font color="red">Buildings.HeatTransfer.Data.Gases.density</font>(gas, T0),
    c_p=<font color="red">Buildings.HeatTransfer.Data.Gases.specificHeatCapacity</font>(gas, T0),
    mu=<font color="red">Buildings.HeatTransfer.Data.Gases.dynamicViscosity</font>(gas, T0),
    k=<font color="red">Buildings.HeatTransfer.Data.Gases.thermalConductivity</font>(gas, T0),
    T_a=T0-5,
    T_b=T0+5,
    Ra_min=100);
  (Nu0, hCon0) =<font color="red"> Buildings.HeatTransfer.Windows.BaseClasses.convectionVerticalCavity</font>(
            gas=gas, Ra=Ra0, T_m=T0, dT=10, h=h, deltaNu=deltaNu, deltaRa=deltaRa);

<font color="blue">equation </font>
  T_a = port_a.T;
  T_b = port_b.T;
  T_m = (port_a.T+port_b.T)/2;
  <font color="blue">if </font>linearize<font color="blue"> then</font>
    Ra=Ra0;
    Nu=Nu0;
    hCon=hCon0;
    q_flow = hCon0 * dT;
  <font color="blue">else</font>
    Ra =<font color="red"> Buildings.HeatTransfer.Convection.Functions.HeatFlux.rayleigh</font>(
      x=gas.x,
      rho=<font color="red">Buildings.HeatTransfer.Data.Gases.density</font>(gas, T_m),
      c_p=<font color="red">Buildings.HeatTransfer.Data.Gases.specificHeatCapacity</font>(gas, T_m),
      mu=<font color="red">Buildings.HeatTransfer.Data.Gases.dynamicViscosity</font>(gas, T_m),
      k=<font color="red">Buildings.HeatTransfer.Data.Gases.thermalConductivity</font>(gas, T_m),
      T_a=T_a,
      T_b=T_b,
      Ra_min=100);
    <font color="blue">if </font>isVertical<font color="blue"> then</font>
       (Nu, hCon, q_flow) =<font color="red"> Buildings.HeatTransfer.Windows.BaseClasses.convectionVerticalCavity</font>(
              gas=gas, Ra=Ra, T_m=T_m, dT=dT, h=h, deltaNu=deltaNu, deltaRa=deltaRa);
    <font color="blue">elseif </font>isHorizontal<font color="blue"> then</font>
       (Nu, hCon, q_flow) =<font color="red"> Buildings.HeatTransfer.Windows.BaseClasses.convectionHorizontalCavity</font>(
              gas=gas, Ra=Ra, T_m=T_m, dT=dT, til=til, sinTil=sinTil, cosTil=cosTil,
              h=h, deltaNu=deltaNu, deltaRa=deltaRa);

    <font color="blue">else</font>
       Nu = 0;
       hCon=0;
       q_flow=0;
    <font color="blue">end if</font>;<font color="darkgreen"> // isVertical or isHorizontal</font>
  <font color="blue">end if</font>;<font color="darkgreen"> // linearize</font>
  <font color="blue">if </font>homotopyInitialization<font color="blue"> then</font>
    Q_flow = u*A*<font color="red">homotopy</font>(actual=q_flow,
                          simplified=hCon0*dT);
  <font color="blue">else</font>
    Q_flow = u*A*q_flow;
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>GasConvection;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GlassLayer<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wia6657059b5986812LayerI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.GlassLayer</H2>
<B>Model for a glass layer of a window assembly</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wia6657059b5986812LayerD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.GlassLayer">
<P></P><H3>Information</H3>

Model of a single layer of window glass. The input port <code>QAbs_flow</code>
needs to be connected to the solar radiation that is absorbed
by the glass pane.
The model computes the heat conduction between the two glass surfaces.
The heat flow <code>QAbs_flow</code> is added at the center of the glass.
The model also computes the infrared radiative heat balance using an instance
of the model
<a href="Buildings.HeatTransfer.Radiosity.WindowPane">
Buildings.HeatTransfer.Radiosity.WindowPane</a>.
<br/>
<P></P>
Extends from <A HREF="Buildings_HeatTransfer_Radiosity_BaseClasses.html#Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces"
>Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces</A> (Model for the radiosity balance of a device with two surfaces), <A HREF="Buildings_HeatTransfer_Radiosity_BaseClasses.html#Buildings.HeatTransfer.Radiosity.BaseClasses.ParametersTwoSurfaces"
>Buildings.HeatTransfer.Radiosity.BaseClasses.ParametersTwoSurfaces</A> (Parameters that are used to model two surfaces with the same area).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Surface area [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</A></TD><TD>absIR_a</TD><TD>&nbsp;</TD><TD>Infrared absorptivity of surface a [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</A></TD><TD>absIR_b</TD><TD>&nbsp;</TD><TD>Infrared absorptivity of surface b [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoIR_a</TD><TD>1 - absIR_a - tauIR</TD><TD>Infrared reflectivity of surface a [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoIR_b</TD><TD>1 - absIR_b - tauIR</TD><TD>Infrared reflectivity of surface b [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauIR</TD><TD>&nbsp;</TD><TD>Infrared transmissivity of glass pane [1]</TD></TR>
<TR><TD>Boolean</TD><TD>linearize</TD><TD>false</TD><TD>Set to true to linearize emissive power</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T0</TD><TD>293.15</TD><TD>Temperature used to linearize radiative heat transfer [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>x</TD><TD>&nbsp;</TD><TD>Material thickness [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>k</TD><TD>&nbsp;</TD><TD>Thermal conductivity [W/(m.K)]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</A></TD><TD>JIn_a</TD><TD>Incoming radiosity at surface a [W]</TD></TR>
<TR><TD>input <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</A></TD><TD>JIn_b</TD><TD>Incoming radiosity at surface b [W]</TD></TR>
<TR><TD>output <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</A></TD><TD>JOut_a</TD><TD>Outgoing radiosity at surface a [W]</TD></TR>
<TR><TD>output <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</A></TD><TD>JOut_b</TD><TD>Outgoing radiosity at surface b [W]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>u</TD><TD>Input connector, used to scale the surface area to take into account an operable shading device</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>Heat port at surface a</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>Heat port at surface b</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>QAbs_flow</TD><TD>Solar radiation absorbed by glass [W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> GlassLayer <font color="darkgreen">&quot;Model for a glass layer of a window assembly&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Radiosity_BaseClasses.html#Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces"
>Buildings.HeatTransfer.Radiosity.BaseClasses.RadiosityTwoSurfaces</A>;
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Radiosity_BaseClasses.html#Buildings.HeatTransfer.Radiosity.BaseClasses.ParametersTwoSurfaces"
>Buildings.HeatTransfer.Radiosity.BaseClasses.ParametersTwoSurfaces</A>(
    <font color="blue">final </font>rhoIR_a=1-absIR_a-tauIR,
    <font color="blue">final </font>rhoIR_b=1-absIR_b-tauIR);
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> x <font color="darkgreen">&quot;Material thickness&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> k <font color="darkgreen">&quot;Thermal conductivity&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</A> absIR_a <font color="darkgreen">
    &quot;Infrared absorptivity of surface a (usually room-facing surface)&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</A> absIR_b <font color="darkgreen">
    &quot;Infrared absorptivity of surface b (usually outside-facing surface)&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</A> tauIR <font color="darkgreen">&quot;Infrared transmittance of glass&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u <font color="darkgreen">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> port_a(T(start=293.15, nominal=293.15)) <font color="darkgreen">
    &quot;Heat port at surface a&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> port_b(T(start=293.15, nominal=293.15)) <font color="darkgreen">
    &quot;Heat port at surface b&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> QAbs_flow(unit=&quot;W&quot;, quantity=&quot;Power&quot;) <font color="darkgreen">
    &quot;Solar radiation absorbed by glass&quot;</font>;</textblock>
  <font color="blue">parameter </font>Boolean linearize=false <font color="darkgreen">&quot;Set to true to linearize emissive power&quot;</font>;
  <font color="blue">parameter </font>Boolean homotopyInitialization = true <font color="darkgreen">&quot;= true, use homotopy method&quot;</font>;
<font color="blue">protected </font>
 Real T4_a(min=1E8, unit=&quot;K4&quot;, start=293.15^4, nominal=1E10) <font color="darkgreen">
    &quot;4th power of temperature at surface a&quot;</font>;
 Real T4_b(min=1E8, unit=&quot;K4&quot;, start=293.15^4, nominal=1E10) <font color="darkgreen">
    &quot;4th power of temperature at surface b&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> E_a(min=0, nominal=1E2) <font color="darkgreen">
    &quot;Emissive power of surface a&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> E_b(min=0, nominal=1E2) <font color="darkgreen">
    &quot;Emissive power of surface b&quot;</font>;
 <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>Modelica.SIunits.ThermalResistance</A> R = x/2/k/A <font color="darkgreen">
    &quot;Thermal resistance from surface of glass to center of glass&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// Heat balance of surface node</font>
  <font color="darkgreen">// These equations are from Window 6 Technical report, (2.1-14) to (2.1-17)</font>
  0 = port_a.Q_flow + port_b.Q_flow + QAbs_flow + JIn_a  + JIn_b - JOut_a - JOut_b;
  u * (port_b.T-port_a.T) = 2*R * (-port_a.Q_flow-QAbs_flow/2-JIn_a+JOut_a);
  <font color="darkgreen">// Radiosity balance</font>
  <font color="blue">if </font>linearize<font color="blue"> then</font>
    T4_a = 4*T03*port_a.T - 3*T04;
    T4_b = 4*T03*port_b.T - 3*T04;
  <font color="blue">else</font>
    <font color="blue">if </font>homotopyInitialization<font color="blue"> then</font>
      T4_a =<font color="red"> homotopy</font>(actual=port_a.T^4, simplified=4*T03*port_a.T - 3*T04);
      T4_b =<font color="red"> homotopy</font>(actual=port_b.T^4, simplified=4*T03*port_b.T - 3*T04);
    <font color="blue">else</font>
      T4_a = port_a.T^4;
      T4_b = port_b.T^4;
    <font color="blue">end if</font>;
  <font color="blue">end if</font>;
  <font color="darkgreen">// Emissive power</font>
  E_a = u * A * absIR_a * Modelica.Constants.sigma * T4_a;
  E_b = u * A * absIR_b * Modelica.Constants.sigma * T4_b;
  <font color="darkgreen">// Radiosities that are outgoing from the surface, which are</font>
  <font color="darkgreen">// equal to the infrared absorptivity plus the reflected incoming</font>
  <font color="darkgreen">// radiosity plus the radiosity that is transmitted from the</font>
  <font color="darkgreen">// other surface.</font>
  JOut_a = E_a + rhoIR_a * JIn_a + tauIR * JIn_b;
  JOut_b = E_b + rhoIR_b * JIn_b + tauIR * JIn_a;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>GlassLayer;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Overhang<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi21b30f6eb83053a2rhangI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.Overhang" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.Overhang"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.Overhang</H2>
<B>For a window with an overhang, outputs the fraction of the area that is sun exposed</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi21b30f6eb83053a2rhangD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.Overhang">
<P></P><H3>Information</H3>

<p>
For a window with an overhang, this block outputs the fraction of 
the area that is exposed to the sun.
This models can also be used for doors with an overhang. 
</p>
<p>
Input to this block are the 
wall solar azimuth angle and the altitude angle of the sun. 
These angles can be calculated using blocks from the package
<A HREF="Buildings_BoundaryConditions_SolarGeometry_BaseClasses.html#Buildings.BoundaryConditions.SolarGeometry.BaseClasses"
>
Buildings.BoundaryConditions.SolarGeometry.BaseClasses</a>. 
</p>
<p>
The overhang can be asymmetrical (i.e. <code>wR &ne; wL</code>) 
about the vertical centerline 
of the window.
The overhang must completely cover the window (i.e.,
<code>wL &ge; 0</code> and 
<code>wR &ge; 0</code>). 
<code>wL</code> and <code>wR</code> are measured from the left and right edge of the window.
</p>
<p>
The surface azimuth <code>azi</code> is as defined in 
<A HREF="Buildings_HeatTransfer_Types_Azimuth.html#Buildings.HeatTransfer.Types.Azimuth"
>
Buildings.HeatTransfer.Types.Azimuth</a>.
</p>
<h4>Implementation</h4>
<p>
The method of super position is used to calculate the window shaded area. 
The area below the overhang is divided as shown in the figure. 
</p>
<p align="center">
<img alt="image" src="../Resources/Images/HeatTransfer/Windows/BaseClasses/OverhangSuperPosition.png" />
</p>
<p>
Dimensional variables used in code for the rectangle <i>DEGI, AEGH, CFGI</i> and <i>BFGH</i>
are shown in the figure below:
</p>
<p align="center">
<img alt="image" src="../Resources/Images/HeatTransfer/Windows/BaseClasses/OverhangVariables.png" />
</p>
<p>
The rectangles <i>DEGI, AEGH, CFGI</i> and <i>BFGH</i> have the same geometric configuration 
with respect to the overhang.
Thus, the same algorithm can be used to calculate the shaded portion in these areas. 
A single equation in the <code>for</code> loop improves the total calculation time, 
as compared to <code>if-then-else</code> 
conditions, considering the various shapes of the shaded portions. 
To find the shaded area in window <i>ABCD</i>, the shaded portion of <i>AEGD</i> and <i>CFGI</i> 
should be subtracted from that of <i>DEGI</i> and <i>BFGH</i>.
This shaded area of the window is then divided by the total window area 
to calculate the shaded fraction of the window. 
</p>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A> (Basic graphical layout of input/output block), <A HREF="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.Overhang"
>Buildings.Rooms.BaseClasses.Overhang</A> (Record for window overhang).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>lat</TD><TD>&nbsp;</TD><TD>Latitude [rad]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>azi</TD><TD>&nbsp;</TD><TD>Surface azimuth; azi= -90 degree East; azi= 0 degree South [rad]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Overhang</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wL</TD><TD>&nbsp;</TD><TD>Overhang width left to the window, measured from the window corner [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wR</TD><TD>&nbsp;</TD><TD>Overhang width right to the window, measured from the window corner [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>dep</TD><TD>&nbsp;</TD><TD>Overhang depth (measured perpendicular to the wall plane) [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>gap</TD><TD>&nbsp;</TD><TD>Distance between window upper edge and overhang lower edge [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Window</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hWin</TD><TD>&nbsp;</TD><TD>Window height [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wWin</TD><TD>&nbsp;</TD><TD>Window width [m]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>verAzi</TD><TD>Wall solar azimuth angle (angle between projection of sun&#39;s rays and normal to vertical surface) [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>alt</TD><TD>Altitude angle [rad]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>fraSun</TD><TD>Fraction of window area exposed to the sun [1]</TD></TR>
<TR><TD><A HREF="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Bus</A></TD><TD>weaBus</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> Overhang <font color="darkgreen">
  &quot;For a window with an overhang, outputs the fraction of the area that is sun exposed&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;
  <font color="blue">extends </font><A HREF="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.Overhang"
>Buildings.Rooms.BaseClasses.Overhang</A>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> verAzi(quantity=&quot;Angle&quot;, unit=&quot;rad&quot;, displayUnit=&quot;deg&quot;) <font color="darkgreen">
    &quot;Wall solar azimuth angle (angle between projection of sun&#39;s rays and normal to vertical surface)&quot;</font>;
    </textblock>

<textblock type="annotcomp" expanded="false">   <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> alt(
     quantity=&quot;Angle&quot;,
     unit=&quot;rad&quot;,
     displayUnit=&quot;deg&quot;) <font color="darkgreen">&quot;Altitude angle&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> fraSun(<font color="blue">final </font>min=0,
                                               <font color="blue">final </font>max=1,
                                               <font color="blue">final </font>unit=&quot;1&quot;) <font color="darkgreen">
    &quot;Fraction of window area exposed to the sun&quot;</font>;</textblock>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> lat <font color="darkgreen">&quot;Latitude&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> azi(displayUnit=&quot;deg&quot;) <font color="darkgreen">
    &quot;Surface azimuth; azi= -90 degree East; azi= 0 degree South&quot;</font>;

<font color="darkgreen">// Window dimensions</font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> hWin <font color="darkgreen">&quot;Window height&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> wWin <font color="darkgreen">&quot;Window width&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Buildings.BoundaryConditions.WeatherData.Bus</A> weaBus;</textblock>

<font color="blue">protected </font>
  <font color="blue">constant </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> delSolAzi = 0.005 <font color="darkgreen">
    &quot;Half-width of transition interval between left and right formulation for overhang&quot;</font>;

  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> AWin= hWin*wWin <font color="darkgreen">&quot;Window area&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> tmpH[4](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Height rectangular sections used for superposition&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> w <font color="darkgreen">
    &quot;Either wL or wR, depending on the sun relative to the wall azimuth&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> tmpW[4] <font color="darkgreen">
    &quot;Width of rectangular sections used for superpositions&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> del_L = wWin/100 <font color="darkgreen">
    &quot;Fraction of window dimension over which min-max functions are smoothened&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> x1 <font color="darkgreen">
    &quot;Horizontal distance between window side edge and shadow corner&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> x2[4] <font color="darkgreen">
    &quot;Horizontal distance between window side edge and point where shadow line and window lower edge intersects&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> y1 <font color="darkgreen">
    &quot;Vertical distance between overhang and shadow lower edge&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> y2[4] <font color="darkgreen">
    &quot;Window height (vertical distance corresponding to x2)&quot;</font>;
  Real shdwTrnglRtio <font color="darkgreen">&quot;ratio of y1 and x1&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> area[4] <font color="darkgreen">
    &quot;Shaded areas of the sections used in superposition&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> shdArea <font color="darkgreen">&quot;Shaded area calculated from equations&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> crShdArea <font color="darkgreen">&quot;Final value for shaded area&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> crShdArea1 <font color="darkgreen">
    &quot;Corrected for the sun behind the surface/wall&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> crShdArea2 <font color="darkgreen">&quot;Corrected for the sun below horizon&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_BoundaryConditions_SolarGeometry_BaseClasses.html#Buildings.BoundaryConditions.SolarGeometry.BaseClasses.SolarAzimuth"
>Buildings.BoundaryConditions.SolarGeometry.BaseClasses.SolarAzimuth</A> solAzi(lat=lat) <font color="darkgreen">
    &quot;Solar azimuth&quot;</font>;</textblock>

<font color="blue">initial </font><font color="blue">algorithm </font>
  <font color="red">assert</font>(wL &gt;= 0,  &quot;Overhang must cover complete window
    Received overhang width on left hand side, wL = &quot; +<font color="red"> String</font>(wL));
  <font color="red">assert</font>(wR &gt;= 0,  &quot;Overhang must cover complete window
    Received overhang width on right hand side, wR = &quot; +<font color="red"> String</font>(wR));

  <font color="blue">for </font>i<font color="blue"> in </font>1:4<font color="blue"> loop</font>
    tmpH[i] := gap +<font color="red"> mod</font>((i - 1), 2)*hWin;
  <font color="blue">end for</font>;

<font color="blue">equation </font>
  <font color="darkgreen">// if dep=0, then the equation</font>
  <font color="darkgreen">//   y1*Modelica.Math.cos(verAzi) = dep*Modelica.Math.tan(alt);</font>
  <font color="darkgreen">// is singular. Hence, we treat this special case with an</font>
  <font color="darkgreen">// if-then construct.</font>
  <font color="darkgreen">// This also increases computing efficiency in</font>
  <font color="darkgreen">// Buildings.HeatTransfer.Windows.FixedShade in case the window has no overhang.</font>

  <font color="blue">if </font>haveOverhang<font color="blue"> then</font>
    <font color="darkgreen">//Temporary height and widths are for the areas below the overhang</font>
    <font color="darkgreen">//These areas are used in superposition</font>
    w =<font color="red"> Buildings.Utilities.Math.Functions.spliceFunction</font>(
            pos=wL,
            neg=wR,
            x=solAzi.solAzi-azi,
            deltax=delSolAzi);
    tmpW[1] = w + wWin;
    tmpW[2] = w;
    tmpW[3] = w;
    tmpW[4] = w + wWin;

    y1*<font color="red">Modelica.Math.cos</font>(verAzi) = dep*<font color="red">Modelica.Math.tan</font>(alt);
    x1 = dep*<font color="red">Modelica.Math.tan</font>(verAzi);
    shdwTrnglRtio*x1 = y1;
    <font color="blue">for </font>i<font color="blue"> in </font>1:4<font color="blue"> loop</font>
      y2[i] = tmpH[i];
      x2[i]*y1 = x1*tmpH[i];
      area[i] =<font color="red"> Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=y1,
        x2=y2[i],
          deltaX=del_L)*tmpW[i] - (<font color="red">Buildings.Utilities.Math.Functions.smoothMin</font>(
        y1,
        tmpH[i],
        del_L)*<font color="red">Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=x2[i],
        x2=y1,
        deltaX=del_L)/2) +<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
        x1=shdwTrnglRtio*(<font color="red">Buildings.Utilities.Math.Functions.smoothMin</font>(
          x1=x1,
          x2=x2[i],
          deltaX=del_L) - tmpW[i]),
        x2=0,
        deltaX=del_L)*<font color="red">Buildings.Utilities.Math.Functions.smoothMax</font>(
        x1=(<font color="red">Buildings.Utilities.Math.Functions.smoothMin</font>(
          x1=x1,
          x2=x2[i],
          deltaX=del_L) - tmpW[i]),
        x2=0,
        deltaX=del_L)/2;
    <font color="blue">end for</font>;
    shdArea = area[4] + area[3] - area[2] - area[1];
  <font color="darkgreen">// correction case: Sun not in front of the wall</font>
    crShdArea1 =<font color="red"> Buildings.Utilities.Math.Functions.spliceFunction</font>(
      pos=shdArea,
      neg=AWin,
      x=(Modelica.Constants.pi/2)-verAzi,
      deltax=0.01);
  <font color="darkgreen">// correction case: Sun not above horizon</font>
    crShdArea2 =<font color="red"> Buildings.Utilities.Math.Functions.spliceFunction</font>(
      pos=shdArea,
      neg=AWin,
      x=alt,
      deltax=0.01);
    crShdArea=<font color="red">Buildings.Utilities.Math.Functions.smoothMax</font>(x1=crShdArea1,
                                                           x2=crShdArea2,
                                                           deltaX=0.01);
    fraSun =<font color="red"> Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=<font color="red">Buildings.Utilities.Math.Functions.smoothMax</font>(x1=1-crShdArea/AWin,x2=0,deltaX=0.01),
        x2=1.0,
        deltaX=0.01);
  <font color="blue">else</font>
    w = 0;
    tmpW=<font color="red">fill</font>(0.0, 4);
    y1 = 0;
    x1 = 0;
    shdwTrnglRtio = 0;
    <font color="blue">for </font>i<font color="blue"> in </font>1:4<font color="blue"> loop</font>
      y2[i] = 0;
      x2[i] = 0;
      area[i] = 0;
    <font color="blue">end for</font>;
    shdArea = 0;
    crShdArea1 = 0;
    crShdArea2 = 0;
    crShdArea  = 0;
    fraSun     = 0;
   <font color="blue">end if</font>;

<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(weaBus.solTim, solAzi.solTim);
  <font color="red">connect</font>(weaBus.sol.zen, solAzi.zen);
  <font color="red">connect</font>(weaBus.sol.dec, solAzi.decAng);</textblock>

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>Overhang;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ThermalConductor<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi10948b5c7db343c9uctorI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ThermalConductor" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.ThermalConductor"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.ThermalConductor</H2>
<B>Lumped thermal element with variable area, transporting heat without storing it</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi10948b5c7db343c9uctorD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ThermalConductor">
<P></P><H3>Information</H3>

<p>
This is a model for transport of heat without storing it.
It is identical to the thermal conductor from the Modelica Standard Library,
except that it adds an input signal <code>u</code>.
<pre>
</PRE><P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.Element1D"
>Modelica.Thermal.HeatTransfer.Interfaces.Element1D</A> (Partial heat transfer element with two HeatPort connectors that does not store energy), <A HREF="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIconLow"
>Buildings.BaseClasses.BaseIconLow</A> (Base icon with model name below the icon).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>ThermalConductance</A></TD><TD>G</TD><TD>&nbsp;</TD><TD>Constant thermal conductance of material [W/K]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>u</TD><TD>Input signal for thermal conductance</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ThermalConductor <font color="darkgreen">
  &quot;Lumped thermal element with variable area, transporting heat without storing it&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.Element1D"
>Modelica.Thermal.HeatTransfer.Interfaces.Element1D</A>;
  <font color="blue">extends </font><A HREF="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIconLow"
>Buildings.BaseClasses.BaseIconLow</A>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</A> G <font color="darkgreen">
    &quot;Constant thermal conductance of material&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u(min=0) <font color="darkgreen">
    &quot;Input signal for thermal conductance&quot;</font>;</textblock>
<font color="blue">equation </font>
  Q_flow = u*G*dT;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ThermalConductor;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ShadeConvection<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi29da9fcfc6b972d6ctionI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeConvection" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.ShadeConvection"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.ShadeConvection</H2>
<B>Model for convective heat balance of a layer that may or may not have a shade</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi29da9fcfc6b972d6ctionD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeConvection">
<P></P><H3>Information</H3>

<p>
Model for the convective heat balance 
of a shade that is in the outside or the room-side of a window.
</p>
<p>
The convective heat balance is based on the model described by Wright (2008), which can
be shown as a convective heat resistance model as follows:
</p>
<p align="center">
<img alt="image" src="../Resources/Images/HeatTransfer/Windows/BaseClasses/convection.png" border="1"/>
</p>
<p>
Wright (2008) reports that if the shading layer is far enough from the window,
the boundary layers associated with each surface will not interfere with
each other. In this case, it is reasonable to consider each surface on an 
individual basis by setting the convective heat transfer coefficient shown in grey to zero,
and setting the black depicted convective heat transfer coefficients
to <i>h=4 W/m<sup>2</sup> K</i>.
In the here implemented model, the grey depicted convective heat transfer coefficient
is set set to <i>h' = k &nbsp; h</i>, where <i>0 &le; k &le; 1</i> is a parameter.
</p>
<h4>References</h4>
<ul>
<li>
Jon L. Wright.<br/>
Calculating Center-Glass Performance Indices
of Glazing Systems with Shading Devices.<br/>
<i>ASHRAE Transactions</i>, SL-08-020. 2008.
</li>
</ul>
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
<TR><TD>Boolean</TD><TD>thisSideHasShade</TD><TD>&nbsp;</TD><TD>Set to true if this side of the window has a shade</TD></TR>
<TR><TD>Real</TD><TD>k</TD><TD>1</TD><TD>Coefficient used to scale convection between shade and glass</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>Gc</TD><TD>Signal representing the convective thermal conductance [W/K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>air</TD><TD>Port that connects to the air (room or outside)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>glass</TD><TD>Heat port that connects to shaded part of glass</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>QRadAbs_flow</TD><TD>Total net radiation that is absorbed by the shade (positive if absorbed) [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>TSha</TD><TD>Shade temperature [K]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ShadeConvection <font color="darkgreen">
  &quot;Model for convective heat balance of a layer that may or may not have a shade&quot;</font>

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;
  <font color="blue">parameter </font>Boolean thisSideHasShade <font color="darkgreen">
    &quot;Set to true if this side of the window has a shade&quot;</font>;

  <font color="blue">parameter </font>Real k(min=0, max=1)=1 <font color="darkgreen">
    &quot;Coefficient used to scale convection between shade and glass&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> Gc(unit=&quot;W/K&quot;) <font color="darkgreen">
    &quot;Signal representing the convective thermal conductance&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> air <font color="darkgreen">
    &quot;Port that connects to the air (room or outside)&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> glass <font color="darkgreen">
    &quot;Heat port that connects to shaded part of glass&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> QRadAbs_flow(unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Total net radiation that is absorbed by the shade (positive if absorbed)&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> TSha(quantity=&quot;ThermodynamicTemperature&quot;,
      unit=&quot;K&quot;) <font color="darkgreen">&quot;Shade temperature&quot;</font>;</textblock>
<font color="blue">equation </font>
  <font color="blue">if </font>thisSideHasShade<font color="blue"> then</font>
    <font color="darkgreen">// Convective heat balance of shade.</font>
    <font color="darkgreen">// The term 2*Gc is to combine the parallel convective heat transfer resistances,</font>
    <font color="darkgreen">// see figure in info section.</font>
 <font color="darkgreen">//   2*(air.T-TSha) = k*(glass.T-TSha);</font>
    <font color="darkgreen">// Convective heat flow at air node</font>
    air.Q_flow   = Gc*(2*(air.T-TSha) + (air.T-glass.T));
    <font color="darkgreen">// Convective heat flow at glass node</font>
    glass.Q_flow = Gc*((glass.T-air.T)+k*(glass.T-TSha));
    air.Q_flow + glass.Q_flow + QRadAbs_flow = 0;
  <font color="blue">else</font>
    air.Q_flow   = Gc*(air.T-glass.T);
    air.Q_flow + glass.Q_flow = 0;
    TSha = (air.T+glass.T)/2;
  <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ShadeConvection;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ShadeRadiation<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi785e6b84187e2e26ationI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeRadiation" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.ShadeRadiation"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.ShadeRadiation</H2>
<B>Model for infrared radiative heat balance of a layer that may or may not have a shade</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi785e6b84187e2e26ationD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeRadiation">
<P></P><H3>Information</H3>

<p>
Model for the infrared radiative heat balance 
of a shade that is at the outside or the room-side of a window.
The model also includes the absorbed solar radiation.
</p>
<p>
The input port <code>QAbs_flow</code> needs to be connected to the solar radiation 
that is absorbed by the shade.
</p>
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</A></TD><TD>absIR_air</TD><TD>&nbsp;</TD><TD>Infrared absorptivity of surface that faces air [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</A></TD><TD>absIR_glass</TD><TD>&nbsp;</TD><TD>Infrared absorptivity of surface that faces glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauIR_air</TD><TD>&nbsp;</TD><TD>Infrared transmissivity of shade for radiation coming from the exterior or the room [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauIR_glass</TD><TD>&nbsp;</TD><TD>Infrared transmissivity of shade for radiation coming from the glass [1]</TD></TR>
<TR><TD>Boolean</TD><TD>thisSideHasShade</TD><TD>&nbsp;</TD><TD>Set to true if this side of the window has a shade</TD></TR>
<TR><TD>Boolean</TD><TD>linearize</TD><TD>false</TD><TD>Set to true to linearize emissive power</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T0</TD><TD>293.15</TD><TD>Temperature used to linearize radiative heat transfer [K]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD>Boolean</TD><TD>homotopyInitialization</TD><TD>true</TD><TD>= true, use homotopy method</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>u</TD><TD>Input connector, used to scale the surface area to take into account an operable shading device</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>QSolAbs_flow</TD><TD>Solar radiation absorbed by shade [W]</TD></TR>
<TR><TD>input <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</A></TD><TD>JIn_air</TD><TD>Incoming radiosity at the air-side surface of the shade [W]</TD></TR>
<TR><TD>input <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</A></TD><TD>JIn_glass</TD><TD>Incoming radiosity at the glass-side surface of the shade [W]</TD></TR>
<TR><TD>output <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</A></TD><TD>JOut_air</TD><TD>Outgoing radiosity at the air-side surface of the shade [W]</TD></TR>
<TR><TD>output <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</A></TD><TD>JOut_glass</TD><TD>Outgoing radiosity at the glass-side surface of the shade [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QRadAbs_flow</TD><TD>Total net radiation that is absorbed by the shade (positive if absorbed) [W]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>TSha</TD><TD>Shade temperature [K]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ShadeRadiation <font color="darkgreen">
  &quot;Model for infrared radiative heat balance of a layer that may or may not have a shade&quot;</font>

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</A> absIR_air <font color="darkgreen">
    &quot;Infrared absorptivity of surface that faces air&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</A> absIR_glass <font color="darkgreen">
    &quot;Infrared absorptivity of surface that faces glass&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</A> tauIR_air <font color="darkgreen">
    &quot;Infrared transmissivity of shade for radiation coming from the exterior or the room&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</A> tauIR_glass <font color="darkgreen">
    &quot;Infrared transmissivity of shade for radiation coming from the glass&quot;</font>;
  <font color="blue">parameter </font>Boolean thisSideHasShade <font color="darkgreen">
    &quot;Set to true if this side of the window has a shade&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>Modelica.SIunits.ReflectionCoefficient</A> rhoIR_air=1-absIR_air-tauIR_air <font color="darkgreen">
    &quot;Infrared reflectivity of surface that faces air&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>Modelica.SIunits.ReflectionCoefficient</A> rhoIR_glass=1-absIR_glass-tauIR_glass <font color="darkgreen">
    &quot;Infrared reflectivity of surface that faces glass&quot;</font>;
  <font color="blue">parameter </font>Boolean linearize = false <font color="darkgreen">&quot;Set to true to linearize emissive power&quot;</font>;
  <font color="blue">parameter </font>Boolean homotopyInitialization = true <font color="darkgreen">&quot;= true, use homotopy method&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T0=293.15 <font color="darkgreen">
    &quot;Temperature used to linearize radiative heat transfer&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u <font color="darkgreen">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device&quot;</font>;
    </textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> QSolAbs_flow(unit=&quot;W&quot;, quantity=&quot;Power&quot;) <font color="darkgreen">
    &quot;Solar radiation absorbed by shade&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>Interfaces.RadiosityInflow</A> JIn_air(start=A*0.8*Modelica.Constants.sigma*293.15^4) <font color="darkgreen">
    &quot;Incoming radiosity at the air-side surface of the shade&quot;</font>;
  <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>Interfaces.RadiosityInflow</A> JIn_glass(start=A*0.8*Modelica.Constants.sigma*293.15^4) <font color="darkgreen">
    &quot;Incoming radiosity at the glass-side surface of the shade&quot;</font>;
  <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>Interfaces.RadiosityOutflow</A> JOut_air <font color="darkgreen">
    &quot;Outgoing radiosity at the air-side surface of the shade&quot;</font>;
  <A HREF="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>Interfaces.RadiosityOutflow</A> JOut_glass <font color="darkgreen">
    &quot;Outgoing radiosity at the glass-side surface of the shade&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false"> <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QRadAbs_flow(unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Total net radiation that is absorbed by the shade (positive if absorbed)&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> TSha(quantity=&quot;ThermodynamicTemperature&quot;,
      unit=&quot;K&quot;,
      start=293.15) <font color="blue">if </font>
         thisSideHasShade <font color="darkgreen">&quot;Shade temperature&quot;</font>;</textblock>

<font color="blue">protected </font>
   <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> TSha_internal(quantity=&quot;ThermodynamicTemperature&quot;,
      unit=&quot;K&quot;,
      start=293.15) <font color="darkgreen">&quot;Internal connector for shade temperature&quot;</font>;

 <font color="blue">final </font><font color="blue">parameter </font>Real T03(min=0, <font color="blue">final </font>unit=&quot;K3&quot;)=T0^3 <font color="darkgreen">
    &quot;3rd power of temperature T0&quot;</font>;
 Real T4(min=1E8, start=293.15^4, nominal=1E10, <font color="blue">final </font>unit=&quot;K4&quot;) <font color="darkgreen">
    &quot;4th power of temperature&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.RadiantPower"
>Modelica.SIunits.RadiantPower</A> E_air <font color="darkgreen">&quot;Emissive power of surface that faces air&quot;</font>;
 <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.RadiantPower"
>Modelica.SIunits.RadiantPower</A> E_glass <font color="darkgreen">
    &quot;Emissive power of surface that faces glass&quot;</font>;
<font color="blue">equation </font>
  <font color="red">connect</font>(TSha_internal, TSha);
  <font color="blue">if </font>thisSideHasShade<font color="blue"> then</font>
  <font color="darkgreen">// Radiosities that are outgoing from the surface, which are</font>
  <font color="darkgreen">// equal to the infrared absorptivity plus the reflected incoming</font>
  <font color="darkgreen">// radiosity plus the radiosity that is transmitted from the</font>
  <font color="darkgreen">// other surface.</font>
    <font color="blue">if </font>linearize<font color="blue"> then</font>
      T4 = T03 * TSha_internal;
    <font color="blue">else</font>
      <font color="blue">if </font>homotopyInitialization<font color="blue"> then</font>
        T4 =<font color="red"> homotopy</font>(actual=(TSha_internal)^4, simplified=T03 * TSha_internal);
      <font color="blue">else</font>
        T4 = TSha_internal^4;
      <font color="blue">end if</font>;
    <font color="blue">end if</font>;

    E_air   = u * A * absIR_air   * Modelica.Constants.sigma * T4;
    E_glass = u * A * absIR_glass * Modelica.Constants.sigma * T4;
    <font color="darkgreen">// Radiosity outgoing from shade towards air side and glass side</font>
    JOut_air   = E_air   + tauIR_glass * JIn_glass + rhoIR_air*JIn_air;
    JOut_glass = E_glass + tauIR_air   * JIn_air   + rhoIR_glass*JIn_glass;
    <font color="darkgreen">// Radiative heat balance of shade.</font>
    QSolAbs_flow + absIR_air*JIn_air + absIR_glass*JIn_glass
      = E_air+E_glass+QRadAbs_flow;
  <font color="blue">else</font>
    QRadAbs_flow = 0;
    T4 = T03 * T0;
    E_air = 0;
    E_glass = 0;
    JOut_air = JIn_glass;
    JOut_glass = JIn_air;
    TSha_internal = T0;
  <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ShadeRadiation;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ShadeInterface_weatherBus<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi0027dbf7b84a234cerBusI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.ShadeInterface_weatherBus</H2>
<B>Base class for models of window shade and overhangs</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi0027dbf7b84a234cerBusD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus">
<P></P><H3>Information</H3>

<p>
Partial model to implement overhang and side fin model with weather bus as a connector.
</p>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A> (Basic graphical layout of input/output block).
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Bus</A></TD><TD>weaBus</TD><TD>Weather data bus</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>incAng</TD><TD>Solar incidence angle [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDirTilUns</TD><TD>Direct solar irradiation on tilted, unshaded surface [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>HDirTil</TD><TD>Direct solar irradiation on tilted, shaded surface [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>fraSun</TD><TD>Fraction of the area that is unshaded [1]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> ShadeInterface_weatherBus <font color="darkgreen">
  &quot;Base class for models of window shade and overhangs&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Buildings.BoundaryConditions.WeatherData.Bus</A> weaBus <font color="darkgreen">&quot;Weather data bus&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> incAng(quantity=&quot;Angle&quot;,
                                              unit=&quot;rad&quot;,
                                              displayUnit=&quot;rad&quot;) <font color="darkgreen">
    &quot;Solar incidence angle&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> HDirTilUns(
                         quantity=&quot;RadiantEnergyFluenceRate&quot;,
                         unit=&quot;W/m2&quot;) <font color="darkgreen">
    &quot;Direct solar irradiation on tilted, unshaded surface&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> HDirTil(
                         quantity=&quot;RadiantEnergyFluenceRate&quot;,
                         unit=&quot;W/m2&quot;) <font color="darkgreen">
    &quot;Direct solar irradiation on tilted, shaded surface&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> fraSun(<font color="blue">final </font>min=0,
                                               <font color="blue">final </font>max=1,
                                               <font color="blue">final </font>unit=&quot;1&quot;) <font color="darkgreen">
    &quot;Fraction of the area that is unshaded&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ShadeInterface_weatherBus;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ShadingSignal<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi5d45a82eafc09590ignalI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.ShadingSignal</H2>
<B>Converts the shading signal to be strictly bigger than 0 and smaller than 1</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi5d45a82eafc09590ignalD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal">
<P></P><H3>Information</H3>

This model changes the shading control signal to avoid a singularity 
in the window model if the input signal is zero or one.
Since the window heat balance multiplies the area of the window by <code>u</code>
or by <code>1-u</code> (if a shade is present), the heat balance can be singular
for <code>u=0</code> or for <code>u=1</code>.
This model avoids this singularity by slightly changing the control signal.
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.SO"
>Modelica.Blocks.Interfaces.SO</A> (Single Output continuous control block).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>haveShade</TD><TD>&nbsp;</TD><TD>Set to true if a shade is present</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>y</TD><TD>Connector of Real output signal</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>u</TD><TD>Shading control signal, 0: unshaded; 1: fully shaded</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>yCom</TD><TD>1-u</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> ShadingSignal <font color="darkgreen">
  &quot;Converts the shading signal to be strictly bigger than 0 and smaller than 1&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.SO"
>Modelica.Blocks.Interfaces.SO</A>;
  <font color="blue">parameter </font>Boolean haveShade <font color="darkgreen">&quot;Set to true if a shade is present&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u <font color="blue">if </font>haveShade <font color="darkgreen">
    &quot;Shading control signal, 0: unshaded; 1: fully shaded&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> yCom <font color="darkgreen">&quot;1-u&quot;</font>;</textblock>
<font color="blue">protected </font>
  <font color="blue">constant </font>Real y0 = 1E-6 <font color="darkgreen">&quot;Smallest allowed value for y if a shade is present&quot;</font>;
  <font color="blue">constant </font>Real k = 1-2*y0 <font color="darkgreen">&quot;Gain for shading signal&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> u_in_internal <font color="darkgreen">
    &quot;Needed to connect to conditional connector&quot;</font>;
<font color="blue">equation </font>
  <font color="red">connect</font>(u, u_in_internal);
  <font color="blue">if </font><font color="blue">not </font>haveShade<font color="blue"> then</font>
    u_in_internal = 0;
  <font color="blue">end if</font>;
  <font color="blue">if </font>haveShade<font color="blue"> then</font>
    y = y0 + k *  u_in_internal;
    yCom = 1-y;
  <font color="blue">else</font>
    y = 0;
    yCom = 1;
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ShadingSignal;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SideFins<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wiedf561c37b577351eFinsI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.SideFins" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.SideFins"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.SideFins</H2>
<B>For a window with side fins, outputs the fraction of the area that is sun exposed</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wiedf561c37b577351eFinsD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.SideFins">
<P></P><H3>Information</H3>

<p>
For a window with side fins, this block outputs the fraction of 
the area that is exposed to the sun.
This models can also be used for doors with side fins. 
</p>
<p>
Input to this block are the 
wall solar azimuth angle and the altitude angle of the sun. 
These angles can be calculated using blocks from the package
<A HREF="Buildings_BoundaryConditions_SolarGeometry_BaseClasses.html#Buildings.BoundaryConditions.SolarGeometry.BaseClasses"
>
Buildings.BoundaryConditions.SolarGeometry.BaseClasses</a>. 
</p>

<h4>Limitations</h4>
<p>
The model assumes that
</p>
<ul>
<li>
the side fins are placed symmetrically to the left and right of the window,
</li>
<li> 
the top of the side fins must be at an equal or greater height than the window, and
</li>
<li>
the bottom of the side fins must be at an equal or lower height than the 
bottom of the window.
</li>
</ul>

<h4>Implementation</h4>
<p>
The method of super position is used to calculate the shaded area of the window. 
The area besides the side fin is divided as shown in the figure below. 
</p>
<p align="center">
<img alt="imaghe" src="../Resources/Images/HeatTransfer/Windows/BaseClasses/SideFinsSuperPosition.png" />
</p>

<p>
Variables used in the code for the rectangle <i>AEGI, BEGH, DFGI</i> and <i>CFGH</i> are shown in figure below.
</p>
<p align="center">
<img alt="imaghe" src="../Resources/Images/HeatTransfer/Windows/BaseClasses/SideFinsVariables.png" />
</p>

<p>
The rectangles <i>AEGI, BEGH, DFGI</i> and <i>CFGH</i>  have the same geometric configuration 
with respect to the side fin.
Thus, the same algorithm is used to calculate the shaded portion in these areas. 
A single equation in the <code>for</code> loop improves the total calculation time, 
as compared to <code>if-then-else</code> 
conditions, considering the various shapes of the shaded portions.
To find the shaded area in the window <i>ABCD</i>, the shaded portion of 
<i>BEGH</i> and <i>DFGI</i> is subtracted from <i>AEGI</i> and <i>CFGH</i>.
This shaded area of the window is then divided by the total window area 
to calculate the shaded fraction of the window.
</p>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A> (Basic graphical layout of input/output block), <A HREF="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SideFins"
>Buildings.Rooms.BaseClasses.SideFins</A> (Record for window side fins).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Side fin</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>h</TD><TD>&nbsp;</TD><TD>Height of side fin that extends above window, measured from top of window [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>dep</TD><TD>&nbsp;</TD><TD>Side fin depth (measured perpendicular to the wall plane) [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>gap</TD><TD>&nbsp;</TD><TD>Distance between side fin and window edge [m]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Window</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hWin</TD><TD>&nbsp;</TD><TD>Window height [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wWin</TD><TD>&nbsp;</TD><TD>Window width [m]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>alt</TD><TD>Solar altitude angle (angle between sun ray and horizontal surface) [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>verAzi</TD><TD>Angle between projection of sun&#39;s rays and normal to vertical surface [rad]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>fraSun</TD><TD>Fraction of window area exposed to the sun [1]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> SideFins <font color="darkgreen">
  &quot;For a window with side fins, outputs the fraction of the area that is sun exposed&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;
  <font color="blue">extends </font><A HREF="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SideFins"
>Buildings.Rooms.BaseClasses.SideFins</A>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> alt(quantity=&quot;Angle&quot;,
                                           unit=&quot;rad&quot;,
                                           displayUnit=&quot;deg&quot;) <font color="darkgreen">
    &quot;Solar altitude angle (angle between sun ray and horizontal surface)&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> verAzi(quantity=&quot;Angle&quot;,
                                              unit=&quot;rad&quot;,
                                              displayUnit=&quot;deg&quot;) <font color="darkgreen">
    &quot;Angle between projection of sun&#39;s rays and normal to vertical surface&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> fraSun(<font color="blue">final </font>min=0,
                                               <font color="blue">final </font>max=1,
                                               <font color="blue">final </font>unit=&quot;1&quot;) <font color="darkgreen">
    &quot;Fraction of window area exposed to the sun&quot;</font>;</textblock>
<font color="darkgreen">// Window dimensions</font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> hWin <font color="darkgreen">&quot;Window height&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> wWin <font color="darkgreen">&quot;Window width&quot;</font>;
<font color="darkgreen">// Other calculation variables</font>
<font color="blue">protected </font>
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> tmpH[4]=
                  {h+hWin, h, h+hWin, h} <font color="darkgreen">
    &quot;Height of rectangular sections used for superposition&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> tmpW[4]=
                  {gap + wWin,gap + wWin,gap, gap} <font color="darkgreen">
    &quot;Width of rectangular sections used for superpositions; c1,c2 etc&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> deltaL=wWin/100 <font color="darkgreen">
    &quot;Fraction of window dimension over which min-max functions are smoothened&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> AWin=hWin*wWin <font color="darkgreen">&quot;Window area&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> x1[4] <font color="darkgreen">
    &quot;Horizontal distance between side fin and point where shadow line and window lower edge intersects&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> x2 <font color="darkgreen">
    &quot;Horizontal distance between side fin and shadow corner&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> x3[4] <font color="darkgreen">&quot;Window width&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> y1[4] <font color="darkgreen">&quot;Window height&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> y2 <font color="darkgreen">
    &quot;Vertical distance between window upper edge and shadow corner&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> y3[4] <font color="darkgreen">
    &quot;Vertical distance between window upper edge and point where shadow line and window side edge intersects&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> area[4] <font color="darkgreen">
    &quot;Shaded areas of the sections used in superposition&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> shdArea <font color="darkgreen">&quot;Shaded area&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> crShdArea <font color="darkgreen">&quot;Final value of shaded area&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> crShdArea1 <font color="darkgreen">
    &quot;Shaded area, corrected for the sun behind the surface/wall&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> crShdArea2 <font color="darkgreen">
    &quot;Shaded area, corrected for the sun below horizon&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> minX[4];
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> minY[4];
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> minX2X3[4];
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> minY2Y3[4];
  Real delta=1e-6 <font color="darkgreen">&quot;Small number to avoid division by zero&quot;</font>;
  Real tanLambda <font color="darkgreen">
    &quot;Tangent of angle between horizontal and sun ray projection on vertical wall&quot;</font>;
  Real verAzi_t;
  Real lambda_t;
  Real verAzi_c;
  Real alt_t;
<font color="blue">initial </font><font color="blue">algorithm </font>
  <font color="red">assert</font>(h &gt;= 0, &quot;Sidefin parameter &#39;h&#39; must be at least zero.
  It is measured from the upper edge of the window to the top of the side fin.
  Received h = &quot; +<font color="red"> String</font>(h));
<font color="blue">equation </font>
  <font color="darkgreen">// This if-then construct below increases computing efficiency in</font>
  <font color="darkgreen">// Buildings.HeatTransfer.Windows.FixedShade in case the window has no overhang.</font>
  <font color="blue">if </font>haveSideFins<font color="blue"> then</font>
  <font color="darkgreen">//avoiding division by zero</font>
    lambda_t =<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
      x1=tanLambda,
      x2=delta,
      deltaX=delta/10);
    verAzi_t =<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
      x1=<font color="red">Modelica.Math.tan</font>(verAzi),
      x2=delta,
      deltaX=delta/10);
    verAzi_c =<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
      x1=<font color="red">Modelica.Math.cos</font>(verAzi),
      x2=delta,
      deltaX=delta/10);
    alt_t =<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
      x1=<font color="red">Modelica.Math.tan</font>(alt),
      x2=delta,
      deltaX=delta/10);
    tanLambda = alt_t / verAzi_t;
    y2 = dep*alt_t/verAzi_c;
    x2 = dep*verAzi_t;
    <font color="blue">for </font>i<font color="blue"> in </font>1:4<font color="blue"> loop</font>
      x1[i] = tmpH[i]/lambda_t;
      x3[i] = tmpW[i];
      y1[i] = tmpH[i];
      y3[i] = tmpW[i]*lambda_t;
      minX2X3[i] =<font color="red"> Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=x2,
        x2=x3[i],
        deltaX=deltaL);
      minX[i] =<font color="red"> Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=x1[i],
        x2=minX2X3[i],
        deltaX=deltaL);
      minY2Y3[i] =<font color="red"> Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=y2,
        x2=y3[i],
        deltaX=deltaL);
      minY[i] =<font color="red"> Buildings.Utilities.Math.Functions.smoothMin</font>(
        x1=y1[i],
        x2=minY2Y3[i],
        deltaX=deltaL);
      area[i] = tmpH[i]*minX[i] - minX[i]*minY[i]/2;
    <font color="blue">end for</font>;
  <font color="darkgreen">//by superposition</font>
    shdArea = area[1] + area[4] - area[2] - area[3];
    <font color="darkgreen">// The corrections below ensure that the shaded area is 1 if the</font>
    <font color="darkgreen">// sun is below the horizon or behind the wall.</font>
    <font color="darkgreen">// This correction is not required (because the direct solar irradiation</font>
    <font color="darkgreen">// will be zero in this case), but it leads to more realistic time series</font>
    <font color="darkgreen">// of this model.</font>
  <font color="darkgreen">//correction case: Sun not in front of the wall</font>
    crShdArea1 =<font color="red"> Buildings.Utilities.Math.Functions.spliceFunction</font>(
       pos=shdArea,
       neg=AWin,
       x=(Modelica.Constants.pi/2)-verAzi,
       deltax=0.01);
  <font color="darkgreen">//correction case: Sun below horizon</font>
    crShdArea2 =<font color="red"> Buildings.Utilities.Math.Functions.spliceFunction</font>(
       pos=shdArea,
       neg=AWin,
       x=alt,
       deltax=0.01);
    crShdArea=<font color="red">Buildings.Utilities.Math.Functions.smoothMax</font>(
       x1=crShdArea1,
       x2=crShdArea2,
       deltaX=0.0001*AWin);
    fraSun = 1-crShdArea/AWin;
  <font color="blue">else</font>
    lambda_t = 0;
    verAzi_t = 0;
    verAzi_c = 0;
    alt_t =    0;
    tanLambda = 0;
    y2 = 0;
    x2 = 0;
    x1 =<font color="red"> fill</font>(0.0, 4);
    x3 =<font color="red"> fill</font>(0.0, 4);
    y1 =<font color="red"> fill</font>(0.0, 4);
    y3 =<font color="red"> fill</font>(0.0, 4);
    minX2X3 =<font color="red"> fill</font>(0.0, 4);
    minX =<font color="red"> fill</font>(0.0, 4);
    minY2Y3 =<font color="red"> fill</font>(0.0, 4);
    minY =<font color="red"> fill</font>(0.0, 4);
    area =<font color="red"> fill</font>(0.0, 4);
    shdArea = 0;
    crShdArea1 = 0;
    crShdArea2 = 0;
    crShdArea  = 0;
    fraSun     = 0;
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>SideFins;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PartialWindowBoundaryCondition<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wifccc9208b989ed30itionI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialWindowBoundaryCondition" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.PartialWindowBoundaryCondition"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.PartialWindowBoundaryCondition</H2>
<B>Partial model for heat convection or radiation between a possibly shaded window that can be outside or inside the room</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wifccc9208b989ed30itionD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialWindowBoundaryCondition">
<P></P><H3>Information</H3>

<p>
Partial model for boundary conditions for convection and radiation for a window surface with or without shade,
that is outside or inside the room. 
</p>
<p>
This allows using the model as a base class for windows with inside shade, outside shade, or no shade.
</p>
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area of frame and window [m2]</TD></TR>
<TR><TD>Real</TD><TD>fFra</TD><TD>&nbsp;</TD><TD>Fraction of window frame divided by total window area</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shading</TD></TR>
<TR><TD>Boolean</TD><TD>haveExteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has exterior shade (at surface a)</TD></TR>
<TR><TD>Boolean</TD><TD>haveInteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has interior shade (at surface b)</TD></TR>
<TR><TD>Boolean</TD><TD>thisSideHasShade</TD><TD>&nbsp;</TD><TD>Set to true if this side of the model has a shade</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>uSha</TD><TD>Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>air</TD><TD>Port that connects to the air (room or outside)</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>glaUns</TD><TD>Heat port that connects to unshaded part of glass</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>glaSha</TD><TD>Heat port that connects to shaded part of glass</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>frame</TD><TD>Heat port at window frame</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> PartialWindowBoundaryCondition <font color="darkgreen">
  &quot;Partial model for heat convection or radiation between a possibly shaded window that can be outside or inside the room&quot;</font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> A <font color="darkgreen">&quot;Heat transfer area of frame and window&quot;</font>;
  <font color="blue">parameter </font>Real fFra <font color="darkgreen">&quot;Fraction of window frame divided by total window area&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> AFra = fFra * A <font color="darkgreen">&quot;Frame area&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> AGla = A-AFra <font color="darkgreen">&quot;Glass area&quot;</font>;

  <font color="blue">parameter </font>Boolean haveExteriorShade <font color="darkgreen">
    &quot;Set to true if window has exterior shade (at surface a)&quot;</font>;
  <font color="blue">parameter </font>Boolean haveInteriorShade <font color="darkgreen">
    &quot;Set to true if window has interior shade (at surface b)&quot;</font>;

  <font color="blue">final </font><font color="blue">parameter </font>Boolean haveShade = haveExteriorShade<font color="blue"> or </font>haveInteriorShade <font color="darkgreen">
    &quot;Set to true if window system has a shade&quot;</font>;
  <font color="blue">parameter </font>Boolean thisSideHasShade <font color="darkgreen">
    &quot;Set to true if this side of the model has a shade&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> uSha <font color="blue">if </font>haveShade <font color="darkgreen">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded&quot;</font>;
    </textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> air <font color="darkgreen">
    &quot;Port that connects to the air (room or outside)&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> glaUns <font color="darkgreen">
    &quot;Heat port that connects to unshaded part of glass&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> glaSha <font color="blue">if </font>haveShade <font color="darkgreen">
    &quot;Heat port that connects to shaded part of glass&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.Convection"
>Modelica.Thermal.HeatTransfer.Components.Convection</A> conWinUns <font color="darkgreen">
    &quot;Convection from unshaded part of window to outside or room air&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> frame <font color="darkgreen">
    &quot;Heat port at window frame&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.Convection"
>Modelica.Thermal.HeatTransfer.Components.Convection</A> conFra <font color="darkgreen">
    &quot;Convective heat transfer between air and frame&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false"><font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Product"
>Modelica.Blocks.Math.Product</A> proUns <font color="darkgreen">&quot;Product for unshaded part of window&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Product"
>Modelica.Blocks.Math.Product</A> proSha <font color="blue">if </font>haveShade <font color="darkgreen">
    &quot;Product for shaded part of window&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal"
>ShadingSignal</A> shaSig(<font color="blue">final </font>haveShade=haveShade) <font color="darkgreen">
    &quot;Conversion for shading signal&quot;</font>;</textblock>
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="red">assert</font>(( thisSideHasShade<font color="blue"> and </font>haveShade)<font color="blue">  or </font>(<font color="blue">not </font>thisSideHasShade),
    &quot;Parameters \&quot;thisSideHasShade\&quot; and \&quot;haveShade\&quot; are not consistent. Check parameters&quot;);


<font color="blue">equation </font>
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(conWinUns.fluid, air);</textblock>

<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(conFra.fluid, air);</textblock>

<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(conFra.solid, frame);
  <font color="red">connect</font>(glaUns, conWinUns.solid);
  <font color="red">connect</font>(proUns.y, conWinUns.Gc);
  <font color="red">connect</font>(uSha, shaSig.u);
  <font color="red">connect</font>(proSha.u2, shaSig.y);
  <font color="red">connect</font>(shaSig.yCom, proUns.u1);</textblock>

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>PartialWindowBoundaryCondition;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PartialRadiation<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wiea1882b884f884c9ationI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.PartialRadiation</H2>
<B>Partial model for variables and data used in radiation calculation</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wiea1882b884f884c9ationD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation">
<P></P><H3>Information</H3>

The model calculates solar absorbance on the window. 
The calculations follow the description in Wetter (2004), Appendix A.4.3.

<h4>References</h4>
<ul>
<li>
Michael Wetter.<br/>
<a href="http://simulationresearch.lbl.gov/wetter/download/mwdiss.pdf">
Simulation-based Building Energy Optimization</a>.<br/>
Dissertation. University of California at Berkeley. 2004.
</li>
</ul>
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A> (Basic graphical layout of input/output block), <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData"
>Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData</A> (Basic parameters for window radiation calculation).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>haveExteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an exterior shade</TD></TR>
<TR><TD>Boolean</TD><TD>haveInteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an interior shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>AWin</TD><TD>&nbsp;</TD><TD>Area of window [m2]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Glass</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of glass layers</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xGla[N]</TD><TD>&nbsp;</TD><TD>Thickness of glass [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauGlaSol[N]</TD><TD>&nbsp;</TD><TD>Solar transmissivity of glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_a[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface a (facing outside) [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_b[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface b (facing room-side) [1]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_a</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_b</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from glass-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_a</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_b</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from glass-side [1]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>uSha</TD><TD>Control signal for shading (0: unshaded; 1: fully shaded)</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDif</TD><TD>Diffussive solar radiation [W/m2]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>incAng</TD><TD>Incident angle [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDir</TD><TD>Direct solar radiation [W/m2]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">block</font> PartialRadiation <font color="darkgreen">
  &quot;Partial model for variables and data used in radiation calculation&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</A>;
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData"
>Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData</A>;

  <font color="darkgreen">////////////////// Parameters that are not used by RadiationData</font>
  <font color="blue">parameter </font>Boolean haveExteriorShade <font color="darkgreen">
    &quot;Set to true if window has an exterior shade&quot;</font>;
  <font color="blue">parameter </font>Boolean haveInteriorShade <font color="darkgreen">
    &quot;Set to true if window has an interior shade&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> AWin <font color="darkgreen">&quot;Area of window&quot;</font>;

  <font color="darkgreen">////////////////// Derived parameters</font>
  <font color="blue">final </font><font color="blue">parameter </font>Boolean haveShade=haveExteriorShade<font color="blue"> or </font>haveInteriorShade <font color="darkgreen">
    &quot;Set to true if window has a shade&quot;</font>;
<textblock type="annotcomp" expanded="false">  <font color="blue">final </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationData"
>Buildings.HeatTransfer.Windows.BaseClasses.RadiationData</A>
    radDat(
    <font color="blue">final </font>N=N,
    <font color="blue">final </font>tauGlaSol=tauGlaSol,
    <font color="blue">final </font>rhoGlaSol_a=rhoGlaSol_a,
    <font color="blue">final </font>rhoGlaSol_b=rhoGlaSol_b,
    <font color="blue">final </font>xGla=xGla,
    <font color="blue">final </font>tauShaSol_a=tauShaSol_a,
    <font color="blue">final </font>tauShaSol_b=tauShaSol_b,
    <font color="blue">final </font>rhoShaSol_a=rhoShaSol_a,
    <font color="blue">final </font>rhoShaSol_b=rhoShaSol_b) <font color="darkgreen">
    &quot;Optical properties of window for different irradiation angles&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> uSha(min=0, max=1) <font color="blue">if </font>haveShade <font color="darkgreen">
    &quot;Control signal for shading (0: unshaded; 1: fully shaded)&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> HDif(quantity=&quot;RadiantEnergyFluenceRate&quot;,
      unit=&quot;W/m2&quot;) <font color="darkgreen">&quot;Diffussive solar radiation&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> incAng(
    <font color="blue">final </font>quantity=&quot;Angle&quot;,
    <font color="blue">final </font>unit=&quot;rad&quot;,
    displayUnit=&quot;deg&quot;) <font color="darkgreen">&quot;Incident angle&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> HDir(quantity=&quot;RadiantEnergyFluenceRate&quot;,
      unit=&quot;W/m2&quot;) <font color="darkgreen">&quot;Direct solar radiation&quot;</font>;</textblock>

<font color="blue">protected </font>
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> uSha_internal(min=0, max=1) <font color="darkgreen">
    &quot;Control signal for shading (0: unshaded; 1: fully shaded)&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">/* Current model assumes that the window only has either an interior or exterior shade.
     Warn user if it has an interior and exterior shade. 
     Allowing both shades at the same time would require rewriting part of the model. */</font>
  <font color="red">assert</font>(<font color="blue">not </font>(haveExteriorShade<font color="blue"> and </font>haveInteriorShade),
    &quot;Window radiation model does not support an exterior and interior shade at the same time.&quot;);
<font color="blue">equation </font>
  <font color="darkgreen">// Connect statement for conditionally removed connector uSha</font>
  <font color="red">connect</font>(uSha, uSha_internal);
  <font color="blue">if </font>(<font color="blue">not </font>haveShade)<font color="blue"> then</font>
    uSha_internal = 0;
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>PartialRadiation;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PartialShade_weatherBus<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi482ac2bf230204b0erBusI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialShade_weatherBus" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.PartialShade_weatherBus"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.PartialShade_weatherBus</H2>
<B>Partial model to implement overhang and side fins with weather bus connector</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi482ac2bf230204b0erBusD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.PartialShade_weatherBus">
<P></P><H3>Information</H3>

<p>
Partial model to implement overhang and side fin model with weather bus as a connector.
</p>
<P></P>
Extends from <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus"
>Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus</A> (Base class for models of window shade and overhangs).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Window</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>hWin</TD><TD>&nbsp;</TD><TD>Window height [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>wWin</TD><TD>&nbsp;</TD><TD>Window width [m]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Bus</A></TD><TD>weaBus</TD><TD>Weather data bus</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>incAng</TD><TD>Solar incidence angle [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDirTilUns</TD><TD>Direct solar irradiation on tilted, unshaded surface [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>HDirTil</TD><TD>Direct solar irradiation on tilted, shaded surface [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>fraSun</TD><TD>Fraction of the area that is unshaded [1]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> PartialShade_weatherBus <font color="darkgreen">
  &quot;Partial model to implement overhang and side fins with weather bus connector&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus"
>Buildings.HeatTransfer.Windows.BaseClasses.ShadeInterface_weatherBus</A>;
  <font color="darkgreen">// Window dimensions</font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> hWin <font color="darkgreen">&quot;Window height&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> wWin <font color="darkgreen">&quot;Window width&quot;</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">protected </font>
  <A HREF="Buildings_BoundaryConditions_SolarGeometry_BaseClasses.html#Buildings.BoundaryConditions.SolarGeometry.BaseClasses.WallSolarAzimuth"
>Buildings.BoundaryConditions.SolarGeometry.BaseClasses.WallSolarAzimuth</A> walSolAzi <font color="darkgreen">
    &quot;Wall solar azimuth&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Product"
>Modelica.Blocks.Math.Product</A> product;</textblock>

<font color="blue">equation </font>
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(weaBus.sol.alt, walSolAzi.alt);
  <font color="red">connect</font>(walSolAzi.incAng, incAng);
  <font color="red">connect</font>(product.y, HDirTil);
  <font color="red">connect</font>(product.u1, HDirTilUns);</textblock>
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>PartialShade_weatherBus;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TransmittedRadiation<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wid0ddea1e04aca6a7ationI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.TransmittedRadiation</H2>
<B>Transmitted radiation through window</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wid0ddea1e04aca6a7ationD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation">
<P></P><H3>Information</H3>

The model calculates solar radiation through the window. 
The calculations follow the description in Wetter (2004), Appendix A.4.3.
<br/>

The transmitted exterior radiation for window system includes:<br/>
<ol>
<li>
the transmitted diffusive radiation on unshaded part: <code>AWin*(1-uSha)*HDif*tau(HEM)</code>
</li>
<li>
the transmitted direct radiation on no shade part: <code>AWin*(1-uSha)*HDir*tau(IncAng)</code>
</li>
<li>
the transmitted diffusive radiation on shaded part: <code>AWin*uSha*HDif*tauSha(HEM)</code>
</li>
<li>
the transmitted direct radiation on shaded part: <code>AWin*uSha*HDir*tauSha(IncAng);</code>
</li>
</ol>
The output is <code>QTra_flow = Part1 + Part2 + Part3 + Part4</code>

<h4>References</h4>
<ul>
<li>
Michael Wetter.<br/>
<a href="http://simulationresearch.lbl.gov/wetter/download/mwdiss.pdf">
Simulation-based Building Energy Optimization</a>.<br/>
Dissertation. University of California at Berkeley. 2004.
</li>
</ul>
<P></P>
Extends from <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation</A> (Partial model for variables and data used in radiation calculation).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>haveExteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an exterior shade</TD></TR>
<TR><TD>Boolean</TD><TD>haveInteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an interior shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>AWin</TD><TD>&nbsp;</TD><TD>Area of window [m2]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Glass</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of glass layers</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xGla[N]</TD><TD>&nbsp;</TD><TD>Thickness of glass [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauGlaSol[N]</TD><TD>&nbsp;</TD><TD>Solar transmissivity of glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_a[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface a (facing outside) [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_b[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface b (facing room-side) [1]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_a</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_b</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from glass-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_a</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_b</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from glass-side [1]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>uSha</TD><TD>Control signal for shading (0: unshaded; 1: fully shaded)</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDif</TD><TD>Diffussive solar radiation [W/m2]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>incAng</TD><TD>Incident angle [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDir</TD><TD>Direct solar radiation [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QTra_flow</TD><TD>Transmitted exterior radiation through the window. (1: no shade; 2: shade) [W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> TransmittedRadiation <font color="darkgreen">&quot;Transmitted radiation through window&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation</A>;
<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QTra_flow(<font color="blue">final </font>quantity=&quot;Power&quot;,
      <font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Transmitted exterior radiation through the window. (1: no shade; 2: shade)&quot;</font>;</textblock>
  <font color="blue">final </font><font color="blue">parameter </font>Real traCoeRoo(fixed=false) <font color="darkgreen">
    &quot;Transmitivity of the window glass for interior radiation without shading&quot;</font>;

  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> QTraUns_flow <font color="darkgreen">
    &quot;Transmitted solar radiation through unshaded part of window&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> QTraSha_flow <font color="darkgreen">
    &quot;Transmitted solar radiation through shaded part of window&quot;</font>;

<font color="blue">protected </font>
  Integer k=1;
  Real x;
  <font color="blue">final </font><font color="blue">parameter </font>Integer NDIR=radDat.NDIR;
  <font color="blue">final </font><font color="blue">parameter </font>Integer HEM=radDat.HEM;
  <font color="blue">constant </font>Integer NoShade=1;
  <font color="blue">constant </font>Integer Shade=2;
  <font color="blue">constant </font>Integer Interior=1;
  <font color="blue">constant </font>Integer Exterior=2;
  <font color="blue">final </font><font color="blue">parameter </font>Real coeTraWinExtIrr[2, radDat.HEM + 2](fixed=false);
  Real tmpNoSha;
  Real tmpSha;
  Real incAng2;

<font color="blue">initial </font><font color="blue">algorithm </font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Assign coefficients.</font>
  <font color="darkgreen">// Data dimension from Orginal ([1 : HEM]) to New ([2 : HEM+1])</font>
  <font color="darkgreen">// with 2 dummy variable for interpolation.</font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Glass</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:HEM<font color="blue"> loop</font>
    <font color="darkgreen">// Properties for glass without shading</font>
    coeTraWinExtIrr[NoShade, j + 1] := radDat.traRef[1, 1, N, j];
    <font color="darkgreen">// Properties for glass with shading</font>
    <font color="blue">if </font>haveInteriorShade<font color="blue"> then</font>
      coeTraWinExtIrr[Shade, j + 1] := radDat.winTraExtIrrIntSha[j];
    <font color="blue">elseif </font>haveExteriorShade<font color="blue"> then</font>
      coeTraWinExtIrr[Shade, j + 1] := radDat.winTraExtIrrExtSha[j];
    <font color="blue">else</font>
      <font color="darkgreen">// No Shade</font>
      coeTraWinExtIrr[Shade, j + 1] := 0.0;
    <font color="blue">end if</font>;
  <font color="blue">end for</font>;
  <font color="darkgreen">// Dummy variables at 1 and HEM+2</font>
  <font color="blue">for </font>k<font color="blue"> in </font>NoShade:Shade<font color="blue"> loop</font>
    coeTraWinExtIrr[k, 1] := coeTraWinExtIrr[k, 2];
    coeTraWinExtIrr[k, HEM + 2] := coeTraWinExtIrr[k, HEM + 1];
  <font color="blue">end for</font>;

  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Glass: transmissivity for interior irradiation</font>
  <font color="darkgreen">//**************************************************************</font>
  traCoeRoo := radDat.traRef[1, N, 1, HEM];

<font color="blue">algorithm </font>
  QTraUns_flow := AWin*HDif*(1 - uSha_internal)*coeTraWinExtIrr[NoShade, HEM +
    1];
  QTraSha_flow := AWin*HDif*uSha_internal*coeTraWinExtIrr[Shade, HEM + 1];

  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Glass, Device: add absorbed radiation (angular part) from exterior sources</font>
  <font color="darkgreen">//**************************************************************</font>
  <font color="darkgreen">// Use min() instead of if() to avoid event</font>
  incAng2 :=<font color="red"> min</font>(incAng, 0.5*Modelica.Constants.pi);
  x := 2*(NDIR - 1)*<font color="red">abs</font>(incAng2)/Modelica.Constants.pi <font color="darkgreen">
    &quot;x=(index-1)*incAng/(0.5pi), 0&lt;=x&lt;=NDIR-1&quot;</font>;
  x := x + 2;

  <font color="darkgreen">// Window unshaded parts: add transmitted radiation for angular radiation</font>
  tmpNoSha :=
    <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation</font>({
    coeTraWinExtIrr[NoShade, k] <font color="blue">for </font>k<font color="blue"> in </font>1:(HEM + 2)}, x);
  QTraUns_flow := QTraUns_flow + AWin*HDir*(1 - uSha_internal)*tmpNoSha;

  <font color="darkgreen">// Window shaded parts: add transmitted radiation for angular radiation</font>
  tmpSha :=<font color="red"> Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation</font>(
    {coeTraWinExtIrr[Shade, k] <font color="blue">for </font>k<font color="blue"> in </font>1:(HEM + 2)}, x);
  QTraSha_flow := QTraSha_flow + AWin*HDir*uSha_internal*tmpSha;

  <font color="darkgreen">// Assign quantities to output connectors</font>
  QTra_flow := QTraUns_flow + QTraSha_flow;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>TransmittedRadiation;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE WindowRadiation<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi0c894215aeb7cea8ationI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.WindowRadiation" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.WindowRadiation"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.WindowRadiation</H2>
<B>Calculation radiation for window</B><p></P>
<IMG SRC="Buildings.HeatTransfer.Wi0c894215aeb7cea8ationD.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.WindowRadiation">
<P></P><H3>Information</H3>

<p>
The model calculates solar radiation through the window. 
The calculations follow the description in Wetter (2004), Appendix A.4.3.
</p>
<p>
The absorbed radiation by exterior shades includes:
</p>
<ol>
<li>
the directly absorbed exterior radiation: <code>AWin*uSha*(HDir+HDif)*(1-tau-rho)</code>
</li>
<li>
the indirectly absorbed exterior radiantion from reflection (angular part): <code>AWin*uSha*HDir*tau*rho(IncAng)*(1-tau-rho)</code>
</li>
<li>
the indirectly absorbed of exterior irradiantion from reflection (diffusive part): <code>AWin*uSha*HDif*tau*rho(HEM)*(1-tau-rho)</code>
</li>
<li>
the absorbed interior radiation is neglected.
</li>
</ol>
<p>
The output is <code>absRad[2, 1]</code>
</p>

<p>
The absorbed radiation by interior shades includes:</p>
<ol>
<li>
the absorbed exterior radiation (angular part): <code>AWin*uSha*HDir*alpha(IncAng)</code>
</li>
<li>
the absorbed exterior radiation (diffusive part): <code>AWin*uSha*HDif*alpha(HEM)</code>
</li>
<li>
the absorbed interior radiation (diffusive part): <code>AWin*uSha*HRoo*(1-tau-rho)</code>
</li>
</ol>
<p>
The output is <code>absRad[2, N+2]</code></p>

<p>
The absorbed radiation by glass includes:</p>
<ol>
<li>
the absorbed radiation by unshaded part (diffusive part): <code>AWin*(1-uSha)*(HDif*alphaEx(HEM)+HRoo*alphaIn(HEM))</code>
</li>
<li>
the absorbed radiation by unshaded part (angualr part from exterior source): <code>AWin*(1-uSha)*HDir*alphaEx(IncAng)</code>
</li>
<li>
the absorbed radiaiton by shaded part (diffusive part): <code>AWin*uSha*(HDif*alphaExSha(HEM)+HRoo*alphaInSha(HEM))</code>
</li>
<li>
the absorbed radiation by shaded part (angular part from exterior source): <code>AWin*uSha*HDir*alphaExSha(IncAng)</code>
</li>
</ol>
<p>
The output is <code>absRad[1, 2:N+1] = Part1 + Part2; absRad[2, 2:N+1] = Part3 + Part4</code></p>

<p>
The transmitted exterior radiation for window system includes:</p>
<ol>
<li>
the transmitted diffusive radiation on unshaded part: <code>AWin*(1-uSha)*HDif*tau(HEM)</code>
</li>
<li>
the transmitted direct radiation on no shade part: <code>AWin*(1-uSha)*HDir*tau(IncAng)</code>
</li>
<li>
the transmitted diffusive radiation on shaded part: <code>AWin*uSha*HDif*tauSha(HEM)</code>
</li>
<li>
the transmitted direct radiation on shaded part: <code>AWin*uSha*HDir*tauSha(IncAng);</code>
</li>
</ol>
<p>The output is <code>QTra_flow = Part1 + Part2 + Part3 + Part4</code></p>

<h4>References</h4>
<ul>
<li>
Michael Wetter.<br/>
<a href="http://simulationresearch.lbl.gov/wetter/download/mwdiss.pdf">
Simulation-based Building Energy Optimization</a>.<br/>
Dissertation. University of California at Berkeley. 2004.
</li>
</ul>
<P></P>
Extends from <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation</A> (Partial model for variables and data used in radiation calculation).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>haveExteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an exterior shade</TD></TR>
<TR><TD>Boolean</TD><TD>haveInteriorShade</TD><TD>&nbsp;</TD><TD>Set to true if window has an interior shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>AWin</TD><TD>&nbsp;</TD><TD>Area of window [m2]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Glass</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of glass layers</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xGla[N]</TD><TD>&nbsp;</TD><TD>Thickness of glass [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauGlaSol[N]</TD><TD>&nbsp;</TD><TD>Solar transmissivity of glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_a[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface a (facing outside) [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_b[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface b (facing room-side) [1]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_a</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_b</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from glass-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_a</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_b</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from glass-side [1]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>uSha</TD><TD>Control signal for shading (0: unshaded; 1: fully shaded)</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDif</TD><TD>Diffussive solar radiation [W/m2]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>incAng</TD><TD>Incident angle [rad]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HDir</TD><TD>Direct solar radiation [W/m2]</TD></TR>
<TR><TD>input <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>HRoo</TD><TD>Diffussive radiation from room  [W/m2]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QTra_flow</TD><TD>Transmitted exterior radiation through the window. (1: no shade; 2: shade) [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsExtSha_flow</TD><TD>Absorbed interior and exterior radiation by exterior shading device [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsIntSha_flow</TD><TD>Absorbed interior and exterior radiation by interior shading device [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsGlaUns_flow[N]</TD><TD>Absorbed interior and exterior radiation by unshaded part of glass [W]</TD></TR>
<TR><TD>output <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>QAbsGlaSha_flow[N]</TD><TD>Absorbed interior and exterior radiation by shaded part of glass [W]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> WindowRadiation <font color="darkgreen">&quot;Calculation radiation for window&quot;</font>

  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.PartialRadiation</A>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> HRoo(quantity=&quot;RadiantEnergyFluenceRate&quot;,
      unit=&quot;W/m2&quot;) <font color="darkgreen">&quot;Diffussive radiation from room &quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QTra_flow(<font color="blue">final </font>quantity=&quot;Power&quot;,
      <font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Transmitted exterior radiation through the window. (1: no shade; 2: shade)&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsExtSha_flow(<font color="blue">final </font>quantity=&quot;Power&quot;,
      <font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by exterior shading device&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsIntSha_flow(<font color="blue">final </font>quantity=&quot;Power&quot;,
      <font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by interior shading device&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsGlaUns_flow[N](<font color="blue">each </font>quantity=
        &quot;Power&quot;, <font color="blue">each </font><font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by unshaded part of glass&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> QAbsGlaSha_flow[N](<font color="blue">each </font>quantity=
        &quot;Power&quot;, <font color="blue">each </font><font color="blue">final </font>unit=&quot;W&quot;) <font color="darkgreen">
    &quot;Absorbed interior and exterior radiation by shaded part of glass&quot;</font>;</textblock>

<textblock type="annotcomp" expanded="false">  <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.TransmittedRadiation</A> tra(
    <font color="blue">final </font>N=N,
    <font color="blue">final </font>tauGlaSol=tauGlaSol,
    <font color="blue">final </font>rhoGlaSol_a=rhoGlaSol_a,
    <font color="blue">final </font>rhoGlaSol_b=rhoGlaSol_b,
    <font color="blue">final </font>xGla=xGla,
    <font color="blue">final </font>tauShaSol_a=tauShaSol_a,
    <font color="blue">final </font>rhoShaSol_a=rhoShaSol_a,
    <font color="blue">final </font>rhoShaSol_b=rhoShaSol_b,
    <font color="blue">final </font>haveExteriorShade=haveExteriorShade,
    <font color="blue">final </font>haveInteriorShade=haveInteriorShade,
    <font color="blue">final </font>AWin=AWin,
    <font color="blue">final </font>tauShaSol_b=tauShaSol_b);
  <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation"
>Buildings.HeatTransfer.Windows.BaseClasses.AbsorbedRadiation</A> abs(
    <font color="blue">final </font>N=N,
    <font color="blue">final </font>tauGlaSol=tauGlaSol,
    <font color="blue">final </font>rhoGlaSol_a=rhoGlaSol_a,
    <font color="blue">final </font>rhoGlaSol_b=rhoGlaSol_b,
    <font color="blue">final </font>xGla=xGla,
    <font color="blue">final </font>tauShaSol_a=tauShaSol_a,
    <font color="blue">final </font>tauShaSol_b=tauShaSol_b,
    <font color="blue">final </font>rhoShaSol_a=rhoShaSol_a,
    <font color="blue">final </font>rhoShaSol_b=rhoShaSol_b,
    <font color="blue">final </font>haveExteriorShade=haveExteriorShade,
    <font color="blue">final </font>haveInteriorShade=haveInteriorShade,
    <font color="blue">final </font>AWin=AWin);</textblock>
<font color="blue">protected </font>
  <font color="blue">final </font><font color="blue">parameter </font>Boolean noShade=<font color="blue">not </font>(haveExteriorShade<font color="blue"> or </font>haveInteriorShade) <font color="darkgreen">
    &quot;Flag, true if the window has a shade&quot;</font>;
<font color="blue">equation </font>
  <font color="blue">if </font>noShade<font color="blue"> then</font>
    <font color="red">assert</font>(uSha_internal &lt; 1E-6,
      &quot;Window has no shade, but control signal is non-zero.\n&quot; +
      &quot;  Received uSha_internal = &quot; +<font color="red"> String</font>(uSha_internal));
  <font color="blue">end if</font>;
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(HDif, tra.HDif);
  <font color="red">connect</font>(HDif, abs.HDif);
  <font color="red">connect</font>(HDir, tra.HDir);
  <font color="red">connect</font>(HDir, abs.HDir);
  <font color="red">connect</font>(incAng, tra.incAng);
  <font color="red">connect</font>(incAng, abs.incAng);
  <font color="red">connect</font>(HRoo, abs.HRoo);
  <font color="red">connect</font>(tra.uSha, uSha);
  <font color="red">connect</font>(abs.uSha, uSha);
  <font color="red">connect</font>(tra.QTra_flow, QTra_flow);
  <font color="red">connect</font>(abs.QAbsIntSha_flow, QAbsIntSha_flow);
  <font color="red">connect</font>(abs.QAbsGlaSha_flow, QAbsGlaSha_flow);
  <font color="red">connect</font>(abs.QAbsGlaUns_flow, QAbsGlaUns_flow);
  <font color="red">connect</font>(abs.QAbsExtSha_flow, QAbsExtSha_flow);</textblock>
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>WindowRadiation;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE RadiationBaseData<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.RadiationBaseData</H2>
<B>Basic parameters for window radiation calculation</B><p></P>
<P></P><H3>Information</H3>

Record that defines basic parameters for the window radiation calculation.
<P></P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Glass</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of glass layers</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xGla[N]</TD><TD>&nbsp;</TD><TD>Thickness of glass [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauGlaSol[N]</TD><TD>&nbsp;</TD><TD>Solar transmissivity of glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_a[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface a (facing outside) [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_b[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface b (facing room-side) [1]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_a</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_b</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from glass-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_a</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_b</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from glass-side [1]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">record</font> RadiationBaseData <font color="darkgreen">
  &quot;Basic parameters for window radiation calculation&quot;</font>

  <font color="blue">parameter </font>Integer N(min=1) <font color="darkgreen">&quot;Number of glass layers&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</A> xGla[N] <font color="darkgreen">&quot;Thickness of glass&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</A> tauGlaSol[N] <font color="darkgreen">
    &quot;Solar transmissivity of glass&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>Modelica.SIunits.ReflectionCoefficient</A> rhoGlaSol_a[N] <font color="darkgreen">
    &quot;Solar reflectivity of glass at surface a (facing outside)&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>Modelica.SIunits.ReflectionCoefficient</A> rhoGlaSol_b[N] <font color="darkgreen">
    &quot;Solar reflectivity of glass at surface b (facing room-side)&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</A> tauShaSol_a <font color="darkgreen">
    &quot;Solar transmissivity of shade for irradiation from air-side&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</A> tauShaSol_b <font color="darkgreen">
    &quot;Solar transmissivity of shade for irradiation from glass-side&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>Modelica.SIunits.ReflectionCoefficient</A> rhoShaSol_a <font color="darkgreen">
    &quot;Solar reflectivity of shade for irradiation from air-side&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>Modelica.SIunits.ReflectionCoefficient</A> rhoShaSol_b <font color="darkgreen">
    &quot;Solar reflectivity of shade for irradiation from glass-side&quot;</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>RadiationBaseData;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE RadiationData<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Wi5f9a5ce7433483eenDataI.png" ALT="Buildings.HeatTransfer.Windows.BaseClasses.RadiationData" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Windows.BaseClasses.RadiationData"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.RadiationData</H2>
<B>Radiation data of a window</B><p></P>
<P></P><H3>Information</H3>

Record that computes the solar radiation data for a glazing system.
<P></P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</A> (Icon for records), <A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData"
>Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData</A> (Basic parameters for window radiation calculation).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Glass</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>&nbsp;</TD><TD>Number of glass layers</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>xGla[N]</TD><TD>&nbsp;</TD><TD>Thickness of glass [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauGlaSol[N]</TD><TD>&nbsp;</TD><TD>Solar transmissivity of glass [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_a[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface a (facing outside) [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoGlaSol_b[N]</TD><TD>&nbsp;</TD><TD>Solar reflectivity of glass at surface b (facing room-side) [1]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Shade</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_a</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>TransmissionCoefficient</A></TD><TD>tauShaSol_b</TD><TD>&nbsp;</TD><TD>Solar transmissivity of shade for irradiation from glass-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_a</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from air-side [1]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ReflectionCoefficient"
>ReflectionCoefficient</A></TD><TD>rhoShaSol_b</TD><TD>&nbsp;</TD><TD>Solar reflectivity of shade for irradiation from glass-side [1]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">record</font> RadiationData <font color="darkgreen">&quot;Radiation data of a window&quot;</font>
  <font color="blue">extends </font><A HREF="../../msl/3.2/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</A>;
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData"
>Buildings.HeatTransfer.Windows.BaseClasses.RadiationBaseData</A>;
  <font color="blue">final </font><font color="blue">parameter </font>Real glass[3, N]={tauGlaSol,rhoGlaSol_a,rhoGlaSol_b} <font color="darkgreen">
    &quot;Glass solar transmissivity, solar reflectivity at surface a and b, at normal incident angle&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real traRefShaDev[2, 2]={{tauShaSol_a,tauShaSol_b},{
      rhoShaSol_a,rhoShaSol_b}} <font color="darkgreen">&quot;Shading device property&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer NDIR=10 <font color="darkgreen">&quot;Number of incident angles&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer HEM=NDIR + 1 <font color="darkgreen">&quot;Index of hemispherical integration&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> psi[NDIR]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.getAngle</font>(NDIR) <font color="darkgreen">
    &quot;Incident angles used for solar radiation calculation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real layer[3, N, HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassProperty</font>(
      N,
      HEM,
      glass,
      xGla,
      psi) <font color="darkgreen">&quot;Angular and hemispherical transmissivity, front (outside-facing) and back (room facing) reflectivity 
      of each glass pane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real traRef[3, N, N, HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.getGlassTR</font>(
      N,
      HEM,
      layer) <font color="darkgreen">&quot;Angular and hemispherical transmissivity, front (outside-facing) and back (room facing) reflectivity 
      between glass panes for exterior or interior irradiation without shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real absExtIrrNoSha[N, HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassAbsExteriorIrradiationNoShading</font>(
      traRef,
      N,
      HEM) <font color="darkgreen">&quot;Angular and hemispherical absorptivity of each glass pane 
      for exterior irradiation without shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real absIntIrrNoSha[N]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassAbsInteriorIrradiationNoShading</font>(
      traRef,
      N,
      HEM) <font color="darkgreen">&quot;Hemispherical absorptivity of each glass pane 
      for interior irradiation without shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real winTraExtIrrExtSha[HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.winTExteriorIrradiatrionExteriorShading</font>(
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Angular and hemispherical transmissivity of a window system (glass + exterior shading device) 
     for exterior irradiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real absExtIrrExtSha[N, HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassAbsExteriorIrradiationExteriorShading</font>(
      absExtIrrNoSha,
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Angular and hemispherical absorptivity of each glass pane 
      for exterior irradiation with exterior shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real winTraExtIrrIntSha[HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.winTExteriorIrradiationInteriorShading</font>(
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Angular and hemispherical transmissivity of a window system (glass and interior shading device) 
      for exterior irradiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real absExtIrrIntSha[N, HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassAbsExteriorIrradiationInteriorShading</font>(
      absExtIrrNoSha,
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Angular and hemispherical absorptivity of each glass layer
     for exterior irradiation with interior shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real devAbsExtIrrIntShaDev[HEM]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.devAbsExteriorIrradiationInteriorShading</font>(
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Angular and hemispherical absorptivity of an interior shading device 
      for exterior irradiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real winTraRefIntIrrExtSha[3]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.winTRInteriorIrradiationExteriorShading</font>(
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Hemisperical transmissivity and reflectivity of a window system (glass and exterior shadig device) 
      for interior irradiation. traRefIntIrrExtSha[1]: transmissivity, 
      traRefIntIrrExtSha[2]: Back reflectivity; traRefIntIrrExtSha[3]: dummy value&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real absIntIrrExtSha[N]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassAbsInteriorIrradiationExteriorShading</font>(
      absIntIrrNoSha,
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Hemispherical absorptivity of each glass pane 
      for interior irradiation with exterior shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real absIntIrrIntSha[N]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.glassAbsInteriorIrradiationInteriorShading</font>(
      absIntIrrNoSha,
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Hemispherical absorptivity of each glass pane 
      for interior irradiation with interior shading&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real winTraRefIntIrrIntSha[3]=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.winTRInteriorIrradiationInteriorShading</font>(
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">&quot;Hemisperical transmissivity and back reflectivity of a window system (glass and interior shadig device) 
      for interior irradiation&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Real devAbsIntIrrIntSha=
      <font color="red">Buildings.HeatTransfer.Windows.Functions.devAbsInteriorIrradiationInteriorShading</font>(
      traRef,
      traRefShaDev,
      N,
      HEM) <font color="darkgreen">
    &quot;Hemiperical absorptivity of an interior shading device for interior irradiation&quot;</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>RadiationData;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE convectionVerticalCavity<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses.convectionVerticalCavity"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.convectionVerticalCavity</H2>
<B>Free convection in vertical cavity</B><p></P>
<P></P><H3>Information</H3>

<p>
Function for convective heat transfer in vertical window cavity.
The computation is according to TARCOG 2006,
except that this implementation computes the convection coefficient
as a function that is differentiable in the temperatures.
</p>
<h4>References</h4>
<p>
TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Generic</A></TD><TD>gas</TD><TD>&nbsp;</TD><TD>Thermophysical properties of gas fill</TD></TR>
<TR><TD>Real</TD><TD>Ra</TD><TD>&nbsp;</TD><TD>Rayleigh number</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_m</TD><TD>&nbsp;</TD><TD>Temperature used for thermophysical properties [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>TemperatureDifference</A></TD><TD>dT</TD><TD>&nbsp;</TD><TD>Temperature difference used to compute q_flow = h*dT [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>h</TD><TD>1.5</TD><TD>Height of window [m2]</TD></TR>
<TR><TD>Real</TD><TD>deltaNu</TD><TD>0.1</TD><TD>Small value for Nusselt number, used for smoothing</TD></TR>
<TR><TD>Real</TD><TD>deltaRa</TD><TD>1E3</TD><TD>Small value for Rayleigh number, used for smoothing</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Nu</TD><TD>Nusselt number</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>hCon</TD><TD>Convective heat transfer coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A></TD><TD>q_flow</TD><TD>Convective heat flux [W/m2]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> convectionVerticalCavity <font color="darkgreen">
  &quot;Free convection in vertical cavity&quot;</font>
  <font color="blue">input </font><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Buildings.HeatTransfer.Data.Gases.Generic</A> gas <font color="darkgreen">
    &quot;Thermophysical properties of gas fill&quot;</font>;
  <font color="blue">input </font>Real Ra(min=0) <font color="darkgreen">&quot;Rayleigh number&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_m <font color="darkgreen">
    &quot;Temperature used for thermophysical properties&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">
    &quot;Temperature difference used to compute q_flow = h*dT&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> h(min=0) = 1.5 <font color="darkgreen">&quot;Height of window&quot;</font>;
  <font color="blue">input </font>Real deltaNu(min=0.01) = 0.1 <font color="darkgreen">
    &quot;Small value for Nusselt number, used for smoothing&quot;</font>;
  <font color="blue">input </font>Real deltaRa(min=0.01) = 1E3 <font color="darkgreen">
    &quot;Small value for Rayleigh number, used for smoothing&quot;</font>;
  <font color="blue">output </font>Real Nu(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</A> hCon(min=0) <font color="darkgreen">
    &quot;Convective heat transfer coefficient&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>Modelica.SIunits.HeatFlux</A> q_flow <font color="darkgreen">&quot;Convective heat flux&quot;</font>;
<font color="blue">protected </font>
  Real Nu_1(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  Real Nu_2(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
<font color="blue">algorithm </font>

  Nu_1 :=<font color="red">Buildings.Utilities.Math.Functions.spliceFunction</font>(
    pos=0.0673838*Ra^(1/3),
    neg=<font color="red">Buildings.Utilities.Math.Functions.spliceFunction</font>(
      pos=0.028154*Ra^(0.4134),
      neg=1 + 1.7596678E-10*Ra^(2.2984755),
      x=Ra - 1E4,
      deltax=deltaRa),
    x=Ra - 5E4,
    deltax=deltaRa);
  <font color="darkgreen">/*
  if ( Ra &lt;= 1E4) then
    Nu_1 = 1 + 1.7596678E-10*Ra^(2.2984755);
  elseif ( Ra &lt;= 5E4) then
    Nu_1 = 0.028154*Ra^(0.4134);
  else
    Nu_1 = 0.0673838*Ra^(1/3);
  end if;
  */</font>
  Nu_2 :=0.242*(Ra/(h/gas.x))^(0.272);
  Nu :=<font color="red">Buildings.Utilities.Math.Functions.smoothMax</font>(
    x1=Nu_1,
    x2=Nu_2,
    deltaX=deltaNu);
  hCon :=Nu*<font color="red">Buildings.HeatTransfer.Data.Gases.thermalConductivity</font>(gas, T_m)/gas.x;
  q_flow :=hCon*dT;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>convectionVerticalCavity;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE convectionHorizontalCavity<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses.convectionHorizontalCavity"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.convectionHorizontalCavity</H2>
<B>Free convection in horizontal cavity</B><p></P>
<P></P><H3>Information</H3>

<p>
Function for convective heat transfer in horizontal window cavity.
The computation is according to TARCOG 2006,
except that this implementation computes the convection coefficient
as a function that is differentiable in the temperatures.
</p>
<h4>References</h4>
<p>
TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Generic</A></TD><TD>gas</TD><TD>&nbsp;</TD><TD>Thermophysical properties of gas fill</TD></TR>
<TR><TD>Real</TD><TD>Ra</TD><TD>&nbsp;</TD><TD>Rayleigh number</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_m</TD><TD>&nbsp;</TD><TD>Temperature used for thermophysical properties [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>TemperatureDifference</A></TD><TD>dT</TD><TD>&nbsp;</TD><TD>Temperature difference used to compute q_flow = h*dT [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>til</TD><TD>&nbsp;</TD><TD>Window tilt [rad]</TD></TR>
<TR><TD>Real</TD><TD>sinTil</TD><TD>&nbsp;</TD><TD>Sine of window tilt</TD></TR>
<TR><TD>Real</TD><TD>cosTil</TD><TD>&nbsp;</TD><TD>Cosine of the window tilt</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>h</TD><TD>1.5</TD><TD>Height of window [m2]</TD></TR>
<TR><TD>Real</TD><TD>deltaNu</TD><TD>0.1</TD><TD>Small value for Nusselt number, used for smoothing</TD></TR>
<TR><TD>Real</TD><TD>deltaRa</TD><TD>1E3</TD><TD>Small value for Rayleigh number, used for smoothing</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Nu</TD><TD>Nusselt number</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>hCon</TD><TD>Convective heat transfer coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A></TD><TD>q_flow</TD><TD>Convective heat flux [W/m2]</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> convectionHorizontalCavity <font color="darkgreen">
  &quot;Free convection in horizontal cavity&quot;</font>
  <font color="blue">input </font><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Buildings.HeatTransfer.Data.Gases.Generic</A> gas <font color="darkgreen">
    &quot;Thermophysical properties of gas fill&quot;</font>;
  <font color="blue">input </font>Real Ra(min=0) <font color="darkgreen">&quot;Rayleigh number&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_m <font color="darkgreen">
    &quot;Temperature used for thermophysical properties&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">
    &quot;Temperature difference used to compute q_flow = h*dT&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> til <font color="darkgreen">&quot;Window tilt&quot;</font>;
  <font color="blue">input </font>Real sinTil <font color="darkgreen">&quot;Sine of window tilt&quot;</font>;
  <font color="blue">input </font>Real cosTil <font color="darkgreen">&quot;Cosine of the window tilt&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> h(min=0) = 1.5 <font color="darkgreen">&quot;Height of window&quot;</font>;
  <font color="blue">input </font>Real deltaNu(min=0.01) = 0.1 <font color="darkgreen">
    &quot;Small value for Nusselt number, used for smoothing&quot;</font>;
  <font color="blue">input </font>Real deltaRa(min=0.01) = 1E3 <font color="darkgreen">
    &quot;Small value for Rayleigh number, used for smoothing&quot;</font>;
  <font color="blue">output </font>Real Nu(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</A> hCon(min=0) <font color="darkgreen">
    &quot;Convective heat transfer coefficient&quot;</font>;
  <font color="blue">output </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>Modelica.SIunits.HeatFlux</A> q_flow <font color="darkgreen">&quot;Convective heat flux&quot;</font>;
<font color="blue">protected </font>
  Real Nu_1(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  Real Nu_2(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
  <font color="blue">constant </font>Real dx=0.1 <font color="darkgreen">&quot;Half-width of interval used for smoothing&quot;</font>;
<font color="blue">algorithm </font>
  <font color="blue">if </font>cosTil &gt; 0<font color="blue"> then</font>
  Nu :=<font color="red">Buildings.Utilities.Math.Functions.spliceFunction</font>(
    pos=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityReduced</font>(
      gas=gas,
      Ra=Ra,
      T_m=T_m,
      dT=dT,
      h=h,
      sinTil=sinTil,
      deltaNu=deltaNu,
      deltaRa=deltaRa),
    neg=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityEnhanced</font>(
      gas=gas,
      Ra=Ra,
      T_m=T_m,
      dT=dT,
      til=til,
      cosTil=<font color="red">abs</font>(cosTil)),
    x=dT+dx,
    deltax=dx);
  <font color="blue">else</font>
    Nu :=<font color="red">Buildings.Utilities.Math.Functions.spliceFunction</font>(
    pos=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityEnhanced</font>(
      gas=gas,
      Ra=Ra,
      T_m=T_m,
      dT=dT,
      til=til,
      cosTil=<font color="red">abs</font>(cosTil)),
    neg=
      <font color="red">Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityReduced</font>(
      gas=gas,
      Ra=Ra,
      T_m=T_m,
      dT=dT,
      h=h,
      sinTil=sinTil,
      deltaNu=deltaNu,
      deltaRa=deltaRa),
    x=dT-dx,
    deltax=dx);
  <font color="blue">end if</font>;
  hCon :=Nu*<font color="red">Buildings.HeatTransfer.Data.Gases.thermalConductivity</font>(gas, T_m)/gas.x;
  q_flow :=hCon*dT;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>convectionHorizontalCavity;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE nusseltHorizontalCavityEnhanced<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityEnhanced"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.nusseltHorizontalCavityEnhanced</H2>
<B>Nusselt number for horizontal cavity, bottom surface warmer than top surface</B><p></P>
<P></P><H3>Information</H3>

<p>
Function for Nusselt number in horizontal window cavity.
The computation is according to TARCOG 2006,
except that this implementation computes the Nusselt number
as a function that is differentiable in the temperatures.
</p>
<h4>References</h4>
<p>
TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Generic</A></TD><TD>gas</TD><TD>&nbsp;</TD><TD>Thermophysical properties of gas fill</TD></TR>
<TR><TD>Real</TD><TD>Ra</TD><TD>&nbsp;</TD><TD>Rayleigh number</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_m</TD><TD>&nbsp;</TD><TD>Temperature used for thermophysical properties [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>TemperatureDifference</A></TD><TD>dT</TD><TD>&nbsp;</TD><TD>Temperature difference used to compute q_flow = h*dT [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A></TD><TD>til</TD><TD>&nbsp;</TD><TD>Window tilt [rad]</TD></TR>
<TR><TD>Real</TD><TD>cosTil</TD><TD>&nbsp;</TD><TD>Cosine of the window tilt</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Nu</TD><TD>Nusselt number</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> nusseltHorizontalCavityEnhanced <font color="darkgreen">
  &quot;Nusselt number for horizontal cavity, bottom surface warmer than top surface&quot;</font>
  <font color="blue">input </font><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Buildings.HeatTransfer.Data.Gases.Generic</A> gas <font color="darkgreen">
    &quot;Thermophysical properties of gas fill&quot;</font>;
  <font color="blue">input </font>Real Ra(min=0) <font color="darkgreen">&quot;Rayleigh number&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_m <font color="darkgreen">
    &quot;Temperature used for thermophysical properties&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">
    &quot;Temperature difference used to compute q_flow = h*dT&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> til <font color="darkgreen">&quot;Window tilt&quot;</font>;
  <font color="blue">input </font>Real cosTil(min=0) <font color="darkgreen">&quot;Cosine of the window tilt&quot;</font>;
  <font color="blue">output </font>Real Nu(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
<font color="blue">protected </font>
  Real k1 <font color="darkgreen">&quot;Auxiliary variable&quot;</font>;
  Real k2 <font color="darkgreen">&quot;Auxiliary variable&quot;</font>;
  Real k11 <font color="darkgreen">&quot;Auxiliary variable&quot;</font>;
  Real k22 <font color="darkgreen">&quot;Auxiliary variable&quot;</font>;
<font color="blue">algorithm </font>
  <font color="darkgreen">// Windows inclined from 0 to 60 deg (eqn. 3.1-42 to 3.1-43)</font>
  k1 :=1 - 1708/Ra/cosTil;
  k2 :=(Ra*cosTil/5830)^(1/3) - 1;
  k11 :=(k1 +<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
    x1=k1,
    x2=-k1,
    deltaX=1E-1))/2;
  k22 :=(k2 +<font color="red"> Buildings.Utilities.Math.Functions.smoothMax</font>(
    x1=k2,
    x2=-k2,
    deltaX=1E-1))/2;
  Nu :=1 + 1.44*k11*(1 - 1708*<font color="red">abs</font>(<font color="red">Modelica.Math.sin</font>(1.8*til*180/Modelica.Constants.pi))
    ^(1.6)/Ra/cosTil) + k22;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>nusseltHorizontalCavityEnhanced;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE nusseltHorizontalCavityReduced<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses.nusseltHorizontalCavityReduced"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.nusseltHorizontalCavityReduced</H2>
<B>Nusselt number for horizontal cavity, bottom surface colder than top surface</B><p></P>
<P></P><H3>Information</H3>

<p>
Function for Nusselt number in horizontal window cavity.
The computation is according to TARCOG 2006,
except that this implementation computes the Nusselt number
as a function that is differentiable in the temperatures.
</p>
<h4>References</h4>
<p>
TARCOG 2006: Carli, Inc., TARCOG: Mathematical models for calculation
of thermal performance of glazing systems with our without
shading devices, Technical Report, Oct. 17, 2006.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Generic</A></TD><TD>gas</TD><TD>&nbsp;</TD><TD>Thermophysical properties of gas fill</TD></TR>
<TR><TD>Real</TD><TD>Ra</TD><TD>&nbsp;</TD><TD>Rayleigh number</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_m</TD><TD>&nbsp;</TD><TD>Temperature used for thermophysical properties [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>TemperatureDifference</A></TD><TD>dT</TD><TD>&nbsp;</TD><TD>Temperature difference used to compute q_flow = h*dT [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>h</TD><TD>1.5</TD><TD>Height of window [m2]</TD></TR>
<TR><TD>Real</TD><TD>sinTil</TD><TD>&nbsp;</TD><TD>Sine of window tilt</TD></TR>
<TR><TD>Real</TD><TD>deltaNu</TD><TD>0.1</TD><TD>Small value for Nusselt number, used for smoothing</TD></TR>
<TR><TD>Real</TD><TD>deltaRa</TD><TD>1E3</TD><TD>Small value for Rayleigh number, used for smoothing</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Nu</TD><TD>Nusselt number</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> nusseltHorizontalCavityReduced <font color="darkgreen">
  &quot;Nusselt number for horizontal cavity, bottom surface colder than top surface&quot;</font>
  <font color="blue">input </font><A HREF="Buildings_HeatTransfer_Data_Gases.html#Buildings.HeatTransfer.Data.Gases.Generic"
>Buildings.HeatTransfer.Data.Gases.Generic</A> gas <font color="darkgreen">
    &quot;Thermophysical properties of gas fill&quot;</font>;
  <font color="blue">input </font>Real Ra(min=0) <font color="darkgreen">&quot;Rayleigh number&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_m <font color="darkgreen">
    &quot;Temperature used for thermophysical properties&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">
    &quot;Temperature difference used to compute q_flow = h*dT&quot;</font>;
  <font color="blue">input </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</A> h(min=0) = 1.5 <font color="darkgreen">&quot;Height of window&quot;</font>;
  <font color="blue">input </font>Real sinTil <font color="darkgreen">&quot;Sine of window tilt&quot;</font>;
  <font color="blue">input </font>Real deltaNu(min=0.01) = 0.1 <font color="darkgreen">
    &quot;Small value for Nusselt number, used for smoothing&quot;</font>;
  <font color="blue">input </font>Real deltaRa(min=0.01) = 1E3 <font color="darkgreen">
    &quot;Small value for Rayleigh number, used for smoothing&quot;</font>;
  <font color="blue">output </font>Real Nu(min=0) <font color="darkgreen">&quot;Nusselt number&quot;</font>;
<font color="blue">protected </font>
  Real NuVer(min=0) <font color="darkgreen">&quot;Nusselt number for vertical window&quot;</font>;
<font color="blue">algorithm </font>
  NuVer :=<font color="red">Buildings.HeatTransfer.Windows.BaseClasses.convectionVerticalCavity</font>(
    gas=gas,
    Ra=Ra,
    T_m=T_m,
    dT=dT,
    h=h,
    deltaNu=deltaNu,
    deltaRa=deltaRa);
  Nu :=1 + (NuVer - 1)*sinTil;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>nusseltHorizontalCavityReduced;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE smoothInterpolation<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Windows.BaseClasses.smoothInterpolation"></A><A HREF="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses"
>Buildings.HeatTransfer.Windows.BaseClasses</A>.smoothInterpolation</H2>
<B>Get interpolated data without triggering events</B><p></P>
<P></P><H3>Information</H3>

<p>
Function to interpolate within a data array without triggerring events.
</p>
<P></P>

<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>y[:]</TD><TD>&nbsp;</TD><TD>Data array</TD></TR>
<TR><TD>Real</TD><TD>x</TD><TD>&nbsp;</TD><TD>x value</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>val</TD><TD>Return value</TD></TR>
</TABLE>
<P></P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> smoothInterpolation <font color="darkgreen">
  &quot;Get interpolated data without triggering events&quot;</font>
  <font color="blue">input </font>Real y[:] <font color="darkgreen">&quot;Data array&quot;</font>;
  <font color="blue">input </font>Real x <font color="darkgreen">&quot;x value&quot;</font>;
  <font color="blue">output </font>Real val <font color="darkgreen">&quot;Return value&quot;</font>;

<font color="blue">protected </font>
  Integer k1;
  Integer k2;
  Real y1d;
  Real y2d;
<font color="blue">algorithm </font>
  k1 :=<font color="red"> integer</font>(x);
  k2 := k1 + 1;

  y1d := (y[k1 + 1] - y[k1 - 1])/2;
  y2d := (y[k2 + 1] - y[k2 - 1])/2;
  val :=<font color="red"> Modelica.Fluid.Utilities.cubicHermite</font>(
    x,
    k1,
    k2,
    y[k1],
    y[k2],
    y1d,
    y2d);

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>smoothInterpolation;
</PRE>
<HR>
<address><a href="http://www.3ds.com/">Automatically generated</a> Thu Oct 24 15:10:32 2013.
</address></BODY>
</HTML>
