<HTML>
<HEAD>
<TITLE>Buildings.HeatTransfer.Conduction</TITLE>
<META name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META name="description" content="&quot;Package with models for heat conduction&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- --- header ------ -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- --- end header -- -->

<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Conduction<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Buildings.HeatTransfer.Conduction"></A><A HREF="Buildings_HeatTransfer.html#Buildings.HeatTransfer"
>Buildings.HeatTransfer</A>.Conduction</H2>
<B>Package with models for heat conduction</B>
<P>
<P><H3>Information</H3></P>

<p>
This package provides component models to compute heat conduction.
</p>
<h4>Implementation</h4>
<p>
The package declares the constant <code>nSupPCM</code>, 
which is equal to the number of support points that are used
to approximate the specific internal energy versus temperature relation.
This approximation is used by 
<code>Buildings.HeatTransfer.Conduction.SingleLayer</code>
to replace the piece-wise linear function by a cubic hermite spline, with 
linear extrapolation, in order to avoid state events during the simulation.
</p>
<P>
Extends from <A HREF="../../msl/3.2/help/Modelica_Icons_VariantsPackage.html#Modelica.Icons.VariantsPackage"
>Modelica.Icons.VariantsPackage</A> (Icon for package containing variants).
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Cob4c036f3e70672a0LayerS.png" ALT="Buildings.HeatTransfer.Conduction.SingleLayer" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayer"
>SingleLayer</A>
</TD><TD>Model for single layer heat conductance</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Coe2a9524198d40e33inderS.png" ALT="Buildings.HeatTransfer.Conduction.SingleLayerCylinder" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayerCylinder"
>SingleLayerCylinder</A>
</TD><TD>Heat conduction in a cylinder</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Co57ad46f24fbd0c15LayerS.png" ALT="Buildings.HeatTransfer.Conduction.MultiLayer" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.MultiLayer"
>MultiLayer</A>
</TD><TD>Model for heat conductance through a solid with multiple material layers</TD></TR>
<TR><TD>nSupPCM=6</TD><TD>Number of support points to approximate u(T) releation, used only for phase change material</TD></TR>
<TR><TD><IMG SRC="Buildings.HeatTransfer.Co3383096b379a47baassesS.png" ALT="Buildings.HeatTransfer.Conduction.BaseClasses" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses"
>BaseClasses</A>
</TD><TD>Package with base classes for Buildings.HeatTransfer.Conduction</TD></TR>
</TABLE>
<P><H3>Types and constants</H3>
<PRE>  <font color="blue">constant </font>Integer nSupPCM = 6 <font color="darkgreen">
  &quot;Number of support points to approximate u(T) releation, used only for phase change material&quot;</font>;</PRE><p>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SingleLayer<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Cob4c036f3e70672a0LayerI.png" ALT="Buildings.HeatTransfer.Conduction.SingleLayer" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Conduction.SingleLayer"></A><A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction"
>Buildings.HeatTransfer.Conduction</A>.SingleLayer</H2>
<B>Model for single layer heat conductance</B><p>
<IMG SRC="Buildings.HeatTransfer.Cob4c036f3e70672a0LayerD.png" ALT="Buildings.HeatTransfer.Conduction.SingleLayer">
<P><H3>Information</H3></P>

This is a model of a heat conductor for a single layer of homogeneous material
that computes transient or steady-state heat conduction.
</p>
<h4>Transient heat conduction in materials without phase change</h4>
<p>
If the material is a record that extends
<A HREF="Buildings_HeatTransfer_Data_Solids.html#Buildings.HeatTransfer.Data.Solids"
>
Buildings.HeatTransfer.Data.Solids</a> and its
specific heat capacity (as defined by the record <code>material.c</code>)
is non-zero, then this model computes <i>transient</i> heat conduction, i.e., it
computes a numerical approximation to the solution of the heat equation
</p>
<p align="center" style="font-style:italic;">
   &rho; c (&part; T(s,t) &frasl; &part;t) = 
    k (&part;&sup2; T(s,t) &frasl; &part;s&sup2;),
</p>
<p>
where 
<i>&rho;</i>
is the mass density,
<i>c</i>
is the specific heat capacity per unit mass,
<i>T</i>
is the temperature at location <i>s</i> and time <i>t</i> and
<i>k</i> is the heat conductivity. 
At the locations <i>s=0</i> and <i>s=x</i>, where <i>x</i> is the
material thickness, the temperature and heat flow rate is equal to the 
temperature and heat flow rate of the heat ports.
</p>
<h4>Transient heat conduction in phase change materials</h4>
<p>
If the material is declared using a record of type
<A HREF="Buildings_HeatTransfer_Data_SolidsPCM.html#Buildings.HeatTransfer.Data.SolidsPCM"
>
Buildings.HeatTransfer.Data.SolidsPCM</a>, the heat transfer
in a phase change material is computed.
The record <A HREF="Buildings_HeatTransfer_Data_SolidsPCM.html#Buildings.HeatTransfer.Data.SolidsPCM"
>
Buildings.HeatTransfer.Data.SolidsPCM</a>
declares the solidus temperature <code>TSol</code>,
the liquidus temperature <code>TLiq</code> and the latent heat of
phase transformation <code>LHea</code>. 
For heat transfer with phase change, the specific internal energy <i>u</i>
is the dependent variable, rather than the temperature.
Therefore, the governing equation is
</p>
<p align="center" style="font-style:italic;">
   &rho; (&part; u(s,t) &frasl; &part;t) = 
    k (&part;&sup2; T(s,t) &frasl; &part;s&sup2;).
</p>
<p>
The constitutive 
relation between specific internal energy <i>u</i> and temperature <i>T</i> is defined in
<a href="modelica://Buildings.HeatTransfer.Conduction.BaseClasses.enthalpyTemperature"> 
Buildings.HeatTransfer.Conduction.BaseClasses.enthalyTemperature</a> by using 
cubic hermite spline interpolation with linear extrapolation.
</p>
<h4>Steady-state heat conduction</h4>
<p>
If <code>material.c=0</code>, or if the material extends
<A HREF="Buildings_HeatTransfer_Data_Resistances.html#Buildings.HeatTransfer.Data.Resistances"
>
Buildings.HeatTransfer.Data.Resistances</a>, 
then steady-state heat conduction is computed. In this situation, the heat
flow between its heat ports is
</p>
<p align="center" style="font-style:italic;">
   Q = A &nbsp; k &frasl; x &nbsp; (T<sub>a</sub>-T<sub>b</sub>),
</p></p>
<p>
where
<i>A</i> is the cross sectional area,
<i>x</i> is the layer thickness,
<i>T<sub>a</sub></i> is the temperature at port a and
<i>T<sub>b</sub></i> is the temperature at port b.
</p>
<h4>Spatial discretization</h4>
<p>
To spatially discretize the heat equation, the construction is 
divided into compartments with <code>material.nSta &ge; 1</code> state variables. 
The state variables are connected to each other through thermal conductors. 
There is also a thermal conductor
between the surfaces and the outermost state variables. Thus, to obtain
the surface temperature, use <code>port_a.T</code> (or <code>port_b.T</code>)
and not the variable <code>T[1]</code>.
Each compartment has the same material properties.
To build multi-layer constructions,
use
<A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.MultiLayer"
>
Buildings.HeatTransfer.Conduction.MultiLayer</a> instead of this model.
</p>

<P>
Extends from <A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</A> (Partial model for heat conductor).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>ThermalResistance</A></TD><TD>R</TD><TD>if (material.R == 0) then ma...</TD><TD>Thermal resistance of construction [K/W]</TD></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_BaseClasses.html#Buildings.HeatTransfer.Data.BaseClasses.Material"
>Material</A></TD><TD>material</TD><TD>redeclare parameter Data.Bas...</TD><TD>Material from Data.Solids, Data.SolidsPCM or Data.Resistances</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD>Boolean</TD><TD>steadyStateInitial</TD><TD>false</TD><TD>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_a_start</TD><TD>293.15</TD><TD>Initial temperature at port_a, used if steadyStateInitial = false [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_b_start</TD><TD>293.15</TD><TD>Initial temperature at port_b, used if steadyStateInitial = false [K]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>Heat port at surface a</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>Heat port at surface b</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SingleLayer <font color="darkgreen">&quot;Model for single layer heat conductance&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</A>(
   <font color="blue">final </font>R=<font color="blue">if </font>(material.R == 0)<font color="blue"> then </font>material.x/material.k/A<font color="blue"> else </font>material.R/A);
  <font color="darkgreen"> // if material.R == 0, then the material specifies material.k, and this model specifies x</font>
  <font color="darkgreen"> // For resistances, material.k need not be specified, and hence we use material.R</font>
  <font color="darkgreen">// The value T[:].start is used by the solver when finding initial states</font>
  <font color="darkgreen">// that satisfy dT/dt=0, which requires solving a system of nonlinear equations</font>
  <font color="darkgreen">// if the convection coefficient is a function of temperature.</font>
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T[nSta](start=
     {T_a_start+(T_b_start-T_a_start) * UA *
        <font color="red">sum</font>(1/(<font color="blue">if </font>(k==1<font color="blue"> or </font>k==nSta+1)<font color="blue"> then </font>UAnSta2<font color="blue"> else </font>UAnSta) <font color="blue">for </font>k<font color="blue"> in </font>1:i) <font color="blue">for </font>i<font color="blue"> in </font>1:nSta},
      <font color="blue">each </font>nominal = 300) <font color="darkgreen">&quot;Temperature at the states&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> Q_flow[nSta+1] <font color="darkgreen">
    &quot;Heat flow rate from state i to i+1&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificInternalEnergy"
>Modelica.SIunits.SpecificInternalEnergy</A> u[nSta](start=
     material.c*{T_a_start+(T_b_start-T_a_start) * UA *
        <font color="red">sum</font>(1/(<font color="blue">if </font>(k==1<font color="blue"> or </font>k==nSta+1)<font color="blue"> then </font>UAnSta2<font color="blue"> else </font>UAnSta) <font color="blue">for </font>k<font color="blue"> in </font>1:i) <font color="blue">for </font>i<font color="blue"> in </font>1:nSta},
        <font color="blue">each </font>nominal = 270000) <font color="darkgreen">
    &quot;Definition of specific internal energy (enthalpy in solids)!&quot;</font>;
<textblock type="annotcomp" expanded="false">  <font color="blue">replaceable </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_BaseClasses.html#Buildings.HeatTransfer.Data.BaseClasses.Material"
>Data.BaseClasses.Material</A> material <font color="darkgreen">
    &quot;Material from Data.Solids, Data.SolidsPCM or Data.Resistances&quot;</font>;</textblock>

  <font color="blue">parameter </font>Boolean steadyStateInitial=false <font color="darkgreen">
    &quot;=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_a_start=293.15 <font color="darkgreen">
    &quot;Initial temperature at port_a, used if steadyStateInitial = false&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T_b_start=293.15 <font color="darkgreen">
    &quot;Initial temperature at port_b, used if steadyStateInitial = false&quot;</font>;

<font color="blue">protected </font>
  <font color="blue">final </font><font color="blue">parameter </font>Integer nSta(min=1) = material.nSta <font color="darkgreen">
    &quot;Number of state variables&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</A> UAnSta = UA*nSta <font color="darkgreen">
    &quot;Thermal conductance between nodes&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</A> UAnSta2 = 2*UAnSta <font color="darkgreen">
    &quot;Thermal conductance between nodes and surface boundary&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</A> m = A*material.x*material.d/material.nSta <font color="darkgreen">
    &quot;Mass associated with the temperature state&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>Modelica.SIunits.HeatCapacity</A> C = m*material.c <font color="darkgreen">
    &quot;Heat capacity associated with the temperature state&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificInternalEnergy"
>Modelica.SIunits.SpecificInternalEnergy</A> ud[Buildings.HeatTransfer.Conduction.nSupPCM](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Support points for derivatives (used for PCM)&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> Td[Buildings.HeatTransfer.Conduction.nSupPCM](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Support points for derivatives (used for PCM)&quot;</font>;
  <font color="blue">parameter </font>Real dT_du[Buildings.HeatTransfer.Conduction.nSupPCM](<font color="blue">each </font>fixed=false, <font color="blue">each </font>unit=&quot;kg.K2/J&quot;) <font color="darkgreen">
    &quot;Derivatives dT/du at the support points (used for PCM)&quot;</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// The initialization is only done for materials that store energy.</font>
    <font color="blue">if </font><font color="blue">not </font>material.steadyState<font color="blue"> then</font>
      <font color="blue">if </font>steadyStateInitial<font color="blue"> then</font>
        <font color="blue">if </font>material.phasechange<font color="blue"> then</font>
        <font color="red">  der</font>(u) =<font color="red"> zeros</font>(nSta);
        <font color="blue">else</font>
        <font color="red">  der</font>(T) =<font color="red"> zeros</font>(nSta);
        <font color="blue">end if</font>;
      <font color="blue">else</font>
        <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
          T[i] = T_a_start+(T_b_start-T_a_start) * UA *
            <font color="red">sum</font>(1/(<font color="blue">if </font>(k==1<font color="blue"> or </font>k==nSta+1)<font color="blue"> then </font>UAnSta2<font color="blue"> else </font>UAnSta) <font color="blue">for </font>k<font color="blue"> in </font>1:i);
        <font color="blue">end for</font>;
      <font color="blue">end if</font>;
    <font color="blue">end if</font>;

   <font color="blue">if </font>material.phasechange<font color="blue"> then</font>
     (ud, Td, dT_du) =<font color="red"> Buildings.HeatTransfer.Conduction.BaseClasses.der_temperature_u</font>(
       material=material);
   <font color="blue">else</font>
     ud    =<font color="red"> zeros</font>(Buildings.HeatTransfer.Conduction.nSupPCM);
     Td    =<font color="red"> zeros</font>(Buildings.HeatTransfer.Conduction.nSupPCM);
     dT_du =<font color="red"> zeros</font>(Buildings.HeatTransfer.Conduction.nSupPCM);
   <font color="blue">end if</font>;
<font color="blue">equation </font>
    port_a.Q_flow = +Q_flow[1];
    port_b.Q_flow = -Q_flow[nSta+1];

    port_a.T-T[1] = Q_flow[1]/UAnSta2;
    T[nSta] -port_b.T = Q_flow[nSta+1]/UAnSta2;

    <font color="blue">for </font>i<font color="blue"> in </font>2:nSta<font color="blue"> loop</font>
    <font color="darkgreen">   // Q_flow[i] is heat flowing from (i-1) to (i)</font>
       T[i-1]-T[i] = Q_flow[i]/UAnSta;
    <font color="blue">end for</font>;

  <font color="darkgreen">  // Steady-state heat balance</font>
    <font color="blue">if </font>material.steadyState<font color="blue"> then</font>
      <font color="blue">for </font>i<font color="blue"> in </font>2:nSta+1<font color="blue"> loop</font>
        Q_flow[i] = Q_flow[1];
        <font color="blue">if </font>material.phasechange<font color="blue"> then</font>
        <font color="darkgreen">  // Phase change material</font>
          T[i-1]=<font color="red">Buildings.HeatTransfer.Conduction.BaseClasses.temperature_u</font>(
                    ud=ud,
                    Td=Td,
                    dT_du=dT_du,
                    u=u[i-1]);
        <font color="blue">else</font>
        <font color="darkgreen">  // Regular material</font>
          u[i-1]=material.c*T[i-1];
        <font color="blue">end if</font>;
      <font color="blue">end for</font>;
    <font color="blue">else</font>
    <font color="darkgreen">  // Transient heat conduction</font>
      <font color="blue">if </font>material.phasechange<font color="blue"> then</font>
      <font color="darkgreen">  // Phase change material</font>
        <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
        <font color="red">  der</font>(u[i]) = (Q_flow[i]-Q_flow[i+1])/m;
        <font color="darkgreen">  // Recalculation of temperature based on specific internal energy</font>
          T[i]=<font color="red">Buildings.HeatTransfer.Conduction.BaseClasses.temperature_u</font>(
                    ud=ud,
                    Td=Td,
                    dT_du=dT_du,
                    u=u[i]);
        <font color="blue">end for</font>;
      <font color="blue">else</font>
      <font color="darkgreen">  // Regular material</font>
        <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
        <font color="red">  der</font>(T[i]) = (Q_flow[i]-Q_flow[i+1])/C;
          u[i]=material.c*T[i];
        <font color="blue">end for</font>;
      <font color="blue">end if</font>;
    <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>SingleLayer;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SingleLayerCylinder<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Coe2a9524198d40e33inderI.png" ALT="Buildings.HeatTransfer.Conduction.SingleLayerCylinder" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Conduction.SingleLayerCylinder"></A><A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction"
>Buildings.HeatTransfer.Conduction</A>.SingleLayerCylinder</H2>
<B>Heat conduction in a cylinder</B><p>
<IMG SRC="Buildings.HeatTransfer.Coe2a9524198d40e33inderD.png" ALT="Buildings.HeatTransfer.Conduction.SingleLayerCylinder">
<P><H3>Information</H3></P>

</p>
Model for radial heat transfer in a hollow cylinder.
</p>
<p>
If the heat capacity of the material is non-zero, then this model computes transient heat conduction, i.e., it
computes a numerical approximation to the solution of the heat equation
</p>
<p align="center" style="font-style:italic;">
   &rho; c ( &part; T(r,t) &frasl; &part;t ) = 
    k ( &part;&sup2; T(r,t) &frasl; &part;r&sup2; + 1 &frasl; r &nbsp;  &part; T(r,t) &frasl; &part;r ),
</p>
<p>
where 
<i>&rho;</i>
is the mass density,
<i>c</i>
is the specific heat capacity per unit mass,
<i>T</i>
is the temperature at location <i>r</i> and time <i>t</i> and
<i>k</i> is the heat conductivity. 
At the locations <i>r=r<sub>a</sub></i> and <i>r=r<sub>b</sub></i>, 
the temperature and heat flow rate are equal to the 
temperature and heat flow rate of the heat ports.
</p>
<p>
If the heat capacity of the material is set to zero, then steady-state heat flow is computed using
</p>
<p align="center" style="font-style:italic;">
   Q = 2 &pi; k (T<sub>a</sub>-T<sub>b</sub>)&frasl; ln(r<sub>a</sub> &frasl; r<sub>b</sub>),
</p></p>
<p>
where
<i>r<sub>a</sub></i> is the internal radius,
<i>r<sub>b</sub></i> is the external radius,
<i>T<sub>a</sub></i> is the temperature at port a and
<i>T<sub>b</sub></i> is the temperature at port b.
</p>
<h4>Implementation</h4>
<p>
To spatially discretize the heat equation, the construction is 
divided into compartments with <code>material.nSta &ge; 1</code> state variables. 
The state variables are connected to each other through thermal conductors. 
There is also a thermal conductor
between the surfaces and the outermost state variables. Thus, to obtain
the surface temperature, use <code>port_a.T</code> (or <code>port_b.T</code>)
and not the variable <code>T[1]</code>.
</p>
<p>
<P>

<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Generic</A></TD><TD>material</TD><TD>redeclare parameter Building...</TD><TD>Material thermal properties</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>h</TD><TD>&nbsp;</TD><TD>Height of the cylinder [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>r_a</TD><TD>&nbsp;</TD><TD>Internal radius [m]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</A></TD><TD>r_b</TD><TD>&nbsp;</TD><TD>External radius [m]</TD></TR>
<TR><TD>Integer</TD><TD>nSta</TD><TD>&nbsp;</TD><TD>Number of state variables</TD></TR>
<TR><TD>Real</TD><TD>griFac</TD><TD>2</TD><TD>Grid factor for spacing</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>TInt_start</TD><TD>293.15</TD><TD>Initial temperature at port_a, used if steadyStateInitial = false [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>TExt_start</TD><TD>293.15</TD><TD>Initial temperature at port_b, used if steadyStateInitial = false [K]</TD></TR>
<TR><TD>Boolean</TD><TD>steadyStateInitial</TD><TD>false</TD><TD>true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>Heat port at surface a</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>Heat port at surface b</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SingleLayerCylinder <font color="darkgreen">&quot;Heat conduction in a cylinder&quot;</font>
  <font color="blue">replaceable </font><font color="blue">parameter </font><A HREF="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Buildings.HeatTransfer.Data.Soil.Generic</A> material <font color="darkgreen">
    &quot;Material thermal properties&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</A> h <font color="darkgreen">&quot;Height of the cylinder&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> r_a <font color="darkgreen">&quot;Internal radius&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> r_b <font color="darkgreen">&quot;External radius&quot;</font>;
  <font color="blue">parameter </font>Integer nSta(min=1) <font color="darkgreen">&quot;Number of state variables&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> TInt_start=293.15 <font color="darkgreen">
    &quot;Initial temperature at port_a, used if steadyStateInitial = false&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> TExt_start=293.15 <font color="darkgreen">
    &quot;Initial temperature at port_b, used if steadyStateInitial = false&quot;</font>;
  <font color="blue">parameter </font>Boolean steadyStateInitial=false <font color="darkgreen">
    &quot;true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start&quot;</font>;

  <font color="blue">parameter </font>Real griFac(min=1) = 2 <font color="darkgreen">&quot;Grid factor for spacing&quot;</font>;

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</A> dT <font color="darkgreen">&quot;port_a.T - port_b.T&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> port_a <font color="darkgreen">
    &quot;Heat port at surface a&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</A> port_b <font color="darkgreen">
    &quot;Heat port at surface b&quot;</font>;</textblock>

  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T[nSta](start=
     {TInt_start+ (TExt_start-TInt_start)/<font color="red">Modelica.Math.log</font>(r_b/r_a)
       *<font color="red">Modelica.Math.log</font>((r_a+(r_b-r_a)/(nSta)*(i-0.5))/r_a) <font color="blue">for </font>i<font color="blue"> in </font>1:nSta}) <font color="darkgreen">
    &quot;Temperature of the states&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> Q_flow[nSta+1] <font color="darkgreen">
    &quot;Heat flow rate from state i to i+1&quot;</font>;

<font color="darkgreen">//  Modelica.SIunits.TemperatureSlope der_T[nSta]</font>
<font color="darkgreen">//    &quot;Time derivative of temperature (= der(T))&quot;;</font>
<font color="blue">protected </font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> r[nSta+1](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Radius to the boundary of the i-th domain&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</A> rC[nSta](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Radius to the center of the i-th domain&quot;</font>;

  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</A> c= material.c <font color="darkgreen">
    &quot;Specific heat capacity&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</A> k= material.k <font color="darkgreen">
    &quot;Thermal conductivity of the material&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</A> d = material.d <font color="darkgreen">
    &quot;Density of the material&quot;</font>;

  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</A> G[nSta+1](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Heat conductance between the temperature nodes&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>Modelica.SIunits.HeatCapacity</A> C[nSta](<font color="blue">each </font>fixed=false) <font color="darkgreen">
    &quot;Heat capacity of each state&quot;</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="red">assert</font>(r_a &lt; r_b, &quot;Error: Model requires r_a &lt; r_b.&quot;);
  <font color="red">assert</font>(0 &lt; r_a,   &quot;Error: Model requires 0 &lt; r_a.&quot;);
  r[1] = r_a;
  <font color="blue">for </font>i<font color="blue"> in </font>2:nSta+1<font color="blue"> loop</font>
     r[i]= r[i-1] + ( r_b - r_a)  * (1-griFac)/(1-griFac^(nSta)) * griFac^(i-2);
  <font color="blue">end for</font>;
  <font color="red">assert</font>(<font color="red">abs</font>(r[nSta+1]-r_b) &lt; 1E-10, &quot;Error: Wrong computation of radius. r[nSta+1]=&quot; +<font color="red"> String</font>(r[nSta+1]));

  <font color="darkgreen">// Radii to the center of the domain</font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
    rC[i] = (r[i]+r[i+1])/2;
  <font color="blue">end for</font>;
  <font color="darkgreen">// Conductance between nodes (which are in the center of the domain)</font>
  G[1]      = 2*Modelica.Constants.pi*k*h/<font color="red">Modelica.Math.log</font>(rC[1]/r_a);
  G[nSta+1] = 2*Modelica.Constants.pi*k*h/<font color="red">Modelica.Math.log</font>(r_b/rC[nSta]);
  <font color="blue">for </font>i<font color="blue"> in </font>2:nSta<font color="blue"> loop</font>
    G[i]      = 2*Modelica.Constants.pi*k*h/<font color="red">Modelica.Math.log</font>(rC[i]/rC[i-1]);
  <font color="blue">end for</font>;

  <font color="darkgreen">// Heat capacity of each segment</font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
   C[i] = (d*Modelica.Constants.pi*c*h*((r[i+1])^2-(r[i])^2));
  <font color="blue">end for</font>;
  <font color="darkgreen">// The initialization is only done for materials that store energy.</font>
  <font color="blue">if </font><font color="blue">not </font>material.steadyState<font color="blue"> then</font>
    <font color="blue">if </font>steadyStateInitial<font color="blue"> then</font>
      <font color="red">der</font>(T) =<font color="red"> zeros</font>(nSta);
    <font color="blue">else</font>
      <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
        T[i]=TInt_start+ (TExt_start-TInt_start)/<font color="red">Modelica.Math.log</font>(r_b/r_a) *<font color="red"> Modelica.Math.log</font>(rC[i]/r_a);
      <font color="blue">end for</font>;
    <font color="blue">end if</font>;
  <font color="blue">end if</font>;
<font color="blue">equation </font>
  dT = port_a.T - port_b.T;
  port_a.Q_flow = +Q_flow[1];
  port_b.Q_flow = -Q_flow[nSta+1];
  Q_flow[1]      = G[1]      * (port_a.T-T[1]);
  Q_flow[nSta+1] = G[nSta+1] * (T[nSta]-port_b.T);
  <font color="blue">for </font>i<font color="blue"> in </font>2:nSta<font color="blue"> loop</font>
    Q_flow[i]=G[i]*(T[i-1]-T[i]);
    <font color="darkgreen">// Q_flow[i] represents the heat flowing betwen two nodes</font>
  <font color="blue">end for</font>;
  <font color="blue">if </font>material.steadyState<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:nSta+1<font color="blue"> loop</font>
      Q_flow[i]=Q_flow[1];
    <font color="blue">end for</font>;
  <font color="blue">else</font>
    <font color="blue">for </font>i<font color="blue"> in </font>1:nSta<font color="blue"> loop</font>
      <font color="red">  der</font>(T[i])= (Q_flow[i]-Q_flow[i+1])/C[i];
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>SingleLayerCylinder;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE MultiLayer<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Buildings.HeatTransfer.Co57ad46f24fbd0c15LayerI.png" ALT="Buildings.HeatTransfer.Conduction.MultiLayer" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Buildings.HeatTransfer.Conduction.MultiLayer"></A><A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction"
>Buildings.HeatTransfer.Conduction</A>.MultiLayer</H2>
<B>Model for heat conductance through a solid with multiple material layers</B><p>
<IMG SRC="Buildings.HeatTransfer.Co57ad46f24fbd0c15LayerD.png" ALT="Buildings.HeatTransfer.Conduction.MultiLayer">
<P><H3>Information</H3></P>

This is a model of a heat conductor with multiple material layers and energy storage.
The construction has at least one material layer, and each layer has
at least one temperature node. The layers are modeled using an instance of 
<A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayer"
>
Buildings.HeatTransfer.Conduction.SingleLayer</a>.
</p>
The construction material is defined by a record of the package
<A HREF="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions"
>
Buildings.HeatTransfer.Data.OpaqueConstructions</a>.
This record allows specifying materials that store energy, and material
that are a thermal conductor only with no heat storage.
</p>
<p>
To obtain the surface temperature of the construction, use <code>port_a.T</code> (or <code>port_b.T</code>)
and not the variable <code>T[1]</code> because there is a thermal resistance between the surface
and the temperature state.
</p>
<P>
Extends from <A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</A> (Partial model for heat conductor), <A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction</A> (Partial model for multi-layer constructions).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Heat transfer area [m2]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>ThermalResistance</A></TD><TD>R</TD><TD>sum(lay[i].R for i in 1:nLay)</TD><TD>Thermal resistance of construction [K/W]</TD></TR>
<TR><TD><A HREF="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Generic"
>Generic</A></TD><TD>layers</TD><TD>redeclare parameter Building...</TD><TD>Construction definition from Data.OpaqueConstructions</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Initialization</TD></TR>
<TR><TD>Boolean</TD><TD>steadyStateInitial</TD><TD>false</TD><TD>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_a_start</TD><TD>293.15</TD><TD>Initial temperature at port_a, used if steadyStateInitial = false [K]</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>T_b_start</TD><TD>293.15</TD><TD>Initial temperature at port_b, used if steadyStateInitial = false [K]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>port_a</TD><TD>Heat port at surface a</TD></TR>
<TR><TD><A HREF="../../msl/3.2/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</A></TD><TD>port_b</TD><TD>Heat port at surface b</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> MultiLayer <font color="darkgreen">
  &quot;Model for heat conductance through a solid with multiple material layers&quot;</font>
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</A>(
   <font color="blue">final </font>R=<font color="red">sum</font>(lay[i].R <font color="blue">for </font>i<font color="blue"> in </font>1:nLay));
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> T[<font color="red">sum</font>(nSta)](<font color="blue">each </font>nominal = 300) <font color="darkgreen">
    &quot;Temperature at the states&quot;</font>;
  <A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</A> Q_flow[<font color="red">sum</font>(nSta)+nLay] <font color="darkgreen">
    &quot;Heat flow rate from state i to i+1&quot;</font>;
  <font color="blue">extends </font><A HREF="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction</A>;

<textblock type="annotcomp" expanded="false"><font color="blue">protected </font>
  <A HREF="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayer"
>Buildings.HeatTransfer.Conduction.SingleLayer</A>[nLay] lay(
   <font color="blue">each </font><font color="blue">final </font>A=A,
   material = layers.material,
   T_a_start = _T_a_start,
   T_b_start = _T_b_start,
   <font color="blue">each </font>steadyStateInitial = steadyStateInitial) <font color="darkgreen">&quot;Material layer&quot;</font>;</textblock>

<font color="blue">protected </font>
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> _T_a_start[nLay]=
    { T_b_start+(T_a_start-T_b_start) * 1/R *<font color="red"> sum</font>(lay[k].R <font color="blue">for </font>k<font color="blue"> in </font>i:nLay) <font color="blue">for </font>i<font color="blue"> in </font>1:nLay} <font color="darkgreen">
    &quot;Initial temperature at port_a of respective layer, used if steadyStateInitial = false&quot;</font>;
  <font color="blue">parameter </font><A HREF="../../msl/3.2/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</A> _T_b_start[nLay]=
    { T_a_start+(T_b_start-T_a_start) * 1/R *<font color="red"> sum</font>(lay[k].R <font color="blue">for </font>k<font color="blue"> in </font>1:i) <font color="blue">for </font>i<font color="blue"> in </font>1:nLay} <font color="darkgreen">
    &quot;Initial temperature at port_b of respective layer, used if steadyStateInitial = false&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// This section assigns the temperatures and heat flow rates of the layer models to</font>
  <font color="darkgreen">// an array that makes plotting the results easier.</font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:nLay<font color="blue"> loop</font>
    <font color="blue">for </font>j<font color="blue"> in </font>1:nSta[i]<font color="blue"> loop</font>
      T[<font color="red">sum</font>(nSta[k] <font color="blue">for </font>k<font color="blue"> in </font>1:(i-1)) +j] = lay[i].T[j];
    <font color="blue">end for</font>;
    <font color="blue">for </font>j<font color="blue"> in </font>1:nSta[i]+1<font color="blue"> loop</font>
      Q_flow[<font color="red">sum</font>(nSta[k] <font color="blue">for </font>k<font color="blue"> in </font>1:i-1)+(i-1)+j] = lay[i].Q_flow[j];
    <font color="blue">end for</font>;
  <font color="blue">end for</font>;
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(port_a, lay[1].port_a);</textblock>
  <font color="blue">for </font>i<font color="blue"> in </font>1:nLay-1<font color="blue"> loop</font>
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(lay[i].port_b, lay[i+1].port_a);</textblock>
  <font color="blue">end for</font>;
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(lay[nLay].port_b, port_b);</textblock>

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>MultiLayer;
</PRE>
<HR>
<address><a href="http://www.3ds.com/">Automatically generated</a> Wed May 15 09:45:14 2013.
</address></BODY>
</HTML>
